[{"authors":["Chao"],"categories":null,"content":"I am an Assistant Professor in the Department of Mathematics, NUS. I got my PhD in Applied Mathematics from CMAP, Ecole Polytechnique. My thesis subject is Model Uncertainty in Finance and Second Order Backward Stochastic Differential Equations.\n","date":-62135596800,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":-62135596800,"objectID":"598b63dd58b43bce02403646f240cd3c","permalink":"https://GangSirius.github.io/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"author","summary":"I am an Assistant Professor in the Department of Mathematics, NUS. I got my PhD in Applied Mathematics from CMAP, Ecole Polytechnique. My thesis subject is Model Uncertainty in Finance and Second Order Backward Stochastic Differential Equations.","tags":null,"title":"Chao ZHOU","type":"author"},{"authors":null,"categories":null,"content":" Monte-Carlo method in finance and insurance for 1st year graduate students at 2nd year undergraduate students at University of Maine, Le Mans, France, 2013\n Probability and Statistics, Multivariable Functions for 2nd year undergraduate students at University of Maine, Le Mans, France, 2013\n Advanced Financial Mathematics for M.Sc. in Mathematics at National University of Singapore, Singapore, 2013-2014\n Financial Time Series: Theory and Computation for M.Sc.in Quantitative Finance at National University of Singapore, Singapore, 2013-2014, 2014-2015, 2015-2016\n Interest Rate Models for M.Sc. in Quantitative Finance at National University of Singapore, Singapore, 2013-2014, 2014-2015\n Interest Rate Theory and Credit Risk for M.Sc. in Quantitative Finance at National University of Singapore, Singapore, 2015-2016, 2016-2017, 2018-2019\n Stochastic Analysis in Mathematical Finance for M.Sc. in Mathematics and in Quantitative Finance at National University of Singapore, Singapore, 2014-2015, 2015-2016, 2016-2017, 2018-2019\n Mathematical Finance for Undergraduates and M.Sc. in Mathematics and in Quantitative Finance at National University of Singapore, Singapore, 2016-2017, 2017-2018, 2018-2019\n TA in both Optimization and Numerical Analysis for 1st year students at ENSAE (Paris Graduate School of Economics, Statistics and Finance), France, 2009-2010\n  ","date":1555603200,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1555603200,"objectID":"6b0512eeb5f23dcb50d5dbe994643b40","permalink":"https://GangSirius.github.io/teaching/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/","section":"teaching","summary":"Monte-Carlo method in finance and insurance for 1st year graduate students at 2nd year undergraduate students at University of Maine, Le Mans, France, 2013\n Probability and Statistics, Multivariable Functions for 2nd year undergraduate students at University of Maine, Le Mans, France, 2013\n Advanced Financial Mathematics for M.Sc. in Mathematics at National University of Singapore, Singapore, 2013-2014\n Financial Time Series: Theory and Computation for M.Sc.in Quantitative Finance at National University of Singapore, Singapore, 2013-2014, 2014-2015, 2015-2016","tags":null,"title":"Courses","type":"docs"},{"authors":null,"categories":null,"content":" D. Possamai and C. Zhou (2013). Second Order Backward Stochastic Differential Equations with Quadratic Growth. Stochastic Processes and their Applications, 123(10):3770-3799. arXiv:1201.1050v2 PDF\n A. Matoussi, D. Possamai and C. Zhou (2013). Second Order Reflected Backward Stochastic Differential Equations. The Annals of Applied Probability, 23(6):2420-2457. arXiv:1201.0746v1 PDF\n Corrigendum for \u0026ldquo;Second-order reflected backward stochastic di↵erential equations\u0026rdquo; and \u0026ldquo;Second-order BSDEs with general reflection and game options under uncertainty\u0026rdquo;, with Matoussi, A., Possama¨ı, D., submitted\n A. Matoussi, D. Possamai and C. Zhou (2015). Robust Utility Maximization in Non-dominated Models with 2BSDEs. Mathematical Finance, 25(2): 258-287. arXiv:1201.0769v2 PDF\n N. Kazi-Tani and D. Possamai and C. Zhou (2015). Second Order Backward Stochastic Differential Equations with Jumps: Formulation and Uniqueness. The Annals of Applied Probability, 25(5)2867-2908. arXiv:1208.0757 PDF\n N. Kazi-Tani and D. Possamai and C. Zhou(2015). Second Order Backward Stochastic Differential Equations with Jumps: Existence and Probabilistic Representation for fully-nonlinear PIDEs. Electronic Journal of Probability, 20(65):1-31. arXiv:1208.0763 PDF\n A. Matoussi, W. Sabbagh. and C. Zhou (2015). The obstacle problem for semilinear parabolic partial integro-differential equations. Stochastics and Dynamics, 15(01)-1550007. arXiv:1307.0875v2 PDF\n N. Kazi-Tani and D. Possamai and C. Zhou(2015). Quadratic BSDEs with jumps: a fixed point approach. Electronic Journal of Probability, 20(66):1-28. arXiv:1208.5581 PDF\n N. Kazi-Tani and D. Possamai and C. Zhou(2016). Quadratic BSDEs with Jumps: Related Non-linear Expectations. Stochastics and Dynamics, 16(4)-1650012. arXiv:1403.2730 PDF\n Y. Armenti, S. Crepey and C. Zhou (2017). The Sustainable Black-Scholes Equations. In: Londoño J., Garrido J., Jeanblanc M. (eds) Actuarial Sciences and Quantitative Finance. ICASQF 2016. Springer Proceedings in Mathematics \u0026amp; Statistics, vol 214: 155-167. Slides\n B. Bouchard, D. Possamai, X. Tan and C. Zhou (2016). A unified approach to a priori estimates for supersolutions of BSDEs in general filtrations. Annales de l\u0026rsquo;Institut Henri Poincare (B), to appear. arXiv:1403.2730 PDF\n D. Possamai, X. Tan and C. Zhou (2018). Stochastic control for a class of nonlinear kernels and applications. The Annals of Probability, 46(1):551-603. arXiv:1510.08439 PDF\n Constrained portfolio-consumption strategies with uncertain parameters and borrowing costs, with Yang, Z., Liang, G., 2018, Mathematics and Financial Economics.In press. PDF\n A. Popier and C. Zhou (2018). Second order BSDE under monotonicity condition and liquidation problem under uncertainty. The Annals of Applied Probability, arXiv:1712.10253v1. PDF\n  ","date":1555603200,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1555603200,"objectID":"3a079e7dad19be978a318345a7749d34","permalink":"https://GangSirius.github.io/publication/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/publication/","section":"publication","summary":"D. Possamai and C. Zhou (2013). Second Order Backward Stochastic Differential Equations with Quadratic Growth. Stochastic Processes and their Applications, 123(10):3770-3799. arXiv:1201.1050v2 PDF\n A. Matoussi, D. Possamai and C. Zhou (2013). Second Order Reflected Backward Stochastic Differential Equations. The Annals of Applied Probability, 23(6):2420-2457. arXiv:1201.0746v1 PDF\n Corrigendum for \u0026ldquo;Second-order reflected backward stochastic di↵erential equations\u0026rdquo; and \u0026ldquo;Second-order BSDEs with general reflection and game options under uncertainty\u0026rdquo;, with Matoussi, A.","tags":null,"title":"Publication","type":"docs"},{"authors":null,"categories":null,"content":"\n The 6th Asian Quantitative Finance Conference, China, Guangzhou, November 2018\n Workshop on Stochastic Analysis, Stochastic Control and New Developments, China, Weihai, August 2018\n Workshop Mathematics of Behavioral Economics and Knightian Uncertainty in Financial Markets, Germany, Bielefeld, May 2018\n Workshop on Stochastic Analysis, Italy, Verona, May 2018\n Workshop on Stochastic Control and Related Issues Kansai University, Japan, Osaka, March 2018\n Workshop on Stochastic Analysis applied to economics, finance and insurance, Chile, Santiago, March 2018\n Workshop on BSDEs, SPDEs and their applications, United Kingdom, Edinburgh, July 2017\n Conference Asymptotic Statistics of Stochastic Processes and Applications, Russia, Peterhof, July 2017\n Workshop on Stochastic Analysis in Finance, China, Hong Kong, May 2017\n 3rd Berlin-Princeton-Singapore Workshop on Quantitative Finance, Germany, Berlin, April 2017\n The 5th Asian Quantitative Finance Conference, South Korea, Seoul, April 2017\n Berlin-Princeton-Singapore Workshop on Quantitative Finance, United State, Princeton, July 2016\n Journe´es de Probabilities 2016, France, Le Mans, May 2016\n Frontiers in Stochastic Modelling for Finance, Italy, Padua, February 2016\n The Fourth Asian Quantitative Finance Conference, Japan, Osaka, February 2016\n International Workshop on Analysis and Control of Stochastic Partial Differential Equations, China, Shanghai, November 2015\n Singapore-Suzhou Workshop on Quantitative Finance, China, Suzhou, July 2015.\n THE 7TH INTERNATIONAL SYMPOSIUM ON BACKWARD STOCHASTIC DIFFERENTIAL EQUATIONS, Weihai, 22-27 June 2014 site, invited speaker.\n Labex Louis Bachelier - SIAM-SMAI Conference on Financial Mathematics: Advanced Modeling and Numerical Methods, Paris, 17-20 June 2014 site, invited speaker.\n The First Berlin-Singapore Workshop on Quantitative Finance and Financial Risk, Berlin, 21-24 May 2014 site, invited speaker.\n IMS Summer Program: Nonlinear Expectations, Stochastic Calculus under Knightian Uncertainty, and Related Topics, Singapore, Singapore, June-July 2013\n Summer program: Nonlinear Expectations, Stochastic Calculus under Knightian Uncertainty, and Related Topics, Singapore, 3 June-12 July, 2013 site, invited speaker. The First Asian Quantitative Finance Conference, Singapore, NUS, 9-11 January 2013 site.\n Fifth SMAI European Summer School In Financial Mathematics, Paris, Ecole Polytechnique 27-31 August 2012 site.\n Bachelier Finance Society 7th World Congress, Sydney 12-22 June 2012 site.\n The Sixth Bachelier Colloquium, Metabief-France 15-22 January 2012 site.\n Marie Curie Initial Training Network Spring School \u0026ldquo;Stochastic Analysis in Finance, Roscoff-France 06-15 March 2012 site.\n Seminaire de Probabilite Institut de Recherche Mathematique de Rennes, Rennes-France 06 February 2012 site.\n Sino-French Summer Institute: Stochastic Modeling and Applications, Beijing-China, 13 Juin-1st July 2011 site.\n  ","date":1555603200,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1555603200,"objectID":"9c271c180eb7c7619f1c22cd4e4c1dd2","permalink":"https://GangSirius.github.io/conference/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/conference/","section":"conference","summary":"The 6th Asian Quantitative Finance Conference, China, Guangzhou, November 2018\n Workshop on Stochastic Analysis, Stochastic Control and New Developments, China, Weihai, August 2018\n Workshop Mathematics of Behavioral Economics and Knightian Uncertainty in Financial Markets, Germany, Bielefeld, May 2018\n Workshop on Stochastic Analysis, Italy, Verona, May 2018\n Workshop on Stochastic Control and Related Issues Kansai University, Japan, Osaka, March 2018\n Workshop on Stochastic Analysis applied to economics, finance and insurance, Chile, Santiago, March 2018","tags":null,"title":"Seminars \u0026 Conferences","type":"docs"},{"authors":[],"categories":null,"content":" Click on the **Slides** button above to view the built-in slides feature.   Slides can be added in a few ways:\n Create slides using Academic\u0026rsquo;s Slides feature and link using url_slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes.  Further talk details can easily be added to this page using Markdown and $\\rm \\LaTeX$ math code.\n","date":1906520400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1906520400,"objectID":"96344c08df50a1b693cc40432115cbe3","permalink":"https://GangSirius.github.io/talk/example/","publishdate":"2017-01-01T00:00:00+08:00","relpermalink":"/talk/example/","section":"talk","summary":"An example talk using Academic's Markdown slides feature.","tags":[],"title":"THE 7TH INTERNATIONAL SYMPOSIUM ON BACKWARD STOCHASTIC DIFFERENTIAL EQUATIONS","type":"talk"},{"authors":null,"categories":null,"content":" Course Introduction This module introduces students to financial time series techniques, focusing primarily on ARIMA models, conditional volatility (ARCH/GARCH models), regime switching and nonlinear filtering, diverse nonlinear state models, co-integration, and their applications on real-life financial problems.\nWe provide both the relevant time series concepts and their financial applications. Potential applications of financial time series models include modeling equity returns, volatility estimations, Value at Risk modelling and option valuation. This module targets honours students in the Quantitative Finance Programme and students in the Master of Science in Quantitative Finance Programme.\nSchedule  Intro : R, proba \u0026amp; stats Linear regression Logit and probit models Regression models Univariate time series models ARIMA modelling ARCH modelling GARCH modelling Nonlinear models Risk measures and risk management Risk measures and multivariate TS Multivariate TS and co-integration Review  Books  Analysis of Financial Time Series, 3rd Edition, Ruey S. Tsay, Wiley, 2010. Chapters 1-4, 7, 8, 10.\n Statistics and Data Analysis for Financial Engineering, David Ruppert, Springer, 2010. Chapters 2, 4, 5, 7, 9, 10, 12, 14, 15, 18, 19.\n Introductory Econometrics for Finance, 2nd Edition, Chris Brooks, Cambridge University Press, 2008.\n  Programming Language  R Language + RStudio  ","date":1555603200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1555603200,"objectID":"41e74df5b55a562aee1f7dc13c375b2f","permalink":"https://GangSirius.github.io/teaching/time-series/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/teaching/time-series/","section":"teaching","summary":"Course Introduction This module introduces students to financial time series techniques, focusing primarily on ARIMA models, conditional volatility (ARCH/GARCH models), regime switching and nonlinear filtering, diverse nonlinear state models, co-integration, and their applications on real-life financial problems.\nWe provide both the relevant time series concepts and their financial applications. Potential applications of financial time series models include modeling equity returns, volatility estimations, Value at Risk modelling and option valuation. This module targets honours students in the Quantitative Finance Programme and students in the Master of Science in Quantitative Finance Programme.","tags":null,"title":"Financial Time Series: Theory and Computation","type":"docs"},{"authors":null,"categories":null,"content":" Course Introduction This course provides a clear understanding of the intuition behind derivatives pricing, how models are constructed, and how they are used and adapted in practice. Strengths and weaknesses of different models. Some important conceptions will be inclueded and tested: Black-Scholes, stochastic calculus, Martingale, exotic options, American options and Greeks.\nBoth the theory and the practice of the industry-standard pricing models are considered in detail. Each pricing problem is approached using multiple techniques including the well-known PDE and a change of measure.\nSchedule  Review and introduction: assets, portfolio, no-arbitrage, forward contracts, options, binomial model Stochastic calculus: Itˆo’s Lemma, geometric brownian motion Black-Scholes PDE, delta-hedging Martingale pricing: Radon-Nikodym derivative, Girsanov’s theorem, risk-neutral valuation, Black-Scholes formula, change of numeraire American options: optimal exercise boundary, linear complementarity problem, free boundary problem, optimal stopping problem, perpetual american put Barrier options Asian options Lookback options Multi-asset options: multi-dimensional Itˆo\u0026rsquo;s lemma, exchange options, cross-currency options, muti-dimensonal Black-Scholes market.  Books  The Mathematics of Financial Derivatives: A Student Introduction.see here\n Options, Futures, and Other Derivatives, 9th Edition. see here\n Lecture notes of Prof. Touzi and Prof. Tankov at ´Ecole Polytechnique (technical). see here\n  Preliminary knowledge You should be familiar with basic concepts of financial derivatives though we will review them in the first lecture. A good introduction is one of the recommended book by John Hull: Options, Futures, and Other Derivatives. You must also have some basic knowledge in multivariable calculus and probability.\n","date":1555603200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1555603200,"objectID":"2f0e3296a686aedd6f4614f0d28c22db","permalink":"https://GangSirius.github.io/teaching/mathfin/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/teaching/mathfin/","section":"teaching","summary":"Course Introduction This course provides a clear understanding of the intuition behind derivatives pricing, how models are constructed, and how they are used and adapted in practice. Strengths and weaknesses of different models. Some important conceptions will be inclueded and tested: Black-Scholes, stochastic calculus, Martingale, exotic options, American options and Greeks.\nBoth the theory and the practice of the industry-standard pricing models are considered in detail. Each pricing problem is approached using multiple techniques including the well-known PDE and a change of measure.","tags":null,"title":"MA4269: Mathematical Finance II","type":"docs"},{"authors":null,"categories":null,"content":" Course Introduction This module is aimed at final year undergraduate students, master students and PhD students who want to continue with higher studies in Stochastic Analysis or Mathematical Finance or who want to work in the financial industry.\nIt will introduce you some basic but important concepts, notations and theories of Stochastic Analysis and Mathematical Finance (e.g. Brownian Motion, Quadratic Variation, Stochastic Differential Equations, Ito’s Formula, Black-Scholes-Merton Formula, Financial Derivatives). This module will be helpful (if not necessary) for the pursuing of advanced Quantitative Finance modules.\nSchedule  Introduction; Conditional Expectation Brownian Motion Quadratic Variation Itô\u0026rsquo;s Integral Itô\u0026rsquo;s Formula SDE; Change of Probabilities Girsanov Theorem; First Passage Time A Model for Stocks; PDE Risk-Neutral Pricing Change of Numeraire PDE and FK formula Extensions and Hedging (Greeks) American Options  Books  Stochastic Calculus for Finance II : Continuous-Time Models, Steven Shreve\n Brownian Motion and Stochastic Calculus, Ioannis Karatzas, Steven Shreve.\n Methods of Mathematical Finance, Ioannis Karatzas, Steven Shreve.\n Martingale Methods in Financial Modelling, Marek Musiela, Marek Rutkowski.\n Paul Wilmott on Quantitative Finance, , Second Edition, Paul Wilmott.\n  ","date":1555603200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1555603200,"objectID":"492d7706261d7bb9e766cd8cbd861988","permalink":"https://GangSirius.github.io/teaching/stochastic/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/teaching/stochastic/","section":"teaching","summary":"Course Introduction This module is aimed at final year undergraduate students, master students and PhD students who want to continue with higher studies in Stochastic Analysis or Mathematical Finance or who want to work in the financial industry.\nIt will introduce you some basic but important concepts, notations and theories of Stochastic Analysis and Mathematical Finance (e.g. Brownian Motion, Quadratic Variation, Stochastic Differential Equations, Ito’s Formula, Black-Scholes-Merton Formula, Financial Derivatives).","tags":null,"title":"MA5248: Stochastic Analysis in Mathematical Finance","type":"docs"},{"authors":null,"categories":null,"content":" Course Introduction Building on mathematical foundations of arbitrage pricing theory laid down in a first course on stochastic calculus for finance, this master level course addresses the modeling of the world’s bond markets, and the derivative securities associated with them. Bond markets are less transparent than equity markets, but have a total value about double that of equity markets, and a richer underlying structure.\nThe whole course can be divided into two parts:  Credit risk\n Interest rate model\n  within each part, industrial knowledge, theory \u0026amp; model and real world practice will be covered. Students need to acquire the modeling and arbitrage of some fundamental industrial products.\nSchedule  Default Probabilities MM Thm \u0026amp; Merton’s Model B-Cox \u0026amp; Leland-Toft Models Reduced Form Model Portfolio Credit Risk Model Intro to Interest Rates Interest Rates Derivatives Spot Rate Models HW and CIR Models HJM and MLM Models MLM Models and Review  Books  Introduction to Credit Risk Modeling by Christian Bluhm, Ludger Overbeck and Christoph Wagner\n An Elementary Introduction to Stochastic Interest Rate Modeling by Nicolas Privault\n Interest Rate Modeling-Theory and Practice by Lixin Wu\n Term-Structure Models by Damir Filipovi´c\n Interest Rate Models-Theory and Practice by Damiano Brigo and Fabio Mercurio\n Lecture notes of Tomasz Bielecki, Monique Jeanblanc and Marek Rutkowski. Available here\n  ","date":1555603200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1555603200,"objectID":"74ecbd40bf104b01b00aa980031d28e9","permalink":"https://GangSirius.github.io/teaching/rate/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/teaching/rate/","section":"teaching","summary":"Course Introduction Building on mathematical foundations of arbitrage pricing theory laid down in a first course on stochastic calculus for finance, this master level course addresses the modeling of the world’s bond markets, and the derivative securities associated with them. Bond markets are less transparent than equity markets, but have a total value about double that of equity markets, and a richer underlying structure.\nThe whole course can be divided into two parts:  Credit risk","tags":null,"title":"QF5201: Interest Rate Theory and Credit Risk","type":"docs"},{"authors":null,"categories":null,"content":"\n Member of organizing committee for Quantitative Finance, 18 – 22 Mar, 2019 \u0026amp; 22 Jul – 31 Aug, 2019, held at Institute for Mathematical Sciences, National University of Singapore, Singapore.\n Member of organizing committee for The 7th Asian Quantitative Finance Conference (AQFC), 02 – 05 July, 2019, held at Vietnam Institute for Advanced Study in Mathematics, Hanoi, Vietnam.\n Member of organizing committee for Workshop Recent Developments in Mean-Field Game, Machine Learning and Quantitative Finance, Vietnam, Tuan Chau, May 2019\n Member of organizing committee for Workshop on Data Science and Finance, Cambodia, Siem Reap, February-March 2019\n Member of organizing committee for The Fourth Young Researchers Meeting on BSDEs, Nonlinear Expectations and Mathematical Finance, China, Shanghai, April 2018\n Member of organizing committee for 6th NUS-USPC Workshop on Machine Learning and FinTech, Singapore, Singapore, April, 2018\n Member of organizing committee for Workshop on Stochastic Modelling in Finance, Cambodia, Siem Reap, May 2017\n Member of organizing committee for Second Paris-Asia Conference in Quantitative Finance, China, Suzhou, May 2017\n Member of organizing committee for 2nd NUS-USPCWorkshop on New Challenges in Financial Risk Control, Singapore, April 2017\n Member of organizing committee for 5th NUS Workshop on Risk and Regulation,Singapore, January 2017\n Member of organizing committee for Workshop USCP-NUS on Models and Numerical Methods for Financial Risk Management, France, Paris, October 2016\n Member of organizing committee for 2nd Risk Measures, XVA Analysis, Cost ofCapital \u0026amp; Central Counterparties Workshop, China Shanghai, October 2016\n Member of organizing committee for 1st Risk Measures, XVA Analysis, Cost of Capital \u0026amp; Central Counterparties, Singapore, Singapore, April 2016\n Member of organizing committee for Second NUS-UParis Diderot Workshop on Quantitative Finance, France, Paris, September 2015\n Member of organizing committee for Paris-Southeast Asia Conference in Mathematical Finance, Cambodia, Siem Reap, February 2015\n  ","date":1555603200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1555603200,"objectID":"022440c245855b327bc5fef53324a2ad","permalink":"https://GangSirius.github.io/conference/member/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/conference/member/","section":"conference","summary":"Member of organizing committee for Quantitative Finance, 18 – 22 Mar, 2019 \u0026amp; 22 Jul – 31 Aug, 2019, held at Institute for Mathematical Sciences, National University of Singapore, Singapore.\n Member of organizing committee for The 7th Asian Quantitative Finance Conference (AQFC), 02 – 05 July, 2019, held at Vietnam Institute for Advanced Study in Mathematics, Hanoi, Vietnam.\n Member of organizing committee for Workshop Recent Developments in Mean-Field Game, Machine Learning and Quantitative Finance, Vietnam, Tuan Chau, May 2019","tags":null,"title":"Membership of conference committees","type":"docs"},{"authors":null,"categories":null,"content":"\n Seminar on Quantitative Finance, by the Centre for Quantitative Finance NUS, from April 2014 site.\n Paris-Southeast Asia Conference in Mathematical Finance, jointly organized by the Centre for Quantitative Finance NUS, Institute of Technology of Cambodia, University of Evry and ENSIIE, and University Paris Diderot, Siem Reap, Cambodia, 7-11 February 2015 site.\n Second Paris-Asia Conference in Quantitative Finance, jointly organized by the Centre for Quantitative Finance, Institute of Real Estate Studies and Risk Management Institute NUS, University of Evry and ENSIIE, and University Paris Dauphine, Suzhou, China, 23-27 May 2017 site.\n  ","date":1555603200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1555603200,"objectID":"ee460f0c84be7973d267d58d7b925776","permalink":"https://GangSirius.github.io/conference/organized/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/conference/organized/","section":"conference","summary":"Seminar on Quantitative Finance, by the Centre for Quantitative Finance NUS, from April 2014 site.\n Paris-Southeast Asia Conference in Mathematical Finance, jointly organized by the Centre for Quantitative Finance NUS, Institute of Technology of Cambodia, University of Evry and ENSIIE, and University Paris Diderot, Siem Reap, Cambodia, 7-11 February 2015 site.\n Second Paris-Asia Conference in Quantitative Finance, jointly organized by the Centre for Quantitative Finance, Institute of Real Estate Studies and Risk Management Institute NUS, University of Evry and ENSIIE, and University Paris Dauphine, Suzhou, China, 23-27 May 2017 site.","tags":null,"title":"Organised Seminars \u0026 Conferences","type":"docs"},{"authors":null,"categories":null,"content":"\n Advisor: Professor Anis MATOUSSI.\n Paper: Model Uncertainty in Finance and Second Order Backward Stochastic Differential Equations PDF\n  ","date":1555603200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1555603200,"objectID":"9d202f7db6c1b4adbb5c65c25d58a5d8","permalink":"https://GangSirius.github.io/publication/phd/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/publication/phd/","section":"publication","summary":"\n Advisor: Professor Anis MATOUSSI.\n Paper: Model Uncertainty in Finance and Second Order Backward Stochastic Differential Equations PDF\n  ","tags":null,"title":"Ph.D. Thesis Dissertation","type":"docs"},{"authors":null,"categories":null,"content":" Portfolio diversification and model uncertainty: a robust dynamic mean-variance approach, with H. PHAM and X. WEI, 2018. Under revision.\n Bank monitoring incentives under moral hazard and adverse selection, joint work with N. Hernandez and D. Revised and resubmitted. PDF\n BSDEs with weak reflections and partial hedging of American options, joint work with R. Dumitrescu, R. Elie and W. Sabbagh. PDF\n A Binary Nature of Funding Impacts in Bilateral Contracts, joint work with J. Lee, arXiv:1703.00259, 2018. Submitted.\n A Risk-Sharing Framework of Bilateral Contracts, joint work with J. Lee, S. Sturm, arxiv:1901.03874, 2019. Submitted.\n On dynamic programming principle for stochastic control under expectation constraints, with Yu, X., Zhou, Y., 2018, arXiv:1802.03954. In-preparation for submission.\n Investment Decisions and Falling Cost of Data Analytics, Keppo, J., Tan, H.M., 2018, SSRN: 3141043. Submitted.\n Second order stochastic target problems with generalized market impact, joint work with B. Bouchard, G. Loeper and H. M. Soner 2018, arXiv: 1806.08533. Revised and resubmitted.\n The Alpha-Heston Stochastic Volatility Model, joint work with Y. Jiao, C. Ma, and S. Scotti, arXiv:1812.01914, 2018. Submitted.\n Forward Investment Performance Processes in Semimartingale Financial Markets, joint work with L. Bo and A. Capponi, arXiv:1811.11899, 2018. Submitted.\n Deep Learning Algorithm to solve Portfolio Management with Proportional Transaction Cost, joint work with W. Zhang. Accepted for presentation for IEEE Conference on Computational Intelligence for Financial Engineering and Economics 2019.\n  ","date":1555603200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1555603200,"objectID":"8dcb99aa950302c7a361685108c0ee76","permalink":"https://GangSirius.github.io/publication/preprints/","publishdate":"2019-04-19T00:00:00+08:00","relpermalink":"/publication/preprints/","section":"publication","summary":"Portfolio diversification and model uncertainty: a robust dynamic mean-variance approach, with H. PHAM and X. WEI, 2018. Under revision.\n Bank monitoring incentives under moral hazard and adverse selection, joint work with N. Hernandez and D. Revised and resubmitted. PDF\n BSDEs with weak reflections and partial hedging of American options, joint work with R. Dumitrescu, R. Elie and W. Sabbagh. PDF\n A Binary Nature of Funding Impacts in Bilateral Contracts, joint work with J.","tags":null,"title":"Preprints","type":"docs"},{"authors":null,"categories":null,"content":"","date":1461686400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461686400,"objectID":"d1311ddf745551c9e117aa4bb7e28516","permalink":"https://GangSirius.github.io/project/external-project/","publishdate":"2016-04-27T00:00:00+08:00","relpermalink":"/project/external-project/","section":"project","summary":"An example of linking directly to an external project website using `external_link`.","tags":["Demo"],"title":"External Project","type":"project"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461686400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461686400,"objectID":"8f66d660a9a2edc2d08e68cc30f701f7","permalink":"https://GangSirius.github.io/project/internal-project/","publishdate":"2016-04-27T00:00:00+08:00","relpermalink":"/project/internal-project/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Internal Project","type":"project"},{"authors":["Chao ZHOU"],"categories":null,"content":" Academic makes it easy to create a beautiful website for free using Markdown. Customize anything on your site with widgets, themes, and language packs.\nFollow our easy step by step guide to learn how to build your own free website with Academic. Check out the personal demo or the business demo of what you\u0026rsquo;ll get in less than 10 minutes.\n View the documentation Ask a question Request a feature or report a bug Updating? View the Update Guide and Release Notes Support development of Academic:  Donate a coffee Become a backer on Patreon Decorate your laptop or journal with an Academic sticker Wear the T-shirt   \nKey features:\n Easily manage various content including homepage, blog posts, publications, talks, and projects Extensible via color themes and widgets/plugins Write in Markdown for easy formatting and code highlighting, with LaTeX for mathematical expressions Social/academic network linking, Google Analytics, and Disqus comments Responsive and mobile friendly Simple and refreshing one page design Multilingual and easy to customize  Color Themes Academic is available in different color themes and font themes.\n\r\r\r\r\r\r\r\r Ecosystem  Academic Admin: An admin tool to import publications from BibTeX or import assets for an offline site Academic Scripts: Scripts to help migrate content to new versions of Academic  Install You can choose from one of the following four methods to install:\n one-click install using your web browser (recommended) install on your computer using Git with the Command Prompt/Terminal app install on your computer by downloading the ZIP files install on your computer with RStudio  Quick install using your web browser  Install Academic with Netlify  Netlify will provide you with a customizable URL to access your new site  On GitHub, go to your newly created academic-kickstart repository and edit config.toml to personalize your site. Shortly after saving the file, your site will automatically update Read the Quick Start Guide to learn how to add Markdown content. For inspiration, refer to the Markdown content which powers the Demo  Install with Git Prerequisites:\n Download and install Git Download and install Hugo   Fork the Academic Kickstart repository and clone your fork with Git:\ngit clone https://github.com/sourcethemes/academic-kickstart.git My_Website  Note that if you forked Academic Kickstart, the above command should be edited to clone your fork, i.e. replace sourcethemes with your GitHub username.\n Initialize the theme:\ncd My_Website git submodule update --init --recursive   Install with ZIP  Download and extract Academic Kickstart Download and extract the Academic theme to the themes/academic/ folder from the above step  Install with RStudio View the guide to installing Academic with RStudio\nQuick start  If you installed on your computer, view your new website by running the following command:\nhugo server  Now visit localhost:1313 and your new Academic powered website will appear. Otherwise, if using Netlify, they will provide you with your URL.\n Read the Quick Start Guide to learn how to add Markdown content, customize your site, and deploy it. For inspiration, refer to the Markdown content which powers the Demo\n Build your site by running the hugo command. Then host it for free using Github Pages or Netlify (refer to the first installation method). Alternatively, copy the generated public/ directory (by FTP, Rsync, etc.) to your production web server (such as a university\u0026rsquo;s hosting service).\n  Updating Feel free to star the project on Github to help keep track of updates and check out the release notes prior to updating your site.\nBefore updating the framework, it is recommended to make a backup of your entire website directory (or at least your themes/academic directory) and record your current version number.\nBy default, Academic is installed as a Git submodule which can be updated by running the following command:\ngit submodule update --remote --merge  Check out the update guide for full instructions and alternative methods.\nFeedback \u0026amp; Contributing Please use the issue tracker to let me know about any bugs or feature requests, or alternatively make a pull request.\nFor support, head over to the Hugo discussion forum.\nLicense Copyright 2016-present George Cushen.\nReleased under the MIT license.\n","date":1461081600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1515772800,"objectID":"279b9966ca9cf3121ce924dca452bb1c","permalink":"https://GangSirius.github.io/post/getting-started/","publishdate":"2016-04-20T00:00:00+08:00","relpermalink":"/post/getting-started/","section":"post","summary":"Create a beautifully simple website or blog in under 10 minutes.","tags":["Academic"],"title":"Academic: the website designer for Hugo","type":"post"},{"authors":null,"categories":null,"content":"","date":1403395200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1403395200,"objectID":"6e929dc84ed3ef80467b02e64cd2ed64","permalink":"https://GangSirius.github.io/post/jupyter/","publishdate":"2014-06-22T00:00:00Z","relpermalink":"/post/jupyter/","section":"post","summary":"Weihai, invited speaker","tags":null,"title":"THE 7TH INTERNATIONAL SYMPOSIUM ON BACKWARD STOCHASTIC DIFFERENTIAL EQUATIONS","type":"post"},{"authors":null,"categories":null,"content":"\rLecture1: An introduction to R\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.table th:not([align]) {\rtext-align: left;\r}\r\r\r\r.main-container {\rmax-width: 940px;\rmargin-left: auto;\rmargin-right: auto;\r}\rcode {\rcolor: inherit;\rbackground-color: rgba(0, 0, 0, 0.04);\r}\rimg {\rmax-width:100%;\rheight: auto;\r}\r.tabbed-pane {\rpadding-top: 12px;\r}\r.html-widget {\rmargin-bottom: 20px;\r}\rbutton.code-folding-btn:focus {\routline: none;\r}\rsummary {\rdisplay: list-item;\r}\r\r.tabset-dropdown  .nav-tabs {\rdisplay: inline-table;\rmax-height: 500px;\rmin-height: 44px;\roverflow-y: auto;\rbackground: white;\rborder: 1px solid #ddd;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs  li.active:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li.active:before {\rcontent: \"\";\rborder: none;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs  li.active {\rdisplay: block;\r}\r.tabset-dropdown  .nav-tabs  li  a,\r.tabset-dropdown  .nav-tabs  li  a:focus,\r.tabset-dropdown  .nav-tabs  li  a:hover {\rborder: none;\rdisplay: inline-block;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li {\rdisplay: block;\rfloat: none;\r}\r.tabset-dropdown  .nav-tabs  li {\rdisplay: none;\r}\r\r\r$(document).ready(function () {\rwindow.buildTabsets(\"TOC\");\r});\r$(document).ready(function () {\r$('.tabset-dropdown  .nav-tabs  li').click(function () {\r$(this).parent().toggleClass('nav-tabs-open')\r});\r});\r\rLecture1: An introduction to R\rZhou Chao\r\rImportant: You only need to type the quoted commands in R console\nContent\rPart1: Some useful R commands 1.1 Command Warm Up 1.2 Data objects: Vectors 1.3 Data objects: Matrices 1.4 Data objects: Data frame 1.5 Data sorting\n1.6 Matrix calculations\n1.7 Reading and writing data\n1.8 Re-directing output and file management\n\rPart2: Financial data analysis\n\r\rPart1: Some useful R commands \r\n1.1 Command Warm Up \r\rTo launch a Web browser that allows to show the help pages type:\r\rhelp.start()\r\rTo obtain help on particular topic (e.g. ar: to fit an autoregressive time series model to the data) type:\r\r?ar # or help(ar)\r\rAssignment operator is \u0026lt;- or -\u0026gt; (less used). To type \u0026lt;-, useAlt + - in Windows or Option + - in macOS\r\rx \u0026lt;- 10\rx 5 -\u0026gt; x\rx\r\rThe difference of = and \u0026lt;-: the later one explictly declare a variable in environment, see below:\r\rmedian(x = 1:5)\rx ## Error: object 'x' not found\rmedian(x \u0026lt;- 1:5)\rx \rExtended: \u0026lt;\u0026lt;- is another operator which is useful in R Language Object-oriented programming (OOP), it will change the parent state variables in inheritance \rR is an object oriented program. It handles many types of object. Objects are created and stored by name. To display the names of (most of) the objects which are currently stored within R, the R command:\r\robjects()\r\rRemove variables:\r\rrm(x) #to remove the object obj type\rrm(list=ls(all=TRUE)) #to remove all objects \u0026gt; objects()\r\rTo use commands (e.g. functions) stored in an external file, e.g. commands.R in the current working directory work, type:\r\rsource(\u0026quot;commands.R\u0026quot;)\rabcfunction() #here we assume abcfuntion() is defined and stored in commands.R\r\rUse () for variable will print the variable out:\r\r(daisy \u0026lt;- \u0026quot;42029ef215256f8fa9fedb53542ee6553eef76027b116f8fac5346211b1e473c\u0026quot;)\r\rQuit R:\r\rq() # no need to try :)\r\r1.2 Data objects: Vectors \r\rUse c() to create a vector:\r\rvalue.num \u0026lt;- c(3,4,2,6,20) value.char \u0026lt;- c(\u0026quot;math\u0026quot;,\u0026quot;cs\u0026quot;,\u0026quot;finance\u0026quot;) value.logical \u0026lt;- c(F,F,T,T)\r\rThe rep function replicates elements of vector:\r\r(value \u0026lt;- rep(5,6))\r\rThe seq function creates a regular sequence of values to form a vector:\r\rseq(from=2,to=12,by=2)\r\rThe functions can be used in combination:\r\rvalue \u0026lt;- c(1,2,5,rep(3,4),seq(from=1,to=6,by=3)); value\r\rThe scan function is used to enter data at the terminal:\r\rvalue \u0026lt;- scan() #press \u0026quot;Esc\u0026quot; to exit\r\rVector operations\r\rx \u0026lt;- runif(10) # generates random vector of length 10 independent, uniformly distributed\rx\ry \u0026lt;- 10*x + 1\ry\rz \u0026lt;- (x-mean(x))/sd(x)\rz\rmean(x)\rsd(x)\r\r1.3 Data objects: Matrices \r\rA matrix may be created from a vector by using dim:\r\rvalue \u0026lt;- rnorm(10) # generates random vector of length 10 independent, normal distributed\rdim(value) \u0026lt;- c(2,5) #2× 5 matrix\rvalue\rdim(value) \u0026lt;- NULL # back to vector\rvalue\r\rIt may also be created from a vector by using matrix:\r\rvalue1 \u0026lt;- matrix(value,2,5); value1 #2,5 is the dimension of the matrix\rmatrix(value,2,5,byrow=T) #type ?matrix to see the difference\r\rTo bind a row onto an already existing matrix, the rbind function can be used:\r\rvalue2 \u0026lt;- rbind(value1,c(1,1,2,2,3)) # add one row\r\rTo bind a column onto an already existing matrix, the cbind function can be used:\r\rvalue3 \u0026lt;- cbind(value2,c(1,1,2)) # add one column\rvalue3\r\r1.4 Data objects: Data frame \r\rThe function data.frame converts a matrix or collection of vectors into a data frame:\r\rvalue3 \u0026lt;- data.frame(value3)\rvalue3\rvalue4 \u0026lt;- data.frame(rnorm(3),runif(3))\rvalue4\r\rTo view the row and column names of a data frame:\r\rnames(value4)\rrow.names(value4)\r\rAlternative labels can be assigned by doing the following:\r\rnames(value4) \u0026lt;- c(\u0026quot;C1\u0026quot;,\u0026quot;C2\u0026quot;)\rrow.names(value3) \u0026lt;- c(\u0026quot;R1\u0026quot;,\u0026quot;R2\u0026quot;,\u0026quot;R3\u0026quot;)\r\rNames can also be specified within the data.frame function itself:\r\rdata.frame(C1=rnorm(3),C2=runif(3),row.names=c(\u0026quot;R1\u0026quot;,\u0026quot;R2\u0026quot;,\u0026quot;R3\u0026quot;))\r\rThe following example is to show how to access elements of a vector or matrix:\r\rx \u0026lt;- sample(1:5, 10, rep=T) #produces a random sample of values between one and five, ten times\rx\rones \u0026lt;- (x == 1); ones #check if all the elements of x are equal to 1\rx[ones] \u0026lt;- 0\rx\rothers \u0026lt;- (x \u0026gt; 1)\ry \u0026lt;- x[others] #stores the values greater than 1 into y.\ry\rwhich(x \u0026gt; 1) #finds indices of elements bigger than 1\ry \u0026lt;- x[-(1:5)] #copies x without the first 5 elements. To exclude values, negative index vectors are used\ry\r\r1.5 Data sorting \rThe command order allows sorting with tie-breaking: Find an index vector that arranges the first of its arguments in increasing order. Ties are broken by the second argument and any remaining ties are broken by a third argument.\nx \u0026lt;- sample(1:5, 20, rep=T) y \u0026lt;- sample(1:5, 20, rep=T) z \u0026lt;- sample(1:5, 20, rep=T) xyz \u0026lt;- rbind(x, y, z) dimnames(xyz)[[2]] \u0026lt;- letters[1:20] #names the columns by the first 20 letters\rxyz\ro \u0026lt;- order(x, y, z) #orders the matrix xyz first by x, then by y and at last by z\rxyz[, o]\r\r1.6 Matrix calculations \rA*B #is the matrix of element by element products\rA %*% B #is the matrix product.\rx %*% A %*% x #is a quadratic form, if x is a vector\r(mat1 \u0026lt;- matrix(c(1,0,1,1), nrow=2))\r(mat2 \u0026lt;- matrix(c(1,1,0,1), nrow=2))\rsolve(mat1) # inverts the matrix\r#Matrix operation\rmat1 %*% mat2 # product\rmat1 + mat2 # Matrix addition\rt(mat1) # Matrix transposition\rdet(mat1) # Matrix determinant\r# diag()\r(A\u0026lt;-diag(c(1,2))) # input a vector\r(diag(A)) # input a matrix\r(diag(4)) # input a number\r\r1.7 Reading and writing data \rFor reading and writing in files, R uses the working directory, so make sure you either set the data file path or put data file at your working space.\ngetwd() # check current work space\rsetwd(\u0026quot;your working space path\u0026quot;) # set your working space\rThere are several ways to read and load data into the R working space, depending on the data format. For simple text data, the command is read.table. For .csv files, the command is read.csv. The data file is specified in either a single or double quotes; see examples below and the R commands of Lecture 1 available on IVLE. R treats the data as an object and refer to them by the assigned name. For both loading commands, R stores the data in a matrix framework. As such, one can use the command dim (i.e., dimension) to see the size of the data.\nread.table(\u0026quot;http://www.stats.ox.ac.uk/pub/datasets/csb/ch11b.dat\u0026quot;) # read via http\rread.table(\u0026quot;AAPL.txt\u0026quot;) # read via local file; make sure AAPL.txt is under your work space read.csv(\u0026quot;AAPL.csv\u0026quot;)\rWith the growing volume in dataset, the above commands may behave bad if data is larger than 500MB. We recommend to use fread instead. fread is a function in data.table package. Extension: both fread and read.csv are written via C language, but fread memory maps the file into memory and then iterates through the file using pointers. Whereas read.csv reads the file into a buffer via a connection.\ninstall.packages(\u0026quot;data.table\u0026quot;)\rrequire(data.table) system.time(fread(\u0026quot;AAPL.csv\u0026quot;)) # use system.time to check the performance of a function\rfread(\u0026quot;AAPL.txt\u0026quot;)\rAlso, fwrite is superior to write.csv, use fwrite instead. *Use ?fread and fwrite to see more info.\n\r1.8 Re-directing output and file management \rBy default, the output are showed in the R working space. However, you can re-direct the output to a file in your current working directory. See the following example:\nprint(\u0026quot;hello\u0026quot;) sink(\u0026quot;out.file\u0026quot;) print('hello') sink() file.show('out.file') # shows the file\rfile.remove('out.file') # removes out.file list.files() # no out.file any more\r\r\rPart2: Financial data analysis \rDownload the financial data of Leture 1 from IVLE, then analyse them (mean, variance, test, plot, etc) as shown on the Lecture by using the R commands.\n#2.1 load data\rrequire(data.table)\rrate \u0026lt;- fread(\u0026quot;EURUSD.csv\u0026quot;)\r#2.2 calculation\rmean(rate$rate)\rvar(rate$rate)\rvar(rate$return[-1]) # omit NA in first row\rhist(rate$rate)\rhist(rate$return)\rsummary(rate)\rfBasics::basicStats(rate$rate) ## need to install.packages(\u0026quot;fBasics\u0026quot;)\r#2.3 plot\rrequire(ggplot2)\rqplot(rate$time, rate$rate, rate, colour = I(\u0026quot;darkblue\u0026quot;), xlab = \u0026quot;time\u0026quot;,\rylab = \u0026quot;EU/USD Rate\u0026quot;,\rgeom = \u0026quot;line\u0026quot;)\rqplot(rate$time, rate$return, rate, colour = I(\u0026quot;darkred\u0026quot;), xlab = \u0026quot;time\u0026quot;,\rylab = \u0026quot;EU/USD return\u0026quot;,\rgeom = \u0026quot;line\u0026quot;)\r# for digital asset\rrequire(coinmarketcapr) ## install.packages(\u0026quot;coinmarketcapr\u0026quot;)\r## Loading required package: coinmarketcapr\r## Warning: package 'coinmarketcapr' was built under R version 3.4.4\rrequire(treemap) ## install.packages(\u0026quot;treemap\u0026quot;)\r## Loading required package: treemap\r## Warning: package 'treemap' was built under R version 3.4.4\rplot_top_5_currencies()\rmarket_today \u0026lt;- get_marketcap_ticker_all()\rhead(market_today[,1:8])\r## id name symbol rank price_usd price_btc\r## 1 bitcoin Bitcoin BTC 1 4068.53744485 1.0\r## 2 ethereum Ethereum ETH 2 139.334327768 0.03427599\r## 3 ripple XRP XRP 3 0.3094146194 0.00007612\r## 4 eos EOS EOS 4 4.2554984289 0.00104684\r## 5 litecoin Litecoin LTC 5 60.9539009492 0.01499455\r## 6 bitcoin-cash Bitcoin Cash BCH 6 169.678170527 0.04174052\r## X24h_volume_usd market_cap_usd\r## 1 9992201807.77 71670997597.0\r## 2 4499761131.45 14690390321.0\r## 3 759836701.765 12904620810.0\r## 4 2190870174.15 3856524674.0\r## 5 1867734118.86 3723986898.0\r## 6 562465066.029 3003023649.0\rdf1 \u0026lt;- na.omit(market_today[,c('id','market_cap_usd')])\rdf1$market_cap_usd \u0026lt;- as.numeric(df1$market_cap_usd)\rdf1$formatted_market_cap \u0026lt;- paste0(df1$id,'\\n','$',format(df1$market_cap_usd,big.mark = ',',scientific = F, trim = T))\rtreemap(df1, index = 'formatted_market_cap', vSize = 'market_cap_usd', title = 'Cryptocurrency Market Cap', fontsize.labels=c(12, 8), palette='RdYlGn')\r\r\r\r\r// add bootstrap table styles to pandoc tables\rfunction bootstrapStylePandocTables() {\r$('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r}\r$(document).ready(function () {\rbootstrapStylePandocTables();\r});\r\r\r(function () {\rvar script = document.createElement(\"script\");\rscript.type = \"text/javascript\";\rscript.src = \"https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\rdocument.getElementsByTagName(\"head\")[0].appendChild(script);\r})();\r\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"cb63ebbf7e7f03d96a58ca5eef91feaa","permalink":"https://GangSirius.github.io/teaching/tmseries/lecture1/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/tmseries/lecture1/","section":"teaching","summary":"Lecture1: An introduction to R\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.","tags":null,"title":"","type":"teaching"},{"authors":null,"categories":null,"content":"\rLecture10: RiskMetrics\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.table th:not([align]) {\rtext-align: left;\r}\r\r\r\r.main-container {\rmax-width: 940px;\rmargin-left: auto;\rmargin-right: auto;\r}\rcode {\rcolor: inherit;\rbackground-color: rgba(0, 0, 0, 0.04);\r}\rimg {\rmax-width:100%;\rheight: auto;\r}\r.tabbed-pane {\rpadding-top: 12px;\r}\r.html-widget {\rmargin-bottom: 20px;\r}\rbutton.code-folding-btn:focus {\routline: none;\r}\rsummary {\rdisplay: list-item;\r}\r\r.tabset-dropdown  .nav-tabs {\rdisplay: inline-table;\rmax-height: 500px;\rmin-height: 44px;\roverflow-y: auto;\rbackground: white;\rborder: 1px solid #ddd;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs  li.active:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li.active:before {\rcontent: \"\";\rborder: none;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs  li.active {\rdisplay: block;\r}\r.tabset-dropdown  .nav-tabs  li  a,\r.tabset-dropdown  .nav-tabs  li  a:focus,\r.tabset-dropdown  .nav-tabs  li  a:hover {\rborder: none;\rdisplay: inline-block;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li {\rdisplay: block;\rfloat: none;\r}\r.tabset-dropdown  .nav-tabs  li {\rdisplay: none;\r}\r\r\r$(document).ready(function () {\rwindow.buildTabsets(\"TOC\");\r});\r$(document).ready(function () {\r$('.tabset-dropdown  .nav-tabs  li').click(function () {\r$(this).parent().toggleClass('nav-tabs-open')\r});\r});\r\rLecture10: RiskMetrics\rZhou Chao\r\rImportant: You only need to type the quoted commands in R console\nContent\rData Loading \rRiskMetrics-IGARCH\n\rRiskMetrics-IGARCH\n\rEmpirical Quantile\n\rQuantile Regression\n\rExtreme Value Approach\n\rPeaks over the threshold\n\rGeneralized Pareto Distribution\n\r\r1. Data Loading \r\rLoading data and t-test\r\rda=read.table(\u0026quot;d-ibm-0110.txt\u0026quot;,header=T)\rhead(da)\r## date return\r## 1 20010102 -0.002206\r## 2 20010103 0.115696\r## 3 20010104 -0.015192\r## 4 20010105 0.008719\r## 5 20010108 -0.004654\r## 6 20010109 -0.010688\ribm=log(da$return+1)\rxt = -ibm*100 ##xt is then the loss variable (in percentage)\rt.test(xt)\r## ## One Sample t-test\r## ## data: xt\r## t = -0.78176, df = 2514, p-value = 0.4344\r## alternative hypothesis: true mean is not equal to 0\r## 95 percent confidence interval:\r## -0.09296051 0.03996638\r## sample estimates:\r## mean of x ## -0.02649706\r\r2. RiskMetrics-IGARCH \r\rFit model\r\rrequire(rugarch)\r## Loading required package: rugarch\r## Loading required package: parallel\r## ## Attaching package: 'rugarch'\r## The following object is masked from 'package:stats':\r## ## sigma\rrequire(fGarch)\r## Loading required package: fGarch\r## Loading required package: timeDate\r## Loading required package: timeSeries\r## Loading required package: fBasics\rspec3 = ugarchspec(variance.model=list(model=\u0026quot;iGARCH\u0026quot;, garchOrder=c(1,1)), mean.model=list(armaOrder=c(0,0), include.mean=FALSE),distribution.model=\u0026quot;norm\u0026quot;, fixed.pars=list(omega=0))\rfit = ugarchfit(spec3, data = xt)\rsummary(fit)\r## Length Class Mode ## 1 uGARCHfit S4\rfit\r## ## *---------------------------------*\r## * GARCH Model Fit *\r## *---------------------------------*\r## ## Conditional Variance Dynamics ## -----------------------------------\r## GARCH Model : iGARCH(1,1)\r## Mean Model : ARFIMA(0,0,0)\r## Distribution : norm ## ## Optimal Parameters\r## ------------------------------------\r## Estimate Std. Error t value Pr(\u0026gt;|t|)\r## omega 0.000000 NA NA NA\r## alpha1 0.057143 0.007172 7.9675 0\r## beta1 0.942857 NA NA NA\r## ## Robust Standard Errors:\r## Estimate Std. Error t value Pr(\u0026gt;|t|)\r## omega 0.000000 NA NA NA\r## alpha1 0.057143 0.021965 2.6015 0.009282\r## beta1 0.942857 NA NA NA\r## ## LogLikelihood : -4501.827 ## ## Information Criteria\r## ------------------------------------\r## ## Akaike 3.5808\r## Bayes 3.5831\r## Shibata 3.5808\r## Hannan-Quinn 3.5816\r## ## Weighted Ljung-Box Test on Standardized Residuals\r## ------------------------------------\r## statistic p-value\r## Lag[1] 0.06978 0.7917\r## Lag[2*(p+q)+(p+q)-1][2] 2.40452 0.2037\r## Lag[4*(p+q)+(p+q)-1][5] 4.59023 0.1891\r## d.o.f=0\r## H0 : No serial correlation\r## ## Weighted Ljung-Box Test on Standardized Squared Residuals\r## ------------------------------------\r## statistic p-value\r## Lag[1] 0.0508 0.8217\r## Lag[2*(p+q)+(p+q)-1][5] 2.0768 0.6004\r## Lag[4*(p+q)+(p+q)-1][9] 3.5069 0.6732\r## d.o.f=2\r## ## Weighted ARCH LM Tests\r## ------------------------------------\r## Statistic Shape Scale P-Value\r## ARCH Lag[3] 0.06369 0.500 2.000 0.8008\r## ARCH Lag[5] 2.89044 1.440 1.667 0.3061\r## ARCH Lag[7] 3.50081 2.315 1.543 0.4243\r## ## Nyblom stability test\r## ------------------------------------\r## Joint Statistic: 0.074\r## Individual Statistics: ## alpha1 0.07404\r## ## Asymptotic Critical Values (10% 5% 1%)\r## Joint Statistic: 0.353 0.47 0.748\r## Individual Statistic: 0.35 0.47 0.75\r## ## Sign Bias Test\r## ------------------------------------\r## t-value prob sig\r## Sign Bias 0.3907 0.6961 ## Negative Sign Bias 0.6239 0.5328 ## Positive Sign Bias 0.8428 0.3994 ## Joint Effect 3.4079 0.3329 ## ## ## Adjusted Pearson Goodness-of-Fit Test:\r## ------------------------------------\r## group statistic p-value(g-1)\r## 1 20 45.64 0.0005565\r## 2 30 63.01 0.0002572\r## 3 40 63.85 0.0072739\r## 4 50 87.33 0.0006231\r## ## ## Elapsed time : 0.8119991\rhead(sigma(fit))\r## [,1]\r## 1970-01-02 07:30:00 1.699656\r## 1970-01-03 07:30:00 1.651224\r## 1970-01-04 07:30:00 3.069140\r## 1970-01-05 07:30:00 3.002544\r## 1970-01-06 07:30:00 2.922872\r## 1970-01-07 07:30:00 2.840322\rtail(sigma(fit))\r## [,1]\r## 1976-11-15 07:30:00 0.8289833\r## 1976-11-16 07:30:00 0.8050096\r## 1976-11-17 07:30:00 0.7868684\r## 1976-11-18 07:30:00 0.7664697\r## 1976-11-19 07:30:00 0.7559542\r## 1976-11-20 07:30:00 0.7344453\rcoef(fit)\r## omega alpha1 beta1 ## 0.00000000 0.05714296 0.94285704\rvt = coef(fit)[3]*sigma(fit)[2515]^2+coef(fit)[2]*xt[2515]^2 ## volatility prediction; xt[2515]^2 because mean equation=0\r\rCalculate VaR\r\rsqrt(vt)*qnorm(.95) #VaR 0.95\r## [,1]\r## 1976-11-20 07:30:00 1.17328\rsqrt(vt)*qnorm(.99) #VaR 0.99\r## [,1]\r## 1976-11-20 07:30:00 1.659392\rsqrt(vt)*qnorm(.999) #VaR 0.999\r## [,1]\r## 1976-11-20 07:30:00 2.204273\r\r3. IGARCH \r\rFit model\r\rxt1 = -ibm #loss variable: negative log returns\r(m1 = garchFit(~garch(1,1),data=xt1,trace=F))\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~garch(1, 1), data = xt1, trace = F) ## ## Mean and Variance Equation:\r## data ~ garch(1, 1)\r## \u0026lt;environment: 0x00000000236edd80\u0026gt;\r## [data = xt1]\r## ## Conditional Distribution:\r## norm ## ## Coefficient(s):\r## mu omega alpha1 beta1 ## -6.0097e-04 4.3781e-06 1.0113e-01 8.8412e-01 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu -6.010e-04 2.393e-04 -2.511 0.012044 * ## omega 4.378e-06 1.160e-06 3.774 0.000161 ***\r## alpha1 1.011e-01 1.851e-02 5.463 4.67e-08 ***\r## beta1 8.841e-01 1.991e-02 44.413 \u0026lt; 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 7114.066 normalized: 2.828654 ## ## Description:\r## Mon Apr 15 17:33:02 2019 by user: Sirius\rpredict(m1,3)\r## meanForecast meanError standardDeviation\r## 1 -0.0006009667 0.007824302 0.007824302\r## 2 -0.0006009667 0.008043298 0.008043298\r## 3 -0.0006009667 0.008253382 0.008253382\r\rVaR\r\r-.000601+qnorm(.95)*.0078243 #VaR 0.95\r## [1] 0.01226883\r-.000601+qnorm(.99)*.0078243 #VaR 0.99\r## [1] 0.01760104\r-.000601+qnorm(.999)*.0078243 #VaR 0.999\r## [1] 0.0235779\r\rFit another model\r\rm2=garchFit(~garch(1,1),data=xt1,trace=F,cond.dist=\u0026quot;std\u0026quot;)\rm2\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~garch(1, 1), data = xt1, cond.dist = \u0026quot;std\u0026quot;, ## trace = F) ## ## Mean and Variance Equation:\r## data ~ garch(1, 1)\r## \u0026lt;environment: 0x00000000240e8238\u0026gt;\r## [data = xt1]\r## ## Conditional Distribution:\r## std ## ## Coefficient(s):\r## mu omega alpha1 beta1 shape ## -4.1127e-04 1.9223e-06 6.4480e-02 9.2863e-01 5.7513e+00 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu -4.113e-04 2.254e-04 -1.824 0.06811 . ## omega 1.922e-06 7.417e-07 2.592 0.00954 ** ## alpha1 6.448e-02 1.323e-02 4.874 1.09e-06 ***\r## beta1 9.286e-01 1.407e-02 65.993 \u0026lt; 2e-16 ***\r## shape 5.751e+00 6.080e-01 9.459 \u0026lt; 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 7218.69 normalized: 2.870254 ## ## Description:\r## Mon Apr 15 17:33:03 2019 by user: Sirius\rpredict(m2,3)\r## meanForecast meanError standardDeviation\r## 1 -0.0004112737 0.008100874 0.008100874\r## 2 -0.0004112737 0.008191121 0.008191121\r## 3 -0.0004112737 0.008279774 0.008279774\r\rVaR\r\r-.0004113+qstd(.95,nu=5.751)*.0081009\r## [1] 0.01240096\r-.0004113+qstd(.99,nu=5.751)*.0081009 \r## [1] 0.02045082\r-.0004113+qstd(.999,nu=5.751)*.0081009\r## [1] 0.03456563\r\r4. Empirical Quantile \rquantile(xt,c(.95,.99))\r## 95% 99% ## 2.653783 5.013151\r\rEmpirical expected shortfall or CVaR. 1st method\r\r\rsxt = sort(xt) # Sorting into increasing order\r0.95*2515\r## [1] 2389.25\r(es=sum(sxt[2390:2515])/(2515-2389))# ES 0.95\r## [1] 3.994857\r0.99*2515\r## [1] 2489.85\r(es=sum(sxt[2490:2515])/(2515-2489))# ES 0.99\r## [1] 6.074108\r\rEmpirical expected shortfall or CVaR. 2nd method\r\r\ridx=c(1:2515)[xt \u0026gt;= 2.653783]\rmean(xt[idx])\r## [1] 3.994857\ridx1=c(1:2515)[xt \u0026gt;= 5.013151]\rmean(xt[idx1])\r## [1] 6.074108\r\rEmpirical median shortfall\r\rmedian(xt[idx])\r## [1] 3.527853\rmedian(xt[idx1])\r## [1] 5.781306\r\r5. Quantile Regression \rrequire(quantreg)\r## Loading required package: quantreg\r## Loading required package: SparseM\r## ## Attaching package: 'SparseM'\r## The following object is masked from 'package:base':\r## ## backsolve\rda = read.table(\u0026quot;d-ibm-rq.txt\u0026quot;,header=T)\rhead(da)\r## nibm vol vix\r## 1 -0.109478400 0.01700121 29.99\r## 2 0.015308580 0.01614694 26.60\r## 3 -0.008681209 0.03786369 26.97\r## 4 0.004664864 0.03602087 28.67\r## 5 0.010745530 0.03403132 29.84\r## 6 -0.009408600 0.03211091 27.99\rnibm=da$nibm\rvol=da$vol\rvix=da$vix/100\rlength(nibm)\r## [1] 2514\rlength(vol)\r## [1] 2514\rlength(vix)\r## [1] 2514\rfit1 \u0026lt;- rq(nibm ~ vol + vix, tau = 0.95)\rsummary(fit1)\r## ## Call: rq(formula = nibm ~ vol + vix, tau = 0.95)\r## ## tau: [1] 0.95\r## ## Coefficients:\r## Value Std. Error t value Pr(\u0026gt;|t|)\r## (Intercept) -0.00104 0.00257 -0.40317 0.68686\r## vol 1.17724 0.22268 5.28661 0.00000\r## vix 0.02809 0.01615 1.73977 0.08202\rnames(fit1)\r## [1] \u0026quot;coefficients\u0026quot; \u0026quot;x\u0026quot; \u0026quot;y\u0026quot; \u0026quot;residuals\u0026quot; ## [5] \u0026quot;dual\u0026quot; \u0026quot;fitted.values\u0026quot; \u0026quot;formula\u0026quot; \u0026quot;terms\u0026quot; ## [9] \u0026quot;xlevels\u0026quot; \u0026quot;call\u0026quot; \u0026quot;tau\u0026quot; \u0026quot;rho\u0026quot; ## [13] \u0026quot;method\u0026quot; \u0026quot;model\u0026quot;\rfit1$coefficients\r## (Intercept) vol vix ## -0.001036872 1.177238592 0.028091939\rcoef(fit1)\r## (Intercept) vol vix ## -0.001036872 1.177238592 0.028091939\rplot(nibm,type='l',main='Negative daily log returns of IBM stock with 95th quantiles(red line)')\rlines(1:2514,fit1$fitted.values,col='red')\rtail(volatility(m1))#volatility of GARCH(1,1)\r## [1] 0.008923548 0.008653557 0.008516047 0.008299314 0.008230775 0.008018202\rvfit=-.00104+1.17724*volatility(m1)[2515]+0.02809*17.75/100 #17.75 is 2010-12-31 VIX\rvfit\r## [1] 0.01338532\rfit2 \u0026lt;- rq(nibm ~ vol + vix, tau = 0.99)\rsummary(fit2)\r## ## Call: rq(formula = nibm ~ vol + vix, tau = 0.99)\r## ## tau: [1] 0.99\r## ## Coefficients:\r## Value Std. Error t value Pr(\u0026gt;|t|)\r## (Intercept) 0.01182 0.00831 1.42190 0.15518 ## vol 1.03129 0.73125 1.41032 0.15857 ## vix 0.04409 0.05335 0.82641 0.40865\r\r6. Extreme Value Approach \rrequire(evir)\r## Loading required package: evir\r## Warning: package 'evir' was built under R version 3.4.4\rpar(mfcol=c(2,1))\r(m2=gev(xt,block=21))\r## $n.all\r## [1] 2515\r## ## $n\r## [1] 120\r## ## $data\r## [1] 4.0335654 4.6038703 6.9818569 4.6158081 2.9868660 1.8749682\r## [7] 5.1245927 3.6876663 3.3919828 2.3115108 2.0342513 2.4236342\r## [13] 4.8790114 4.7451211 10.6674712 7.3298915 3.1040820 6.3058018\r## [19] 4.9832257 4.1026182 7.0740111 5.3694069 3.2279420 3.3725360\r## [25] 5.6782014 2.8647448 3.1710505 1.7130900 4.1022015 2.0702832\r## [31] 4.0106625 1.2247698 2.1467793 3.8022791 1.2162666 1.2266932\r## [37] 2.0414975 1.9473382 2.0080266 1.8147677 1.4965425 2.0119037\r## [43] 1.8123238 1.7842230 1.6585787 1.1930891 1.6205604 1.2909976\r## [49] 1.9149181 1.5308581 1.0340277 8.6620544 2.2660828 2.3848119\r## [55] 1.1244989 1.7883969 1.4590932 1.2093837 0.6296783 2.6523663\r## [61] 2.1040814 1.4236865 1.5996261 1.8530637 2.7150255 2.1617994\r## [67] 1.6564436 1.1022525 2.1935841 0.8557511 2.0563997 0.9094227\r## [73] 3.3537135 3.0913950 1.4987757 2.4177945 3.2943735 2.0471111\r## [79] 3.4377182 1.7755704 1.6698650 3.2461210 5.6767196 3.6600708\r## [85] 2.7332143 2.5186535 1.4527008 2.3683247 2.7861553 2.8494129\r## [91] 1.7898222 2.8629954 6.0170475 6.1018324 5.9323344 2.7901656\r## [97] 3.5234509 5.1061742 4.8006072 1.9594729 2.0101692 3.0112876\r## [103] 1.2639544 1.4527008 1.4558462 5.0808149 1.2491697 1.2677015\r## [109] 2.9428811 0.8985247 0.7097125 2.2935008 4.0058744 3.0624170\r## [115] 2.5279860 2.0077205 0.9940241 3.4183660 1.5317720 0.7572600\r## ## $block\r## [1] 21\r## ## $par.ests\r## xi sigma mu ## 0.251353 1.028910 1.965850 ## ## $par.ses\r## xi sigma mu ## 0.08847742 0.09013351 0.10932034 ## ## $varcov\r## [,1] [,2] [,3]\r## [1,] 0.007828254 -0.001080741 -0.003453668\r## [2,] -0.001080741 0.008124049 0.006145413\r## [3,] -0.003453668 0.006145413 0.011950936\r## ## $converged\r## [1] 0\r## ## $nllh.final\r## [1] 210.1579\r## ## attr(,\u0026quot;class\u0026quot;)\r## [1] \u0026quot;gev\u0026quot;\r#### Model checking ####\r#plot(m2)\raa=1.0-(-21*log(1.0-0.05))^{-0.251353} #aa=1.0-(-n*log(1.0-prob))^{-xi}\r1.965850 - (1.028910/0.251353)*aa #mu - (sigma/xi)*aa. VaR 0.95 with evt\r## [1] 1.890084\raaa=1.0-(-21*log(1.0-0.01))^{-0.251353} #aaa=1.0-(-n*log(1.0-prob))^{-xi}\r1.965850 - (1.028910/0.251353)*aaa #mu - (sigma/xi)*aaa. VaR 0.99 with evt\r## [1] 3.924483\r10^(0.251353)*3.924483 #VaR 0.99 for 10 trading days\r## [1] 7.000603\r\r7. Peaks over the threshold \rrequire(evir)\r(m3=pot(xt,1.0)) ## Threshold is set to 1%.\r## $n\r## [1] 2515\r## ## $period\r## [1] 1 2515\r## ## $data\r## [1] 1.530858 1.074553 1.139063 2.445357 4.033565 3.370467 2.432958\r## [8] 1.857648 1.005943 1.535935 3.090776 3.644098 4.603870 2.607296\r## [15] 2.657090 3.600134 1.009276 6.981857 3.902361 3.548315 5.883429\r## [22] 4.754874 5.251088 1.593021 4.615808 2.010883 1.649022 1.270436\r## [29] 2.495377 2.659349 1.484058 1.533295 2.986866 1.516440 2.171099\r## [36] 2.299129 1.874968 1.535631 1.841349 1.205335 5.124593 1.685526\r## [43] 2.670955 3.994738 1.273981 1.233982 1.555739 1.823627 1.126825\r## [50] 1.102960 2.145860 1.803567 3.687666 1.129657 2.369656 1.449251\r## [57] 3.298301 2.745650 3.154124 3.391983 1.434135 1.390320 1.606638\r## [64] 2.311511 2.034251 1.847970 1.811407 1.271145 1.043324 2.423634\r## [71] 1.591091 1.241778 1.905745 1.509638 1.896368 1.227503 4.826945\r## [78] 3.337376 2.381023 1.039383 4.879011 1.117319 2.584000 4.745121\r## [85] 3.310084 2.994800 1.176797 2.466674 1.224061 1.868651 1.111252\r## [92] 1.950703 1.102253 1.874357 3.625017 10.667471 5.567234 1.625642\r## [99] 1.209485 2.333516 2.511578 7.329891 3.104082 1.153123 1.457673\r## [106] 1.191166 1.492990 1.234995 2.212803 2.951738 1.111049 1.722042\r## [113] 1.934287 1.720415 1.118937 1.567826 3.470118 2.442692 4.033878\r## [120] 1.590786 6.305802 3.038911 2.312636 1.314806 2.842828 4.983226\r## [127] 2.139525 4.346925 1.955190 3.101606 2.823796 1.490046 1.958351\r## [134] 1.226390 1.855407 2.467289 1.631639 4.102618 2.124713 1.869262\r## [141] 3.190561 3.114191 7.074011 1.367305 5.882156 1.583674 2.713073\r## [148] 3.455314 2.549834 5.833593 3.532256 5.369407 1.413037 3.408640\r## [155] 3.227942 1.737609 1.042819 1.028269 1.331323 2.423122 1.799901\r## [162] 3.372536 1.571687 1.618020 1.480201 1.592310 1.462848 1.445294\r## [169] 2.127062 1.123892 1.773840 5.678201 1.048477 2.574457 2.547064\r## [176] 1.404010 1.156664 1.753891 2.134724 2.864745 3.171051 2.303119\r## [183] 3.038911 1.376835 1.713090 1.073845 1.561427 1.206246 1.432715\r## [190] 1.017358 2.895827 4.102201 2.828940 2.284804 1.439714 2.070283\r## [197] 1.372476 1.108623 1.109027 1.699154 4.010663 1.467921 1.216267\r## [204] 1.032209 1.590278 1.224770 1.098006 1.782696 2.047009 2.146779\r## [211] 1.260005 3.802279 1.216267 1.136231 1.226693 1.986501 2.041497\r## [218] 1.057168 1.447729 1.336390 1.397013 1.947338 1.567319 2.008027\r## [225] 1.599016 1.333552 1.814768 1.413037 1.482028 1.026854 1.496543\r## [232] 1.023621 1.551473 2.011904 1.322507 1.234995 1.415978 1.136939\r## [239] 1.812324 1.541419 1.784223 1.658579 1.193089 1.079607 1.328181\r## [246] 1.620560 1.290998 1.080011 1.914918 1.530858 1.023722 1.034028\r## [253] 1.611109 1.385656 1.105791 8.662054 1.538169 4.706226 1.490655\r## [260] 2.071100 2.266083 2.030884 2.037415 1.047871 2.384812 1.873949\r## [267] 1.124499 1.788397 1.465182 1.348654 1.126724 1.459093 1.209384\r## [274] 1.195214 1.087189 1.384642 1.168096 2.652366 1.446512 2.104081\r## [281] 1.563357 1.100332 1.423686 1.491264 1.599626 1.151504 1.755825\r## [288] 1.853064 1.089210 1.460615 2.715026 1.427744 2.161799 1.303053\r## [295] 1.656444 1.654207 1.102253 2.193584 2.056400 1.186208 3.353714\r## [302] 1.079910 3.091395 1.091536 1.495933 1.005640 1.498776 1.356864\r## [309] 2.417795 1.055248 1.555942 3.294373 2.047111 1.338316 3.437718\r## [316] 1.190458 2.011598 1.394174 1.526492 1.277526 1.775570 1.157068\r## [323] 1.669865 3.246121 2.219551 1.519994 2.150049 1.043930 1.504562\r## [330] 4.577486 5.676720 1.753688 2.483075 1.167084 2.019250 2.181728\r## [337] 2.218426 2.252990 1.179327 1.772517 1.824137 3.205326 3.660071\r## [344] 1.073643 2.489533 2.277540 1.074452 2.130842 2.260866 1.059897\r## [351] 2.733214 1.214040 2.134826 1.098714 1.053126 1.204728 2.518653\r## [358] 1.249271 1.196125 1.452701 2.368325 1.135725 1.765595 1.045951\r## [365] 1.041101 1.254030 1.612227 2.786155 2.159040 1.278741 1.840534\r## [372] 2.808368 1.274183 2.849413 1.137242 1.789822 1.052520 1.730589\r## [379] 1.095984 1.410704 1.642719 1.670780 2.314274 2.765181 2.862995\r## [386] 1.936938 3.228872 4.026590 2.246342 4.242119 6.017047 5.018023\r## [393] 1.248967 2.764050 5.065560 5.479310 1.726621 1.414456 5.840378\r## [400] 4.025445 6.101832 2.740203 2.980478 3.774860 4.887307 2.821431\r## [407] 1.356458 3.693166 4.717023 3.612367 5.268795 5.729019 5.932334\r## [414] 4.086366 2.590465 2.790166 2.166807 1.848887 1.709835 1.626964\r## [421] 2.885946 2.551578 3.523451 1.487712 2.466366 3.735509 1.302242\r## [428] 3.436476 2.859908 5.106174 3.291686 1.447831 2.271709 1.927457\r## [435] 2.752845 1.038676 4.800607 2.805797 1.735676 1.108016 1.330005\r## [442] 1.959473 1.077989 1.629505 1.190357 1.393464 1.189142 2.010169\r## [449] 1.431294 1.093760 1.302242 1.341255 3.011288 1.446715 1.232059\r## [456] 1.263954 1.452701 1.018267 1.158788 1.455846 1.439917 5.080815\r## [463] 1.600439 1.917365 1.856425 1.249170 1.114487 1.023015 1.267701\r## [470] 1.215356 1.052520 2.942881 2.750687 2.063443 1.105084 2.139525\r## [477] 1.939589 1.471778 1.125409 1.148571 2.293501 1.479592 4.005874\r## [484] 1.041404 2.116644 1.038676 1.486697 3.062417 1.295455 2.079268\r## [491] 2.527986 1.016650 1.536342 1.185499 1.092041 1.249170 2.007720\r## [498] 1.072026 1.285831 3.418366 1.168905 1.531772 1.172750 1.005842\r## attr(,\u0026quot;times\u0026quot;)\r## [1] 3 6 10 14 21 23 27 28 30 33 34 35 37 39\r## [15] 40 42 46 47 48 50 52 54 60 63 64 68 70 71\r## [29] 77 84 85 90 91 101 102 103 115 118 125 127 129 130\r## [43] 131 137 141 144 150 152 157 159 161 166 168 171 172 173\r## [57] 175 178 179 182 183 191 198 205 217 225 226 229 232 237\r## [71] 248 252 255 256 257 259 261 262 263 266 267 271 274 280\r## [85] 281 283 286 293 297 302 304 305 309 310 313 314 317 321\r## [99] 324 328 333 334 337 341 344 345 348 349 352 353 356 357\r## [113] 358 359 360 364 365 366 367 369 373 377 378 379 383 387\r## [127] 388 391 394 395 397 408 411 412 413 414 416 417 419 423\r## [141] 424 428 429 430 432 434 435 436 438 440 443 448 452 454\r## [155] 464 465 471 472 477 481 482 485 488 491 492 497 498 499\r## [169] 505 510 511 512 514 516 520 523 529 536 538 546 556 558\r## [183] 561 565 568 575 579 585 592 594 595 605 607 608 613 619\r## [197] 621 623 624 631 636 638 643 645 649 663 671 674 682 684\r## [211] 688 700 716 725 753 758 760 769 770 776 787 797 799 800\r## [225] 802 806 825 827 834 835 841 846 879 881 885 890 892 899\r## [239] 902 905 906 934 949 973 982 987 995 1006 1016 1031 1039 1066\r## [253] 1072 1074 1075 1076 1078 1079 1085 1090 1093 1107 1110 1111 1124 1125\r## [267] 1153 1157 1161 1173 1184 1186 1201 1207 1213 1241 1243 1244 1261 1269\r## [281] 1279 1285 1292 1312 1323 1325 1330 1337 1350 1361 1365 1375 1385 1388\r## [295] 1389 1402 1428 1438 1484 1513 1519 1534 1545 1546 1548 1552 1555 1575\r## [309] 1580 1605 1606 1614 1626 1649 1652 1655 1659 1664 1666 1672 1679 1682\r## [323] 1697 1707 1709 1712 1718 1720 1722 1723 1724 1727 1730 1732 1734 1738\r## [337] 1745 1748 1749 1756 1758 1759 1761 1762 1763 1766 1768 1772 1775 1781\r## [351] 1782 1784 1789 1791 1798 1799 1803 1812 1817 1821 1828 1839 1841 1854\r## [365] 1855 1856 1863 1867 1870 1874 1877 1881 1883 1889 1901 1902 1906 1912\r## [379] 1913 1917 1918 1922 1926 1927 1929 1932 1936 1938 1941 1946 1948 1949\r## [393] 1950 1951 1952 1953 1954 1955 1958 1962 1963 1965 1966 1973 1974 1976\r## [407] 1977 1978 1980 1981 1983 1984 1990 1993 1996 1998 2003 2005 2006 2015\r## [421] 2017 2020 2023 2025 2030 2038 2041 2042 2044 2046 2051 2052 2054 2055\r## [435] 2056 2063 2070 2077 2080 2088 2089 2098 2099 2102 2103 2107 2108 2111\r## [449] 2115 2123 2129 2135 2137 2139 2142 2150 2168 2177 2179 2197 2200 2211\r## [463] 2214 2216 2221 2240 2252 2254 2263 2265 2269 2275 2277 2281 2282 2286\r## [477] 2337 2342 2345 2347 2349 2350 2359 2363 2369 2381 2383 2386 2387 2398\r## [491] 2400 2401 2416 2417 2423 2425 2427 2429 2434 2464 2482 2489 2491 2493\r## ## $span\r## [1] 2514\r## ## $threshold\r## [1] 1\r## ## $p.less.thresh\r## [1] 0.7996024\r## ## $n.exceed\r## [1] 504\r## ## $run\r## [1] NA\r## ## $par.ests\r## xi sigma mu beta ## 0.1073161 0.8913773 -0.5633651 1.0591516 ## ## $par.ses\r## xi sigma mu ## 0.05468298 0.13084522 0.16921433 ## ## $varcov\r## [,1] [,2] [,3]\r## [1,] 0.002990229 -0.006738203 0.00795378\r## [2,] -0.006738203 0.017120472 -0.02111842\r## [3,] 0.007953780 -0.021118424 0.02863349\r## ## $intensity\r## [1] 0.2004773\r## ## $nllh.final\r## [1] 1900.967\r## ## $converged\r## [1] 0\r## ## attr(,\u0026quot;class\u0026quot;)\r## [1] \u0026quot;potd\u0026quot;\r## Model checking\r#plot(m3)\r\rVaR and CVaR calculation\r\rriskmeasures(m3,c(.95,.99,.999))\r## p quantile sfall\r## [1,] 0.950 2.585581 3.962676\r## [2,] 0.990 4.745218 6.381938\r## [3,] 0.999 8.561586 10.657100\r\r8. Generalized Pareto distribution \r(m4=gpd(xt,1.0)) ### Threshold 1%\r## $n\r## [1] 2515\r## ## $data\r## [1] 1.530858 1.074553 1.139063 2.445357 4.033565 3.370467 2.432958\r## [8] 1.857648 1.005943 1.535935 3.090776 3.644098 4.603870 2.607296\r## [15] 2.657090 3.600134 1.009276 6.981857 3.902361 3.548315 5.883429\r## [22] 4.754874 5.251088 1.593021 4.615808 2.010883 1.649022 1.270436\r## [29] 2.495377 2.659349 1.484058 1.533295 2.986866 1.516440 2.171099\r## [36] 2.299129 1.874968 1.535631 1.841349 1.205335 5.124593 1.685526\r## [43] 2.670955 3.994738 1.273981 1.233982 1.555739 1.823627 1.126825\r## [50] 1.102960 2.145860 1.803567 3.687666 1.129657 2.369656 1.449251\r## [57] 3.298301 2.745650 3.154124 3.391983 1.434135 1.390320 1.606638\r## [64] 2.311511 2.034251 1.847970 1.811407 1.271145 1.043324 2.423634\r## [71] 1.591091 1.241778 1.905745 1.509638 1.896368 1.227503 4.826945\r## [78] 3.337376 2.381023 1.039383 4.879011 1.117319 2.584000 4.745121\r## [85] 3.310084 2.994800 1.176797 2.466674 1.224061 1.868651 1.111252\r## [92] 1.950703 1.102253 1.874357 3.625017 10.667471 5.567234 1.625642\r## [99] 1.209485 2.333516 2.511578 7.329891 3.104082 1.153123 1.457673\r## [106] 1.191166 1.492990 1.234995 2.212803 2.951738 1.111049 1.722042\r## [113] 1.934287 1.720415 1.118937 1.567826 3.470118 2.442692 4.033878\r## [120] 1.590786 6.305802 3.038911 2.312636 1.314806 2.842828 4.983226\r## [127] 2.139525 4.346925 1.955190 3.101606 2.823796 1.490046 1.958351\r## [134] 1.226390 1.855407 2.467289 1.631639 4.102618 2.124713 1.869262\r## [141] 3.190561 3.114191 7.074011 1.367305 5.882156 1.583674 2.713073\r## [148] 3.455314 2.549834 5.833593 3.532256 5.369407 1.413037 3.408640\r## [155] 3.227942 1.737609 1.042819 1.028269 1.331323 2.423122 1.799901\r## [162] 3.372536 1.571687 1.618020 1.480201 1.592310 1.462848 1.445294\r## [169] 2.127062 1.123892 1.773840 5.678201 1.048477 2.574457 2.547064\r## [176] 1.404010 1.156664 1.753891 2.134724 2.864745 3.171051 2.303119\r## [183] 3.038911 1.376835 1.713090 1.073845 1.561427 1.206246 1.432715\r## [190] 1.017358 2.895827 4.102201 2.828940 2.284804 1.439714 2.070283\r## [197] 1.372476 1.108623 1.109027 1.699154 4.010663 1.467921 1.216267\r## [204] 1.032209 1.590278 1.224770 1.098006 1.782696 2.047009 2.146779\r## [211] 1.260005 3.802279 1.216267 1.136231 1.226693 1.986501 2.041497\r## [218] 1.057168 1.447729 1.336390 1.397013 1.947338 1.567319 2.008027\r## [225] 1.599016 1.333552 1.814768 1.413037 1.482028 1.026854 1.496543\r## [232] 1.023621 1.551473 2.011904 1.322507 1.234995 1.415978 1.136939\r## [239] 1.812324 1.541419 1.784223 1.658579 1.193089 1.079607 1.328181\r## [246] 1.620560 1.290998 1.080011 1.914918 1.530858 1.023722 1.034028\r## [253] 1.611109 1.385656 1.105791 8.662054 1.538169 4.706226 1.490655\r## [260] 2.071100 2.266083 2.030884 2.037415 1.047871 2.384812 1.873949\r## [267] 1.124499 1.788397 1.465182 1.348654 1.126724 1.459093 1.209384\r## [274] 1.195214 1.087189 1.384642 1.168096 2.652366 1.446512 2.104081\r## [281] 1.563357 1.100332 1.423686 1.491264 1.599626 1.151504 1.755825\r## [288] 1.853064 1.089210 1.460615 2.715026 1.427744 2.161799 1.303053\r## [295] 1.656444 1.654207 1.102253 2.193584 2.056400 1.186208 3.353714\r## [302] 1.079910 3.091395 1.091536 1.495933 1.005640 1.498776 1.356864\r## [309] 2.417795 1.055248 1.555942 3.294373 2.047111 1.338316 3.437718\r## [316] 1.190458 2.011598 1.394174 1.526492 1.277526 1.775570 1.157068\r## [323] 1.669865 3.246121 2.219551 1.519994 2.150049 1.043930 1.504562\r## [330] 4.577486 5.676720 1.753688 2.483075 1.167084 2.019250 2.181728\r## [337] 2.218426 2.252990 1.179327 1.772517 1.824137 3.205326 3.660071\r## [344] 1.073643 2.489533 2.277540 1.074452 2.130842 2.260866 1.059897\r## [351] 2.733214 1.214040 2.134826 1.098714 1.053126 1.204728 2.518653\r## [358] 1.249271 1.196125 1.452701 2.368325 1.135725 1.765595 1.045951\r## [365] 1.041101 1.254030 1.612227 2.786155 2.159040 1.278741 1.840534\r## [372] 2.808368 1.274183 2.849413 1.137242 1.789822 1.052520 1.730589\r## [379] 1.095984 1.410704 1.642719 1.670780 2.314274 2.765181 2.862995\r## [386] 1.936938 3.228872 4.026590 2.246342 4.242119 6.017047 5.018023\r## [393] 1.248967 2.764050 5.065560 5.479310 1.726621 1.414456 5.840378\r## [400] 4.025445 6.101832 2.740203 2.980478 3.774860 4.887307 2.821431\r## [407] 1.356458 3.693166 4.717023 3.612367 5.268795 5.729019 5.932334\r## [414] 4.086366 2.590465 2.790166 2.166807 1.848887 1.709835 1.626964\r## [421] 2.885946 2.551578 3.523451 1.487712 2.466366 3.735509 1.302242\r## [428] 3.436476 2.859908 5.106174 3.291686 1.447831 2.271709 1.927457\r## [435] 2.752845 1.038676 4.800607 2.805797 1.735676 1.108016 1.330005\r## [442] 1.959473 1.077989 1.629505 1.190357 1.393464 1.189142 2.010169\r## [449] 1.431294 1.093760 1.302242 1.341255 3.011288 1.446715 1.232059\r## [456] 1.263954 1.452701 1.018267 1.158788 1.455846 1.439917 5.080815\r## [463] 1.600439 1.917365 1.856425 1.249170 1.114487 1.023015 1.267701\r## [470] 1.215356 1.052520 2.942881 2.750687 2.063443 1.105084 2.139525\r## [477] 1.939589 1.471778 1.125409 1.148571 2.293501 1.479592 4.005874\r## [484] 1.041404 2.116644 1.038676 1.486697 3.062417 1.295455 2.079268\r## [491] 2.527986 1.016650 1.536342 1.185499 1.092041 1.249170 2.007720\r## [498] 1.072026 1.285831 3.418366 1.168905 1.531772 1.172750 1.005842\r## ## $threshold\r## [1] 1\r## ## $p.less.thresh\r## [1] 0.7996024\r## ## $n.exceed\r## [1] 504\r## ## $method\r## [1] \u0026quot;ml\u0026quot;\r## ## $par.ests\r## xi beta ## 0.1072777 1.0591719 ## ## $par.ses\r## xi beta ## 0.05465781 0.07450330 ## ## $varcov\r## [,1] [,2]\r## [1,] 0.002987476 -0.002914008\r## [2,] -0.002914008 0.005550741\r## ## $information\r## [1] \u0026quot;observed\u0026quot;\r## ## $converged\r## [1] 0\r## ## $nllh.final\r## [1] 587.0113\r## ## attr(,\u0026quot;class\u0026quot;)\r## [1] \u0026quot;gpd\u0026quot;\rnames(m4)\r## [1] \u0026quot;n\u0026quot; \u0026quot;data\u0026quot; \u0026quot;threshold\u0026quot; \u0026quot;p.less.thresh\u0026quot;\r## [5] \u0026quot;n.exceed\u0026quot; \u0026quot;method\u0026quot; \u0026quot;par.ests\u0026quot; \u0026quot;par.ses\u0026quot; ## [9] \u0026quot;varcov\u0026quot; \u0026quot;information\u0026quot; \u0026quot;converged\u0026quot; \u0026quot;nllh.final\u0026quot;\rpar(mfcol=c(2,2))\r#plot(m4)\rriskmeasures(m4,c(.95,.99,.999))\r## p quantile sfall\r## [1,] 0.950 2.585569 3.962557\r## [2,] 0.990 4.745063 6.381556\r## [3,] 0.999 8.560890 10.655928\rm5=gpd(xt,1.2) ### Threshold 1.2%\rriskmeasures(m5,c(.95,.99,.999))\r## p quantile sfall\r## [1,] 0.950 2.611388 3.960077\r## [2,] 0.990 4.745530 6.266801\r## [3,] 0.999 8.282208 10.089481\rm6=gpd(xt,0.8) ### Threshold 0.8%\rriskmeasures(m6,c(.95,.99,.999))\r## p quantile sfall\r## [1,] 0.950 2.586713 3.961958\r## [2,] 0.990 4.744087 6.375946\r## [3,] 0.999 8.548816 10.633237\r\r\r\r\r// add bootstrap table styles to pandoc tables\rfunction bootstrapStylePandocTables() {\r$('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r}\r$(document).ready(function () {\rbootstrapStylePandocTables();\r});\r\r\r(function () {\rvar script = document.createElement(\"script\");\rscript.type = \"text/javascript\";\rscript.src = \"https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\rdocument.getElementsByTagName(\"head\")[0].appendChild(script);\r})();\r\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"f0fa95624cfced5e0b8446018267e5e2","permalink":"https://GangSirius.github.io/teaching/tmseries/lecture10/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/tmseries/lecture10/","section":"teaching","summary":"Lecture10: RiskMetrics\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.","tags":null,"title":"","type":"teaching"},{"authors":null,"categories":null,"content":"\rLecture11: MTS\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.table th:not([align]) {\rtext-align: left;\r}\r\r\r\r.main-container {\rmax-width: 940px;\rmargin-left: auto;\rmargin-right: auto;\r}\rcode {\rcolor: inherit;\rbackground-color: rgba(0, 0, 0, 0.04);\r}\rimg {\rmax-width:100%;\rheight: auto;\r}\r.tabbed-pane {\rpadding-top: 12px;\r}\r.html-widget {\rmargin-bottom: 20px;\r}\rbutton.code-folding-btn:focus {\routline: none;\r}\rsummary {\rdisplay: list-item;\r}\r\r.tabset-dropdown  .nav-tabs {\rdisplay: inline-table;\rmax-height: 500px;\rmin-height: 44px;\roverflow-y: auto;\rbackground: white;\rborder: 1px solid #ddd;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs  li.active:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li.active:before {\rcontent: \"\";\rborder: none;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs  li.active {\rdisplay: block;\r}\r.tabset-dropdown  .nav-tabs  li  a,\r.tabset-dropdown  .nav-tabs  li  a:focus,\r.tabset-dropdown  .nav-tabs  li  a:hover {\rborder: none;\rdisplay: inline-block;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li {\rdisplay: block;\rfloat: none;\r}\r.tabset-dropdown  .nav-tabs  li {\rdisplay: none;\r}\r\r\r$(document).ready(function () {\rwindow.buildTabsets(\"TOC\");\r});\r$(document).ready(function () {\r$('.tabset-dropdown  .nav-tabs  li').click(function () {\r$(this).parent().toggleClass('nav-tabs-open')\r});\r});\r\rLecture11: MTS\rZhou Chao\r\rImportant: You only need to type the quoted commands in R console\nContent\rSimulate a VAR(1) model \rFinancial data\n\rModeling\n\rResidual checking\n\rPrediction\n\rCo-integration\n\r\r1. Simulate a VAR(1) model \r\rSimulate a VAR(1) model\r\rrequire(MTS)\r## Loading required package: MTS\rrequire(ggplot2)\r## Loading required package: ggplot2\r(p1=matrix(c(0.5,-0.25,-1,0.5),2,2))\r## [,1] [,2]\r## [1,] 0.50 -1.0\r## [2,] -0.25 0.5\r(sig=matrix(c(1,0,0,1),2,2))\r## [,1] [,2]\r## [1,] 1 0\r## [2,] 0 1\rm1 \u0026lt;- VARMAsim(400,arlags=c(1),phi=p1,sigma=sig) qplot(x = 1:length(m1$series[,1]), y = m1$series[,1], geom = \u0026quot;line\u0026quot;, xlab = \u0026quot;time index\u0026quot;,\rylab = \u0026quot;column1\u0026quot;)\rqplot(x = 1:length(m1$series[,2]), y = m1$series[,2], geom = \u0026quot;line\u0026quot;, xlab = \u0026quot;time index\u0026quot;,\rylab = \u0026quot;column2\u0026quot;)\racf(m1$series[,1])\racf(m1$series[,2])\r\r2. RiskMetrics-IGARCH \r\rData loading and visualization\r\rda = read.table(\u0026quot;q-gdp-ukcaus.txt\u0026quot;,header=T)\rdim(da)\r## [1] 126 5\rhead(da)\r## year mon uk ca us\r## 1 1980 1 172436 624794 5908500\r## 2 1980 4 169359 623433 5787400\r## 3 1980 7 169038 623215 5776600\r## 4 1980 10 167180 630215 5883500\r## 5 1981 1 166052 645957 6005700\r## 6 1981 4 166393 651954 5957800\rgdp = log(da[,3:5])\rqplot(1:length(gdp[,1]), gdp[,1],type=\u0026quot;l\u0026quot;, xlab = \u0026quot;time index\u0026quot;, ylab = \u0026quot;UK(log)\u0026quot;)\rqplot(1:length(gdp[,2]), gdp[,2],type=\u0026quot;l\u0026quot;, xlab = \u0026quot;time index\u0026quot;, ylab = \u0026quot;CA(log)\u0026quot;)\rqplot(1:length(gdp[,3]), gdp[,3],type=\u0026quot;l\u0026quot;, xlab = \u0026quot;time index\u0026quot;, ylab = \u0026quot;US(log)\u0026quot;)\r\rComputes the multivariate Ljung-Box statistics for cross-correlation matrices\r\rmq(gdp,10) \r## Ljung-Box Statistics: ## m Q(m) df p-value\r## [1,] 1 331 9 0\r## [2,] 2 613 18 0\r## [3,] 3 853 27 0\r## [4,] 4 1064 36 0\r## [5,] 5 1255 45 0\r## [6,] 6 1434 54 0\r## [7,] 7 1605 63 0\r## [8,] 8 1768 72 0\r## [9,] 9 1920 81 0\r## [10,] 10 2063 90 0\r\rCompute the growth rate of gdp. ‘2’ indicates columns\r\rzt=apply(gdp,2,diff) mq(zt,10) ##The results show that the 3-dimensional series is strongly serially correlated\r## Ljung-Box Statistics: ## m Q(m) df p-value\r## [1,] 1.0 79.1 9.0 0\r## [2,] 2.0 118.1 18.0 0\r## [3,] 3.0 143.3 27.0 0\r## [4,] 4.0 163.9 36.0 0\r## [5,] 5.0 174.7 45.0 0\r## [6,] 6.0 185.0 54.0 0\r## [7,] 7.0 199.8 63.0 0\r## [8,] 8.0 214.1 72.0 0\r## [9,] 9.0 219.7 81.0 0\r## [10,] 10.0 226.7 90.0 0\r\r3. Modeling \r\rIdentifying VAR order\r\rm1 = VARorderI(zt)\r## selected order: aic = 8 ## selected order: bic = 1 ## selected order: hq = 4 ## M statistic and its p-value ## Mstat pv\r## [1,] 115.806 0.0000000\r## [2,] 19.481 0.0213966\r## [3,] 23.054 0.0060759\r## [4,] 31.546 0.0002385\r## [5,] 14.840 0.0954378\r## [6,] 11.959 0.2156223\r## [7,] 13.921 0.1251771\r## [8,] 27.994 0.0009562\r## [9,] 12.384 0.1925391\r## [10,] 6.985 0.6386805\r## [11,] 16.819 0.0516252\r## [12,] 11.173 0.2640476\r## [13,] 14.962 0.0919874\r## Summary table: ## p AIC BIC HQ M(p) p-value\r## [1,] 0 -30.158 -30.158 -30.158 0.000 0.00000000\r## [2,] 1 -31.090 -30.885 -31.007 115.806 0.00000000\r## [3,] 2 -31.129 -30.717 -30.961 19.481 0.02139658\r## [4,] 3 -31.206 -30.585 -30.954 23.054 0.00607588\r## [5,] 4 -31.374 -30.542 -31.036 31.546 0.00023853\r## [6,] 5 -31.374 -30.329 -30.950 14.840 0.09543785\r## [7,] 6 -31.346 -30.085 -30.834 11.959 0.21562235\r## [8,] 7 -31.341 -29.862 -30.740 13.921 0.12517713\r## [9,] 8 -31.502 -29.802 -30.812 27.994 0.00095624\r## [10,] 9 -31.484 -29.562 -30.704 12.384 0.19253910\r## [11,] 10 -31.402 -29.254 -30.530 6.985 0.63868053\r## [12,] 11 -31.448 -29.072 -30.483 16.819 0.05162521\r## [13,] 12 -31.423 -28.816 -30.365 11.173 0.26404756\r## [14,] 13 -31.455 -28.615 -30.302 14.962 0.09198740\rm2 = VAR(zt,1) ## based on BIC, estimate a VAR(1) model\r## Constant term: ## Estimates: 0.001713324 0.001182869 0.002785892 ## Std.Error: 0.0006790162 0.0007193106 0.0007877173 ## AR coefficient matrix ## AR( 1 )-matrix ## [,1] [,2] [,3]\r## [1,] 0.434 0.189 0.0373\r## [2,] 0.185 0.245 0.3917\r## [3,] 0.322 0.182 0.1674\r## standard error ## [,1] [,2] [,3]\r## [1,] 0.0811 0.0827 0.0872\r## [2,] 0.0859 0.0877 0.0923\r## [3,] 0.0940 0.0960 0.1011\r## ## Residuals cov-mtx: ## [,1] [,2] [,3]\r## [1,] 2.893347e-05 1.965508e-06 6.619853e-06\r## [2,] 1.965508e-06 3.246932e-05 1.686272e-05\r## [3,] 6.619853e-06 1.686272e-05 3.893867e-05\r## ## det(SSE) = 2.721916e-14 ## AIC = -31.09086 ## BIC = -30.88722 ## HQ = -31.00813\rvalue = c(1,1,1,1,1,0,0,1,0)\rvalue1 = matrix(value,3,3,byrow=T)\r(value2 = rbind(c(1,0,1),value1)) ##For constant term\r## [,1] [,2] [,3]\r## [1,] 1 0 1\r## [2,] 1 1 1\r## [3,] 1 1 0\r## [4,] 0 1 0\rm22 = VAR(zt,1,fixed=value2) ##fixed: removing insignificant estimates.\r## Constant term: ## Estimates: 0.001769493 0 0.004079231 ## Std.Error: 0.0006639398 0 0.0007440541 ## AR coefficient matrix ## AR( 1 )-matrix ## [,1] [,2] [,3]\r## [1,] 0.446 0.209 0.000\r## [2,] 0.219 0.276 0.421\r## [3,] 0.498 0.000 0.000\r## standard error ## [,1] [,2] [,3]\r## [1,] 0.0757 0.0685 0.0000\r## [2,] 0.0839 0.0862 0.0912\r## [3,] 0.0844 0.0000 0.0000\r## ## Residuals cov-mtx: ## [,1] [,2] [,3]\r## [1,] 2.897757e-05 1.930763e-06 6.817902e-06\r## [2,] 1.930763e-06 3.320102e-05 1.606269e-05\r## [3,] 6.817902e-06 1.606269e-05 4.356240e-05\r## ## det(SSE) = 3.315141e-14 ## AIC = -30.94169 ## BIC = -30.80593 ## HQ = -30.88654\r\r4. Residual checking \rmq(m2$residuals,10) ##The results show that the residuals are not serially correlated\r## Ljung-Box Statistics: ## m Q(m) df p-value\r## [1,] 1.00 9.66 9.00 0.38\r## [2,] 2.00 17.53 18.00 0.49\r## [3,] 3.00 26.88 27.00 0.47\r## [4,] 4.00 45.07 36.00 0.14\r## [5,] 5.00 52.91 45.00 0.20\r## [6,] 6.00 58.52 54.00 0.31\r## [7,] 7.00 66.50 63.00 0.36\r## [8,] 8.00 81.90 72.00 0.20\r## [9,] 9.00 92.83 81.00 0.17\r## [10,] 10.00 103.90 90.00 0.15\rmq(m2$residuals,24,adj=9) ##The results show that the residuals are not serially correlated (1% significance level)\r## Ljung-Box Statistics: ## m Q(m) df p-value\r## [1,] 1.00 9.66 0.00 1.00\r## [2,] 2.00 17.53 9.00 0.04\r## [3,] 3.00 26.88 18.00 0.08\r## [4,] 4.00 45.07 27.00 0.02\r## [5,] 5.00 52.91 36.00 0.03\r## [6,] 6.00 58.52 45.00 0.09\r## [7,] 7.00 66.50 54.00 0.12\r## [8,] 8.00 81.90 63.00 0.06\r## [9,] 9.00 92.83 72.00 0.05\r## [10,] 10.00 103.90 81.00 0.04\r## [11,] 11.00 107.82 90.00 0.10\r## [12,] 12.00 119.23 99.00 0.08\r## [13,] 13.00 132.59 108.00 0.05\r## [14,] 14.00 142.52 117.00 0.05\r## [15,] 15.00 153.51 126.00 0.05\r## [16,] 16.00 158.83 135.00 0.08\r## [17,] 17.00 165.14 144.00 0.11\r## [18,] 18.00 171.03 153.00 0.15\r## [19,] 19.00 184.52 162.00 0.11\r## [20,] 20.00 193.41 171.00 0.12\r## [21,] 21.00 198.35 180.00 0.17\r## [22,] 22.00 206.70 189.00 0.18\r## [23,] 23.00 211.62 198.00 0.24\r## [24,] 24.00 223.23 207.00 0.21\rMTSdiag(m2, gof = 24, adj = 9, level = F)\r## [1] \u0026quot;Covariance matrix:\u0026quot;\r## uk ca us\r## uk 2.92e-05 1.98e-06 6.67e-06\r## ca 1.98e-06 3.27e-05 1.70e-05\r## us 6.67e-06 1.70e-05 3.93e-05\r## CCM at lag: 0 ## [,1] [,2] [,3]\r## [1,] 1.0000 0.0641 0.197\r## [2,] 0.0641 1.0000 0.474\r## [3,] 0.1972 0.4742 1.000\r## Simplified matrix: ## CCM at lag: 1 ## . . . ## . . . ## . . . ## CCM at lag: 2 ## . . . ## . . . ## . . . ## CCM at lag: 3 ## . . . ## . . . ## . . . ## CCM at lag: 4 ## . . - ## . . . ## . - . ## CCM at lag: 5 ## . . . ## . . . ## . . . ## CCM at lag: 6 ## . . . ## . . . ## . - . ## CCM at lag: 7 ## . . . ## . . . ## . . . ## CCM at lag: 8 ## . . . ## . . . ## . . . ## CCM at lag: 9 ## . . . ## . . . ## . . . ## CCM at lag: 10 ## . . . ## . + . ## . . . ## CCM at lag: 11 ## . . . ## . . . ## . . . ## CCM at lag: 12 ## . . . ## . . . ## . . . ## CCM at lag: 13 ## . - . ## . . . ## . . . ## CCM at lag: 14 ## . . . ## . . . ## . . . ## CCM at lag: 15 ## . . . ## . . . ## . . . ## CCM at lag: 16 ## . . . ## . . . ## . . . ## CCM at lag: 17 ## . . . ## . . . ## . . . ## CCM at lag: 18 ## . . . ## . . . ## . . . ## CCM at lag: 19 ## . . . ## . . + ## . . . ## CCM at lag: 20 ## . . . ## . . . ## . . . ## CCM at lag: 21 ## . . . ## . . . ## . . . ## CCM at lag: 22 ## . . . ## . . . ## . . . ## CCM at lag: 23 ## . . . ## . . . ## . . . ## CCM at lag: 24 ## . . . ## . . . ## . . .\r## Hit Enter for p-value plot of individual ccm:\r## Hit Enter to compute MQ-statistics: ## ## Ljung-Box Statistics: ## m Q(m) df p-value\r## [1,] 1.00 9.66 0.00 1.00\r## [2,] 2.00 17.53 9.00 0.04\r## [3,] 3.00 26.88 18.00 0.08\r## [4,] 4.00 45.07 27.00 0.02\r## [5,] 5.00 52.91 36.00 0.03\r## [6,] 6.00 58.52 45.00 0.09\r## [7,] 7.00 66.50 54.00 0.12\r## [8,] 8.00 81.90 63.00 0.06\r## [9,] 9.00 92.83 72.00 0.05\r## [10,] 10.00 103.90 81.00 0.04\r## [11,] 11.00 107.82 90.00 0.10\r## [12,] 12.00 119.23 99.00 0.08\r## [13,] 13.00 132.59 108.00 0.05\r## [14,] 14.00 142.52 117.00 0.05\r## [15,] 15.00 153.51 126.00 0.05\r## [16,] 16.00 158.83 135.00 0.08\r## [17,] 17.00 165.14 144.00 0.11\r## [18,] 18.00 171.03 153.00 0.15\r## [19,] 19.00 184.52 162.00 0.11\r## [20,] 20.00 193.41 171.00 0.12\r## [21,] 21.00 198.35 180.00 0.17\r## [22,] 22.00 206.70 189.00 0.18\r## [23,] 23.00 211.62 198.00 0.24\r## [24,] 24.00 223.23 207.00 0.21\r## Hit Enter to obtain residual plots:\r\r5. Prediction \rVARpred(m2, h=6) ## R command to compute prediction\r## orig 125 ## Forecasts at origin: 125 ## uk ca us\r## [1,] 0.002301 0.002467 0.003630\r## [2,] 0.003314 0.003634 0.004582\r## [3,] 0.004010 0.004480 0.005280\r## [4,] 0.004498 0.005089 0.005774\r## [5,] 0.004843 0.005522 0.006125\r## [6,] 0.005088 0.005829 0.006373\r## Standard Errors of predictions: ## [,1] [,2] [,3]\r## [1,] 0.005379 0.005698 0.006240\r## [2,] 0.006031 0.006764 0.006787\r## [3,] 0.006309 0.007159 0.007043\r## [4,] 0.006444 0.007346 0.007168\r## [5,] 0.006511 0.007439 0.007230\r## [6,] 0.006545 0.007485 0.007261\r## Root mean square errors of predictions: ## [,1] [,2] [,3]\r## [1,] 0.005464 0.005789 0.006339\r## [2,] 0.040704 0.054184 0.039966\r## [3,] 0.028021 0.035325 0.028630\r## [4,] 0.020427 0.025433 0.020945\r## [5,] 0.015215 0.018788 0.015718\r## [6,] 0.011744 0.014341 0.012275\r\r6. Co-integration \r\rGet data\r\rrequire(quantmod)\r## Loading required package: quantmod\r## Loading required package: xts\r## Loading required package: zoo\r## ## Attaching package: 'zoo'\r## The following objects are masked from 'package:base':\r## ## as.Date, as.Date.numeric\r## Loading required package: TTR\r## ## Attaching package: 'TTR'\r## The following object is masked from 'package:MTS':\r## ## VMA\r## Version 0.4-0 included new data defaults. See ?getSymbols.\rgetSymbols(\u0026quot;BHP\u0026quot;)\r## 'getSymbols' currently uses auto.assign=TRUE by default, but will\r## use auto.assign=FALSE in 0.5-0. You will still be able to use\r## 'loadSymbols' to automatically load data. getOption(\u0026quot;getSymbols.env\u0026quot;)\r## and getOption(\u0026quot;getSymbols.auto.assign\u0026quot;) will still be checked for\r## alternate defaults.\r## ## This message is shown once per session and may be disabled by setting ## options(\u0026quot;getSymbols.warning4.0\u0026quot;=FALSE). See ?getSymbols for details.\r## [1] \u0026quot;BHP\u0026quot;\rgetSymbols(\u0026quot;VALE\u0026quot;)\r## [1] \u0026quot;VALE\u0026quot;\rbhp = log(BHP$BHP.Adjusted)\rvale = log(VALE$VALE.Adjusted)\r(m1 = lm(bhp~vale))\r## ## Call:\r## lm(formula = bhp ~ vale)\r## ## Coefficients:\r## (Intercept) vale ## 2.6567 0.4261\rwt = bhp-0.4261*vale\rautoplot(wt,colour = \u0026quot;red\u0026quot;)\r\rCo-integration tests: Johansen’s co-integration test\r\rrequire(urca)\r## Loading required package: urca\rhead(BHP)\r## BHP.Open BHP.High BHP.Low BHP.Close BHP.Volume BHP.Adjusted\r## 2007-01-03 39.67 39.69 38.62 38.87 6285400 24.54328\r## 2007-01-04 37.90 38.19 37.48 37.74 5121000 23.82978\r## 2007-01-05 37.64 37.69 36.88 37.16 4412500 23.46355\r## 2007-01-08 37.55 37.66 36.93 37.33 4674400 23.57089\r## 2007-01-09 37.77 37.77 36.37 37.65 8331600 23.77294\r## 2007-01-10 37.30 38.05 37.02 37.84 4646300 23.89291\rhead(VALE)\r## VALE.Open VALE.High VALE.Low VALE.Close VALE.Volume\r## 2007-01-03 15.070 15.610 14.305 14.410 19475000\r## 2007-01-04 14.320 14.320 14.015 14.235 20641000\r## 2007-01-05 14.235 14.240 13.555 13.755 20187600\r## 2007-01-08 13.845 14.285 13.795 14.235 21989000\r## 2007-01-09 14.205 14.205 13.530 13.820 21337600\r## 2007-01-10 13.625 14.355 13.565 14.190 18589000\r## VALE.Adjusted\r## 2007-01-03 10.263877\r## 2007-01-04 10.139231\r## 2007-01-05 9.797338\r## 2007-01-08 10.139231\r## 2007-01-09 9.843638\r## 2007-01-10 10.107178\rtail(BHP)\r## BHP.Open BHP.High BHP.Low BHP.Close BHP.Volume BHP.Adjusted\r## 2019-04-11 56.39 56.63 56.12 56.35 851200 56.35\r## 2019-04-12 57.03 57.17 56.73 56.83 1440000 56.83\r## 2019-04-15 56.19 56.40 55.96 56.02 1222700 56.02\r## 2019-04-16 56.07 56.18 55.07 55.37 2713700 55.37\r## 2019-04-17 54.95 55.19 54.48 55.12 1964600 55.12\r## 2019-04-18 54.83 55.00 54.67 54.95 1137400 54.95\rdim(BHP)\r## [1] 3095 6\rpar(mfcol=c(2,1))\rm1 = lm(bhp~vale)\rsummary(m1)\r## ## Call:\r## lm(formula = bhp ~ vale)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.67076 -0.10064 -0.00332 0.13101 0.31926 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 2.656659 0.014569 182.35 \u0026lt;2e-16 ***\r## vale 0.426078 0.005637 75.59 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.1727 on 3093 degrees of freedom\r## Multiple R-squared: 0.6488, Adjusted R-squared: 0.6487 ## F-statistic: 5713 on 1 and 3093 DF, p-value: \u0026lt; 2.2e-16\rx = cbind(bhp,vale) ##Take a sequence of vector and combine by columns\rm1 = ar(x)\rm1$order\r## [1] 6\rm2 = ca.jo(x, K=6)#maximum eigenvalue test\rsummary(m2)\r## ## ###################### ## # Johansen-Procedure # ## ###################### ## ## Test type: maximal eigenvalue statistic (lambda max) , with linear trend ## ## Eigenvalues (lambda):\r## [1] 0.0041244184 0.0008515475\r## ## Values of teststatistic and critical values of test:\r## ## test 10pct 5pct 1pct\r## r \u0026lt;= 1 | 2.63 6.50 8.18 11.65\r## r = 0 | 12.77 12.91 14.90 19.19\r## ## Eigenvectors, normalised to first column:\r## (These are the cointegration relations)\r## ## BHP.Adjusted.l6 VALE.Adjusted.l6\r## BHP.Adjusted.l6 1.0000000 1.000000\r## VALE.Adjusted.l6 -0.3622562 -1.965875\r## ## Weights W:\r## (This is the loading matrix)\r## ## BHP.Adjusted.l6 VALE.Adjusted.l6\r## BHP.Adjusted.d -0.009210101 -7.222733e-05\r## VALE.Adjusted.d -0.010014343 6.121659e-04\rm3 = ca.jo(x, K=6, type=c(\u0026quot;trace\u0026quot;)) #trace co-integration test\rsummary(m3)\r## ## ###################### ## # Johansen-Procedure # ## ###################### ## ## Test type: trace statistic , with linear trend ## ## Eigenvalues (lambda):\r## [1] 0.0041244184 0.0008515475\r## ## Values of teststatistic and critical values of test:\r## ## test 10pct 5pct 1pct\r## r \u0026lt;= 1 | 2.63 6.50 8.18 11.65\r## r = 0 | 15.40 15.66 17.95 23.52\r## ## Eigenvectors, normalised to first column:\r## (These are the cointegration relations)\r## ## BHP.Adjusted.l6 VALE.Adjusted.l6\r## BHP.Adjusted.l6 1.0000000 1.000000\r## VALE.Adjusted.l6 -0.3622562 -1.965875\r## ## Weights W:\r## (This is the loading matrix)\r## ## BHP.Adjusted.l6 VALE.Adjusted.l6\r## BHP.Adjusted.d -0.009210101 -7.222733e-05\r## VALE.Adjusted.d -0.010014343 6.121659e-04\r\r\r\r\r// add bootstrap table styles to pandoc tables\rfunction bootstrapStylePandocTables() {\r$('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r}\r$(document).ready(function () {\rbootstrapStylePandocTables();\r});\r\r\r(function () {\rvar script = document.createElement(\"script\");\rscript.type = \"text/javascript\";\rscript.src = \"https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\rdocument.getElementsByTagName(\"head\")[0].appendChild(script);\r})();\r\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"d36cd80728c09eef230d89f9e8acb97a","permalink":"https://GangSirius.github.io/teaching/tmseries/lecture11/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/tmseries/lecture11/","section":"teaching","summary":"Lecture11: MTS\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.","tags":null,"title":"","type":"teaching"},{"authors":null,"categories":null,"content":"\rLecture2: Hypothesis Testing\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.table th:not([align]) {\rtext-align: left;\r}\r\r\r\r.main-container {\rmax-width: 940px;\rmargin-left: auto;\rmargin-right: auto;\r}\rcode {\rcolor: inherit;\rbackground-color: rgba(0, 0, 0, 0.04);\r}\rimg {\rmax-width:100%;\rheight: auto;\r}\r.tabbed-pane {\rpadding-top: 12px;\r}\r.html-widget {\rmargin-bottom: 20px;\r}\rbutton.code-folding-btn:focus {\routline: none;\r}\rsummary {\rdisplay: list-item;\r}\r\r.tabset-dropdown  .nav-tabs {\rdisplay: inline-table;\rmax-height: 500px;\rmin-height: 44px;\roverflow-y: auto;\rbackground: white;\rborder: 1px solid #ddd;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs  li.active:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li.active:before {\rcontent: \"\";\rborder: none;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs  li.active {\rdisplay: block;\r}\r.tabset-dropdown  .nav-tabs  li  a,\r.tabset-dropdown  .nav-tabs  li  a:focus,\r.tabset-dropdown  .nav-tabs  li  a:hover {\rborder: none;\rdisplay: inline-block;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li {\rdisplay: block;\rfloat: none;\r}\r.tabset-dropdown  .nav-tabs  li {\rdisplay: none;\r}\r\r\r$(document).ready(function () {\rwindow.buildTabsets(\"TOC\");\r});\r$(document).ready(function () {\r$('.tabset-dropdown  .nav-tabs  li').click(function () {\r$(this).parent().toggleClass('nav-tabs-open')\r});\r});\r\rLecture2: Hypothesis Testing\rZhou Chao\r\rImportant: You only need to type the quoted commands in R console\nContent\rBasic statistics review \rQQ-Plot\n\rKS-Test\n\r\r1. Basic statistics review \r\nWe download required dataset from IVLE and install the required libraries.\nrequire(fBasics)\r## Loading required package: fBasics\r## Loading required package: timeDate\r## Loading required package: timeSeries\rrequire(data.table)\r## Loading required package: data.table\rda \u0026lt;- data.table::fread(\u0026quot;ibm.csv\u0026quot;,header=T) # need to set work space to the file location\rdim(da)\r## [1] 3079 8\rhead(da)\r## date IBM.Open IBM.High IBM.Low IBM.Close IBM.Volume IBM.Adjusted\r## 1: 2007-01-04 97.25 98.79 96.88 98.31 10524500 70.86525\r## 2: 2007-01-05 97.60 97.95 96.91 97.42 7221300 70.22369\r## 3: 2007-01-08 98.50 99.50 98.35 98.90 10340000 71.29050\r## 4: 2007-01-09 99.08 100.33 99.07 100.07 11108200 72.13392\r## 5: 2007-01-10 98.50 99.05 97.93 98.89 8744800 71.28333\r## 6: 2007-01-11 99.00 99.90 98.50 98.65 8000700 71.11033\r## Return\r## 1: 0.010635145\r## 2: -0.009094223\r## 3: 0.015077751\r## 4: 0.011760682\r## 5: -0.011861830\r## 6: -0.002429858\rtail(da)\r## date IBM.Open IBM.High IBM.Low IBM.Close IBM.Volume IBM.Adjusted\r## 1: 2019-03-21 139.10 142.12 138.88 141.44 3605400 141.44\r## 2: 2019-03-22 140.97 141.44 138.90 139.45 3877200 139.45\r## 3: 2019-03-25 139.06 139.91 138.35 139.18 2839800 139.18\r## 4: 2019-03-26 139.93 141.02 139.42 140.22 2553700 140.22\r## 5: 2019-03-27 140.41 140.49 138.40 139.24 3098200 139.24\r## 6: 2019-03-28 139.91 140.44 139.10 139.92 2541800 139.92\r## Return\r## 1: 0.013094380\r## 2: -0.014169520\r## 3: -0.001938083\r## 4: 0.007444616\r## 5: -0.007013526\r## 6: 0.004871718\rkableExtra::kable(basicStats(da$Return))\r\r\r\r\rX..da.Return\r\r\r\r\r\rnobs\r\r3079.000000\r\r\r\rNAs\r\r0.000000\r\r\r\rMinimum\r\r-0.086419\r\r\r\rMaximum\r\r0.108989\r\r\r\rQuartile\r\r-0.006422\r\r\r\rQuartile\r\r0.007192\r\r\r\rMean\r\r0.000118\r\r\r\rMedian\r\r0.000298\r\r\r\rSum\r\r0.363580\r\r\r\rSE Mean\r\r0.000253\r\r\r\rLCL Mean\r\r-0.000378\r\r\r\rUCL Mean\r\r0.000614\r\r\r\rVariance\r\r0.000197\r\r\r\rStdev\r\r0.014041\r\r\r\rSkewness\r\r-0.180826\r\r\r\rKurtosis\r\r5.989009\r\r\r\r\r\r\r\rNull hypothesis:true mean is equal to 0\r\rt.test(da$Return) \r## ## One Sample t-test\r## ## data: da$Return\r## t = 0.46664, df = 3078, p-value = 0.6408\r## alternative hypothesis: true mean is not equal to 0\r## 95 percent confidence interval:\r## -0.0003780805 0.0006142482\r## sample estimates:\r## mean of x ## 0.0001180839\r\rChange alternative hypothesis\r\rt.test(da$Return, alternative=c(\u0026quot;greater\u0026quot;))\r## ## One Sample t-test\r## ## data: da$Return\r## t = 0.46664, df = 3078, p-value = 0.3204\r## alternative hypothesis: true mean is greater than 0\r## 95 percent confidence interval:\r## -0.000298272 Inf\r## sample estimates:\r## mean of x ## 0.0001180839\rd1 \u0026lt;- density(da$Return)\rplot(d1$x,d1$y, type='l')\r* Jarque-Bera Normalality Test\nnormalTest(da$Return,method=\u0026quot;jb\u0026quot;) \r## ## Title:\r## Jarque - Bera Normalality Test\r## ## Test Results:\r## STATISTIC:\r## X-squared: 4627.3716\r## P VALUE:\r## Asymptotic p Value: \u0026lt; 2.2e-16 ## ## Description:\r## Fri Mar 29 18:22:24 2019 by user: Sirius\r\r2. QQ-Plot \rdata(EuStockMarkets) logR \u0026lt;- diff(log(EuStockMarkets))\rindex.names \u0026lt;- dimnames(logR)[[2]]\rpar(mfrow=c(2,2))\rfor(i in 1:4) {\rqqnorm(logR[,i],datax=T,main=index.names[i])\rqqline(logR[,i],datax=T)\r}\r\r3. KS-Test \rrequire(graphics)\rx \u0026lt;- rnorm(50)\ry \u0026lt;- runif(30)\r\rDo x and y come from the same distribution?\r\rks.test(x, y)\r## ## Two-sample Kolmogorov-Smirnov test\r## ## data: x and y\r## D = 0.46, p-value = 0.0004387\r## alternative hypothesis: two-sided\r\rDoes x come from a shifted gamma distribution with shape 3 and rate 2?\r\rks.test(x+2, \u0026quot;pgamma\u0026quot;, 3, 2) # two-sided, exact\r## ## One-sample Kolmogorov-Smirnov test\r## ## data: x + 2\r## D = 0.35571, p-value = 3.626e-06\r## alternative hypothesis: two-sided\rks.test(x+2, \u0026quot;pgamma\u0026quot;, 3, 2, alternative = \u0026quot;gr\u0026quot;)\r## ## One-sample Kolmogorov-Smirnov test\r## ## data: x + 2\r## D^+ = 0.039677, p-value = 0.8324\r## alternative hypothesis: the CDF of x lies above the null hypothesis\r\rTest if x is stochastically larger than x2\r\rx2 \u0026lt;- rnorm(50, -1)\rplot(ecdf(x), xlim = range(c(x, x2)))\rplot(ecdf(x2), add = TRUE, lty = \u0026quot;dashed\u0026quot;)\rt.test(x, x2, alternative = \u0026quot;g\u0026quot;)\r## ## Welch Two Sample t-test\r## ## data: x and x2\r## t = 6.4362, df = 92.895, p-value = 2.648e-09\r## alternative hypothesis: true difference in means is greater than 0\r## 95 percent confidence interval:\r## 0.8539445 Inf\r## sample estimates:\r## mean of x mean of y ## 0.0505031 -1.1005768\rks.test(x, x2, alternative = \u0026quot;l\u0026quot;)\r## ## Two-sample Kolmogorov-Smirnov test\r## ## data: x and x2\r## D^- = 0.5, p-value = 3.727e-06\r## alternative hypothesis: the CDF of x lies below that of y\r\r\r\r\r// add bootstrap table styles to pandoc tables\rfunction bootstrapStylePandocTables() {\r$('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r}\r$(document).ready(function () {\rbootstrapStylePandocTables();\r});\r\r\r(function () {\rvar script = document.createElement(\"script\");\rscript.type = \"text/javascript\";\rscript.src = \"https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\rdocument.getElementsByTagName(\"head\")[0].appendChild(script);\r})();\r\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"4e57fd0cf6883e44478050a0c0dedc73","permalink":"https://GangSirius.github.io/teaching/tmseries/lecture2/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/tmseries/lecture2/","section":"teaching","summary":"Lecture2: Hypothesis Testing\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.","tags":null,"title":"","type":"teaching"},{"authors":null,"categories":null,"content":"\rLecture3: Linear Regression Model\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.table th:not([align]) {\rtext-align: left;\r}\r\r\r\r.main-container {\rmax-width: 940px;\rmargin-left: auto;\rmargin-right: auto;\r}\rcode {\rcolor: inherit;\rbackground-color: rgba(0, 0, 0, 0.04);\r}\rimg {\rmax-width:100%;\rheight: auto;\r}\r.tabbed-pane {\rpadding-top: 12px;\r}\r.html-widget {\rmargin-bottom: 20px;\r}\rbutton.code-folding-btn:focus {\routline: none;\r}\rsummary {\rdisplay: list-item;\r}\r\r.tabset-dropdown  .nav-tabs {\rdisplay: inline-table;\rmax-height: 500px;\rmin-height: 44px;\roverflow-y: auto;\rbackground: white;\rborder: 1px solid #ddd;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs  li.active:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li.active:before {\rcontent: \"\";\rborder: none;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs  li.active {\rdisplay: block;\r}\r.tabset-dropdown  .nav-tabs  li  a,\r.tabset-dropdown  .nav-tabs  li  a:focus,\r.tabset-dropdown  .nav-tabs  li  a:hover {\rborder: none;\rdisplay: inline-block;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li {\rdisplay: block;\rfloat: none;\r}\r.tabset-dropdown  .nav-tabs  li {\rdisplay: none;\r}\r\r\r$(document).ready(function () {\rwindow.buildTabsets(\"TOC\");\r});\r$(document).ready(function () {\r$('.tabset-dropdown  .nav-tabs  li').click(function () {\r$(this).parent().toggleClass('nav-tabs-open')\r});\r});\r\rLecture3: Linear Regression Model\rZhou Chao\r\rImportant: You only need to type the quoted commands in R console\nContent\rLinear and nonlinear Market Model \rFit all possible models.\n\rRegression model for US weekly interest rates\n\r\r1. Linear and nonlinear Market Model \r\nWe download required dataset from IVLE and install the required libraries.\nrequire(data.table) \r## Loading required package: data.table\rrequire(ggplot2)\r## Loading required package: ggplot2\rrequire(MASS)\r## Loading required package: MASS\r\rLoad GM and SP daily log returns and plot\r\rda \u0026lt;- fread(\u0026quot;d-gmsp2010.csv\u0026quot;,header=T) qplot(da$GM, da$SP)\r\rFit the Market Model\r\rm1 \u0026lt;- lm(GM~SP, da) summary(m1)\r## ## Call:\r## lm(formula = GM ~ SP, data = da)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.097311 -0.009406 0.000137 0.009085 0.121047 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 4.891e-05 3.724e-04 0.131 0.896 ## SP 3.211e-01 2.085e-02 15.400 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.01706 on 2098 degrees of freedom\r## Multiple R-squared: 0.1016, Adjusted R-squared: 0.1011 ## F-statistic: 237.2 on 1 and 2098 DF, p-value: \u0026lt; 2.2e-16\rAIC(m1)\r## [1] -11133.63\r\rConfidence intervals for estimated regression parameters\r\rconfint(m1)\r## 2.5 % 97.5 %\r## (Intercept) -0.0006814663 0.0007792855\r## SP 0.2802470871 0.3620391875\r\rRemove the nonsignificant Intercept (constant) term\r\rm11 \u0026lt;- lm(GM ~ -1 + SP, da) summary(m11)\r## ## Call:\r## lm(formula = GM ~ -1 + SP, data = da)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.097259 -0.009358 0.000186 0.009133 0.121096 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## SP 0.32119 0.02085 15.41 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.01706 on 2099 degrees of freedom\r## Multiple R-squared: 0.1016, Adjusted R-squared: 0.1012 ## F-statistic: 237.4 on 1 and 2099 DF, p-value: \u0026lt; 2.2e-16\rAIC(m11)\r## [1] -11135.61\r\rLocate the time points of non-positive market returns.\r\ridx \u0026lt;- c(1:length(da$SP))[da$SP \u0026lt;= 0] nsp \u0026lt;- rep(0,length(da$SP)) #create a vector of length 502 with all 0 nsp[idx] = da$SP[idx]\rc1 \u0026lt;- rep(0,length(da$SP))\rc1[idx] = 1\rxx \u0026lt;- data.frame(gm = da$GM, sp = da$SP, c1, nsp) # Show the resulting variables\rhead(xx)\r## gm sp c1 nsp\r## 1 -0.024656038 -0.008401001 1 -0.008401001\r## 2 0.006893351 0.009515884 0 0.000000000\r## 3 0.009512750 -0.007268749 1 -0.007268749\r## 4 0.000000000 -0.001684864 1 -0.001684864\r## 5 0.011764602 -0.001687820 1 -0.001687820\r## 6 0.016816927 0.048361018 0 0.000000000\r\r2. Fit all possible models \r\rWith different intercepts (alpha) for positive and negative SP log returns\r\rm2 \u0026lt;- lm(gm ~ c1+sp, xx) summary(m2)\r## ## Call:\r## lm(formula = gm ~ c1 + sp, data = xx)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.097518 -0.009445 0.000111 0.009068 0.121202 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.0002085 0.0006637 0.314 0.753 ## c1 -0.0003147 0.0010830 -0.291 0.771 ## sp 0.3147464 0.0303246 10.379 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.01707 on 2097 degrees of freedom\r## Multiple R-squared: 0.1016, Adjusted R-squared: 0.1007 ## F-statistic: 118.6 on 2 and 2097 DF, p-value: \u0026lt; 2.2e-16\r\rWith different coefficients (beta) for positive and negative SP log returns\r\rm3 \u0026lt;- lm(gm ~ nsp+sp, xx)\rsummary(m3)\r## ## Call:\r## lm(formula = gm ~ nsp + sp, data = xx)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.096173 -0.009499 0.000076 0.009166 0.120713 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.0003833 0.0005413 0.708 0.479 ## nsp 0.0516089 0.0606215 0.851 0.395 ## sp 0.2955340 0.0366035 8.074 1.14e-15 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.01707 on 2097 degrees of freedom\r## Multiple R-squared: 0.1019, Adjusted R-squared: 0.101 ## F-statistic: 118.9 on 2 and 2097 DF, p-value: \u0026lt; 2.2e-16\r\rWith different intercepts (alpha) and coeff (beta) for positive and negative SP log returns\r\rm4 \u0026lt;- lm(gm ~ sp+c1+nsp, xx) summary(m4)\r## ## Call:\r## lm(formula = gm ~ sp + c1 + nsp, data = xx)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.096386 -0.009500 0.000071 0.009182 0.120877 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.0005593 0.0007792 0.718 0.473 ## sp 0.2883550 0.0431574 6.681 3.02e-11 ***\r## c1 -0.0003404 0.0010835 -0.314 0.753 ## nsp 0.0521342 0.0606576 0.859 0.390 ## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.01707 on 2096 degrees of freedom\r## Multiple R-squared: 0.1019, Adjusted R-squared: 0.1006 ## F-statistic: 79.28 on 3 and 2096 DF, p-value: \u0026lt; 2.2e-16\ranova(m4)\r## Analysis of Variance Table\r## ## Response: gm\r## Df Sum Sq Mean Sq F value Pr(\u0026gt;F) ## sp 1 0.06906 0.069059 237.0218 \u0026lt;2e-16 ***\r## c1 1 0.00002 0.000025 0.0844 0.7714 ## nsp 1 0.00022 0.000215 0.7387 0.3902 ## Residuals 2096 0.61069 0.000291 ## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\ranova(m3,m4) #F-test: H0: in the three-variable model, the slope c1 is zero\r## Analysis of Variance Table\r## ## Model 1: gm ~ nsp + sp\r## Model 2: gm ~ sp + c1 + nsp\r## Res.Df RSS Df Sum of Sq F Pr(\u0026gt;F)\r## 1 2097 0.61072 ## 2 2096 0.61069 1 2.8758e-05 0.0987 0.7534\ranova(m2,m4) #F-test: H0: in the three-variable model, the slope nsp is zero\r## Analysis of Variance Table\r## ## Model 1: gm ~ c1 + sp\r## Model 2: gm ~ sp + c1 + nsp\r## Res.Df RSS Df Sum of Sq F Pr(\u0026gt;F)\r## 1 2097 0.61091 ## 2 2096 0.61069 1 0.00021523 0.7387 0.3902\rm5 \u0026lt;- stepAIC(m4) #remove nonsignificant variables one at a time while minimising AIC\r## Start: AIC=-17092\r## gm ~ sp + c1 + nsp\r## ## Df Sum of Sq RSS AIC\r## - c1 1 0.0000288 0.61072 -17094\r## - nsp 1 0.0002152 0.61091 -17093\r## \u0026lt;none\u0026gt; 0.61069 -17092\r## - sp 1 0.0130069 0.62370 -17050\r## ## Step: AIC=-17093.9\r## gm ~ sp + nsp\r## ## Df Sum of Sq RSS AIC\r## - nsp 1 0.0002111 0.61093 -17095\r## \u0026lt;none\u0026gt; 0.61072 -17094\r## - sp 1 0.0189852 0.62971 -17032\r## ## Step: AIC=-17095.17\r## gm ~ sp\r## ## Df Sum of Sq RSS AIC\r## \u0026lt;none\u0026gt; 0.61093 -17095\r## - sp 1 0.069059 0.67999 -16872\rsummary(m5)\r## ## Call:\r## lm(formula = gm ~ sp, data = xx)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.097311 -0.009406 0.000137 0.009085 0.121047 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 4.891e-05 3.724e-04 0.131 0.896 ## sp 3.211e-01 2.085e-02 15.400 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.01706 on 2098 degrees of freedom\r## Multiple R-squared: 0.1016, Adjusted R-squared: 0.1011 ## F-statistic: 237.2 on 1 and 2098 DF, p-value: \u0026lt; 2.2e-16\r\r3. Regression model for US weekly interest rates \rrate \u0026lt;- fread(\u0026quot;w-gs1n36299.txt\u0026quot;,header=T)\rhead(rate)\r## y1 y3 date\r## 1: 3.24 3.70 19620104\r## 2: 3.32 3.75 19620112\r## 3: 3.29 3.80 19620120\r## 4: 3.26 3.77 19620126\r## 5: 3.29 3.80 19620202\r## 6: 3.29 3.76 19620208\rqplot(rate$y1,rate$y3)\r* Linear model (linear regression analysis)\nratelm \u0026lt;- lm(y3 ~ y1, rate) summary(ratelm)\r## ## Call:\r## lm(formula = y3 ~ y1, data = rate)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -1.8121 -0.4023 0.0031 0.4026 1.3388 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.910687 0.032250 28.24 \u0026lt;2e-16 ***\r## y1 0.923854 0.004389 210.51 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.538 on 1965 degrees of freedom\r## Multiple R-squared: 0.9575, Adjusted R-squared: 0.9575 ## F-statistic: 4.431e+04 on 1 and 1965 DF, p-value: \u0026lt; 2.2e-16\ranova(ratelm) #analysis of variance\r## Analysis of Variance Table\r## ## Response: y3\r## Df Sum Sq Mean Sq F value Pr(\u0026gt;F) ## y1 1 12828.1 12828.1 44314 \u0026lt; 2.2e-16 ***\r## Residuals 1965 568.8 0.3 ## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\raov(ratelm) #analysis of variance\r## Call:\r## aov(formula = ratelm)\r## ## Terms:\r## y1 Residuals\r## Sum of Squares 12828.102 568.835\r## Deg. of Freedom 1 1965\r## ## Residual standard error: 0.5380365\r## Estimated effects may be unbalanced\rqplot(rate$date,ratelm$residuals, geom = \u0026quot;point\u0026quot;)\racf(ratelm$residuals) #autocorrelaitons of residuals \rr3 \u0026lt;- diff(rate$y3)#log returns\rr1 \u0026lt;- diff(rate$y1)\rqplot(r1,r3)\rlm2 \u0026lt;- lm(r3 ~ r1)\rsummary(lm2)\r## ## Call:\r## lm(formula = r3 ~ r1)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.38060 -0.03338 -0.00054 0.03437 0.47418 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.0002475 0.0015380 0.161 0.872 ## r1 0.7810590 0.0074651 104.628 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.06819 on 1964 degrees of freedom\r## Multiple R-squared: 0.8479, Adjusted R-squared: 0.8478 ## F-statistic: 1.095e+04 on 1 and 1964 DF, p-value: \u0026lt; 2.2e-16\rlm2 \u0026lt;- lm(r3 ~ -1 + r1) # remove the insignificant constant term\rsummary(lm2)\r## ## Call:\r## lm(formula = r3 ~ -1 + r1)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.38036 -0.03314 -0.00030 0.03462 0.47444 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## r1 0.781065 0.007463 104.7 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.06818 on 1965 degrees of freedom\r## Multiple R-squared: 0.8479, Adjusted R-squared: 0.8478 ## F-statistic: 1.095e+04 on 1 and 1965 DF, p-value: \u0026lt; 2.2e-16\racf(lm2$residuals)\r\r\r\r\r// add bootstrap table styles to pandoc tables\rfunction bootstrapStylePandocTables() {\r$('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r}\r$(document).ready(function () {\rbootstrapStylePandocTables();\r});\r\r\r(function () {\rvar script = document.createElement(\"script\");\rscript.type = \"text/javascript\";\rscript.src = \"https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\rdocument.getElementsByTagName(\"head\")[0].appendChild(script);\r})();\r\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"2166a0fca5fb5496b58716a0b2bf8d37","permalink":"https://GangSirius.github.io/teaching/tmseries/lecture3/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/tmseries/lecture3/","section":"teaching","summary":"Lecture3: Linear Regression Model\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.","tags":null,"title":"","type":"teaching"},{"authors":null,"categories":null,"content":"\rLecture5: AR Model\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.table th:not([align]) {\rtext-align: left;\r}\r\r\r\r.main-container {\rmax-width: 940px;\rmargin-left: auto;\rmargin-right: auto;\r}\rcode {\rcolor: inherit;\rbackground-color: rgba(0, 0, 0, 0.04);\r}\rimg {\rmax-width:100%;\rheight: auto;\r}\r.tabbed-pane {\rpadding-top: 12px;\r}\r.html-widget {\rmargin-bottom: 20px;\r}\rbutton.code-folding-btn:focus {\routline: none;\r}\rsummary {\rdisplay: list-item;\r}\r\r.tabset-dropdown  .nav-tabs {\rdisplay: inline-table;\rmax-height: 500px;\rmin-height: 44px;\roverflow-y: auto;\rbackground: white;\rborder: 1px solid #ddd;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs  li.active:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li.active:before {\rcontent: \"\";\rborder: none;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs  li.active {\rdisplay: block;\r}\r.tabset-dropdown  .nav-tabs  li  a,\r.tabset-dropdown  .nav-tabs  li  a:focus,\r.tabset-dropdown  .nav-tabs  li  a:hover {\rborder: none;\rdisplay: inline-block;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li {\rdisplay: block;\rfloat: none;\r}\r.tabset-dropdown  .nav-tabs  li {\rdisplay: none;\r}\r\r\r$(document).ready(function () {\rwindow.buildTabsets(\"TOC\");\r});\r$(document).ready(function () {\r$('.tabset-dropdown  .nav-tabs  li').click(function () {\r$(this).parent().toggleClass('nav-tabs-open')\r});\r});\r\rLecture5: AR Model\rZhou Chao\r\rImportant: You only need to type the quoted commands in R console\nContent\rWarmup \rAR Models\n\r\r1. Warmup \r\rggfortify is useful for time series object ploting\r\rrequire(ggfortify) \r## Loading required package: ggfortify\r## Loading required package: ggplot2\ry1 \u0026lt;- arima.sim(model=list(ar=c(1.3,-.4)),1000) #Simulation of AR(2)\ry2 \u0026lt;- arima.sim(model=list(ar=c(.8,-.7)),1000)\ry \u0026lt;- ts(cumsum(c(0,rnorm(999)))) #Simulation of a random walk process\r\rAn example of AR(2)-1\r\rautoplot(y1, ts.colour = 'red', ts.linetype = 'dashed', main = 'Simulation of AR(2) ar=c(1.3,-.4)')\r\rAn example of AR(2)-2\r\rautoplot(y2, ts.colour = 'darkred', ts.linetype = 'dashed', main = 'Simulation of AR(2) ar=c(.3,-.7)')\r\rRandom Walk\r\rautoplot(y, ts.colour = 'darkblue', ts.linetype = 'dashed', main = \u0026quot;Random walk\u0026quot;)\r\rACF Plot\r\racf(y,main=\u0026quot;ACF of a random walk process\u0026quot;)\r\r2. AR Models \r\rLoad data and create a time-series object\r\rgnp \u0026lt;- scan(file=\u0026quot;q-dgnp82.txt\u0026quot;) gnp1 \u0026lt;- ts(gnp,frequency=4,start=c(1970,2))\rautoplot(gnp1, ts.colour = 'darkblue', ts.geom = 'ribbon', main = \u0026quot;GNP\u0026quot;)\r* Load data in a different way\nda \u0026lt;- read.table(\u0026quot;q-dgnp82.txt\u0026quot;) head(da)\r## V1\r## 1 0.00632\r## 2 0.00366\r## 3 0.01202\r## 4 0.00627\r## 5 0.01761\r## 6 0.00918\rx \u0026lt;- da[,1]\rhead(x)\r## [1] 0.00632 0.00366 0.01202 0.00627 0.01761 0.00918\r\rBasic statistics and data visualization\r\rrequire(fBasics)\r## Loading required package: fBasics\r## Warning: package 'fBasics' was built under R version 3.4.4\r## Loading required package: timeDate\r## Loading required package: timeSeries\r## Warning: package 'timeSeries' was built under R version 3.4.4\rbasicStats(x)\r## x\r## nobs 176.000000\r## NAs 0.000000\r## Minimum -0.023910\r## Maximum 0.039890\r## 1. Quartile 0.001050\r## 3. Quartile 0.014020\r## Mean 0.007741\r## Median 0.008570\r## Sum 1.362460\r## SE Mean 0.000809\r## LCL Mean 0.006145\r## UCL Mean 0.009337\r## Variance 0.000115\r## Stdev 0.010728\r## Skewness -0.152248\r## Kurtosis 0.412962\rautoplot(ts(x), ts.colour = 'blue', ts.geom = 'ribbon', main = \u0026quot;GNP\u0026quot;)\rqplot(x[1:175],x[2:176], xlab = \u0026quot;index\u0026quot;, ylab = \u0026quot;return\u0026quot;, geom = \u0026quot;point\u0026quot;)\rqplot(x[1:174],x[3:176], xlab = \u0026quot;index\u0026quot;, ylab = \u0026quot;return\u0026quot;, geom = \u0026quot;point\u0026quot;)\racf(x,lag=12)\r\rLjung-Box testing: mean = 0.\r\rpacf(x,lag.max=12,main=\u0026quot;PACF lag=12\u0026quot;)\rBox.test(x,lag=10,type='Ljung')\r## ## Box-Ljung test\r## ## data: x\r## X-squared = 43.234, df = 10, p-value = 4.515e-06\rt.test(x) \r## ## One Sample t-test\r## ## data: x\r## t = 9.5734, df = 175, p-value \u0026lt; 2.2e-16\r## alternative hypothesis: true mean is not equal to 0\r## 95 percent confidence interval:\r## 0.00614535 0.00933715\r## sample estimates:\r## mean of x ## 0.00774125\r\rAR(1) roughly based on PACF\r\rm0 \u0026lt;- arima(gnp,order=c(1,0,0))\r#Usual estimation of ARIMA models\rm0\r## ## Call:\r## arima(x = gnp, order = c(1, 0, 0))\r## ## Coefficients:\r## ar1 intercept\r## 0.3787 0.0077\r## s.e. 0.0698 0.0012\r## ## sigma^2 estimated as 9.801e-05: log likelihood = 562.47, aic = -1118.94\r\rModel checking: possible serial correlations exist in residual\r\rtsdiag(m0,gof=20) \r\rRefine the model. In general, we can start directly from here.\r\rm1=ar(x,method=\u0026quot;mle\u0026quot;) #Find the AR order\rm1\r## ## Call:\r## ar(x = x, method = \u0026quot;mle\u0026quot;)\r## ## Coefficients:\r## 1 2 3 ## 0.3480 0.1793 -0.1423 ## ## Order selected 3 sigma^2 estimated as 9.427e-05\rnames(m1)\r## [1] \u0026quot;order\u0026quot; \u0026quot;ar\u0026quot; \u0026quot;var.pred\u0026quot; \u0026quot;x.mean\u0026quot; ## [5] \u0026quot;aic\u0026quot; \u0026quot;n.used\u0026quot; \u0026quot;order.max\u0026quot; \u0026quot;partialacf\u0026quot; ## [9] \u0026quot;resid\u0026quot; \u0026quot;method\u0026quot; \u0026quot;series\u0026quot; \u0026quot;frequency\u0026quot; ## [13] \u0026quot;call\u0026quot; \u0026quot;asy.var.coef\u0026quot;\rm1$aic #AIC values for different order p\r## 0 1 2 3 4 5 ## 27.8466897 2.7416324 1.6032416 0.0000000 0.3027852 2.2426608 ## 6 7 8 9 10 11 ## 4.0520840 6.0254750 5.9046676 7.5718635 7.8953337 9.6788727 ## 12 ## 7.1975452\r#The minimum AIC is adjusted to zero\rm1$order #An AR(3) is selected based on AIC\r## [1] 3\r\rview residual series and conduct model checking\r\rautoplot(ts(m1$resid),ts.colour = \u0026quot;blue\u0026quot;, ts.geom = 'ribbon', main=\u0026quot;AR(3) fit for GNP\u0026quot;)\rBox.test(m1$resid,lag=10,type=\u0026quot;Ljung\u0026quot;) #Model checking\r## ## Box-Ljung test\r## ## data: m1$resid\r## X-squared = 7.0808, df = 10, p-value = 0.7178\r(pv \u0026lt;- 1-pchisq(7.0808,10)) #R uses 10 degrees of freedom\r## [1] 0.7177956\r(pv1=1-pchisq(7.0808,10-3)) #It should be m-g (10-3) =7\r## [1] 0.4205158\r\rFit a AR(3)\r\r(m2 \u0026lt;- arima(gnp,order=c(3,0,0)))# Usual estimation of ARIMA models\r## ## Call:\r## arima(x = gnp, order = c(3, 0, 0))\r## ## Coefficients:\r## ar1 ar2 ar3 intercept\r## 0.3480 0.1793 -0.1423 0.0077\r## s.e. 0.0745 0.0778 0.0745 0.0012\r## ## sigma^2 estimated as 9.427e-05: log likelihood = 565.84, aic = -1121.68\r# In R, 'intercept' denotes the mean of the series. mean(gnp)\r## [1] 0.00774125\r\rCompute the constant term phi(0): (1-.348-.1793+.1423)*0.0077\r\rphi = 1\rfor (i in 1:length(m2$coef)) {\rif (i == length(m2$coef)) {\r(phi = phi * m2$coef[i])\r} else {\rphi = phi-m2$coef[i]\r}\r}\r\rResidual standard error\r\rnames(m2)\r## [1] \u0026quot;coef\u0026quot; \u0026quot;sigma2\u0026quot; \u0026quot;var.coef\u0026quot; \u0026quot;mask\u0026quot; \u0026quot;loglik\u0026quot; ## [6] \u0026quot;aic\u0026quot; \u0026quot;arma\u0026quot; \u0026quot;residuals\u0026quot; \u0026quot;call\u0026quot; \u0026quot;series\u0026quot; ## [11] \u0026quot;code\u0026quot; \u0026quot;n.cond\u0026quot; \u0026quot;nobs\u0026quot; \u0026quot;model\u0026quot;\rsqrt(m2$sigma2) \r## [1] 0.009709322\r\rCharacteristic equation and solutions\r\r(p1 \u0026lt;- c(1,-m2$coef[1:3])) \r## ar1 ar2 ar3 ## 1.0000000 -0.3480209 -0.1793027 0.1422638\r(roots=polyroot(p1)) #Find solutions\r## [1] 1.590253+1.063882i -1.920152+0.000000i 1.590253-1.063882i\rMod(roots) #Compute the modulus of the solutions\r## [1] 1.913308 1.920152 1.913308\r\rTo compute average length of business cycles\r\r(k=2*pi/acos(1.590253/1.913308)) \r## [1] 10.65638\r\rModel Checking\r\rtsdiag(m2,gof=20) # Model checking\rBox.test(m2$resid,lag=10,type=\u0026quot;Ljung\u0026quot;) \r## ## Box-Ljung test\r## ## data: m2$resid\r## X-squared = 7.0169, df = 10, p-value = 0.7239\r(pv2=1-pchisq(7.0169,10)) #R uses 10 degrees of freedom\r## [1] 0.7238485\r(pv3=1-pchisq(7.0169,10-3)) #It should be m-g (10-3) =7\r## [1] 0.4271224\rrequire(forecast)\r## Loading required package: forecast\rpre \u0026lt;- forecast(m2,level = c(95), h = 9) # Prediction\rdev.off() # make sure no graphics error \r## null device ## 1\rautoplot(pre)\r\rRemove the insignificant coefficients\r\r(m3 \u0026lt;- arima(gnp,order=c(2,0,0))) # lag-3 coeff of m2 insignificant at 5% level\r## ## Call:\r## arima(x = gnp, order = c(2, 0, 0))\r## ## Coefficients:\r## ar1 ar2 intercept\r## 0.3288 0.1331 0.0076\r## s.e. 0.0746 0.0748 0.0014\r## ## sigma^2 estimated as 9.626e-05: log likelihood = 564.04, aic = -1120.08\rp2 = c(1,-m3$coef[1:2]) #Characteristic equation\r(roots=polyroot(p2)) #Find solutions\r## [1] 1.771472+0i -4.242453+0i\r# No complex solutions, no business cycles\rMod(roots) #Compute the modulus of the solutions\r## [1] 1.771472 4.242453\rtsdiag(m3,gof=20) # Model checking: AR(3) may be better\rBox.test(m3$resid,lag=10,type=\u0026quot;Ljung\u0026quot;) \r## ## Box-Ljung test\r## ## data: m3$resid\r## X-squared = 9.0263, df = 10, p-value = 0.5296\r(pv4 = 1-pchisq(9.0263,10)) #R uses 10 degrees of freedom\r## [1] 0.5296094\r(pv5 = 1-pchisq(9.0263,10-2)) #It should be m-g (10-2) =8\r## [1] 0.3400822\r\rIn general, to deal with insignificant coeffs, we use the the subcommand ‘fixed’\r\r(m4 \u0026lt;- arima(gnp,order=c(3,0,0),fixed=c(NA,NA,0,NA)))\r## Warning in arima(gnp, order = c(3, 0, 0), fixed = c(NA, NA, 0, NA)): some\r## AR parameters were fixed: setting transform.pars = FALSE\r## ## Call:\r## arima(x = gnp, order = c(3, 0, 0), fixed = c(NA, NA, 0, NA))\r## ## Coefficients:\r## ar1 ar2 ar3 intercept\r## 0.3288 0.1330 0 0.0076\r## s.e. 0.0746 0.0748 0 0.0014\r## ## sigma^2 estimated as 9.626e-05: log likelihood = 564.04, aic = -1120.08\r# The subcommand 'fixed' is used to fix parameter values, # where NA denotes estimation and 0 means fixing the parameter to 0.\r# The ordering of the parameters can be found using m2$coef.\r\r\r\r\r// add bootstrap table styles to pandoc tables\rfunction bootstrapStylePandocTables() {\r$('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r}\r$(document).ready(function () {\rbootstrapStylePandocTables();\r});\r\r\r(function () {\rvar script = document.createElement(\"script\");\rscript.type = \"text/javascript\";\rscript.src = \"https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\rdocument.getElementsByTagName(\"head\")[0].appendChild(script);\r})();\r\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"a468509bab7a6d11ac6fb1b1dd645ef3","permalink":"https://GangSirius.github.io/teaching/tmseries/lecture5/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/tmseries/lecture5/","section":"teaching","summary":"Lecture5: AR Model\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.","tags":null,"title":"","type":"teaching"},{"authors":null,"categories":null,"content":"\rLecture6: ARMA Model\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.table th:not([align]) {\rtext-align: left;\r}\r\r\r\r.main-container {\rmax-width: 940px;\rmargin-left: auto;\rmargin-right: auto;\r}\rcode {\rcolor: inherit;\rbackground-color: rgba(0, 0, 0, 0.04);\r}\rimg {\rmax-width:100%;\rheight: auto;\r}\r.tabbed-pane {\rpadding-top: 12px;\r}\r.html-widget {\rmargin-bottom: 20px;\r}\rbutton.code-folding-btn:focus {\routline: none;\r}\rsummary {\rdisplay: list-item;\r}\r\r.tabset-dropdown  .nav-tabs {\rdisplay: inline-table;\rmax-height: 500px;\rmin-height: 44px;\roverflow-y: auto;\rbackground: white;\rborder: 1px solid #ddd;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs  li.active:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li.active:before {\rcontent: \"\";\rborder: none;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs  li.active {\rdisplay: block;\r}\r.tabset-dropdown  .nav-tabs  li  a,\r.tabset-dropdown  .nav-tabs  li  a:focus,\r.tabset-dropdown  .nav-tabs  li  a:hover {\rborder: none;\rdisplay: inline-block;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li {\rdisplay: block;\rfloat: none;\r}\r.tabset-dropdown  .nav-tabs  li {\rdisplay: none;\r}\r\r\r$(document).ready(function () {\rwindow.buildTabsets(\"TOC\");\r});\r$(document).ready(function () {\r$('.tabset-dropdown  .nav-tabs  li').click(function () {\r$(this).parent().toggleClass('nav-tabs-open')\r});\r});\r\rLecture6: ARMA Model\rZhou Chao\r\rImportant: You only need to type the quoted commands in R console\nContent\rAIC \rCreate Moving-average process\n\rBuilding an MA model\n\rForecast with fitted model\n\rConsider the drift\n\rHandling unit root\n\rUnitroot Test\n\rHandling outliers\n\rBuild seasonal time series model\n\rRegression model with time series errors\n\r\r1. AIC \r\rUse log likelihood, AIC and Ljung-Box statistics to compare different AR time series models.\r\rgnp \u0026lt;- scan(file='dgnp82.txt')\rm1 \u0026lt;- ar(gnp,method=\u0026quot;mle\u0026quot;)\rm1$order\r## [1] 3\r(m2 \u0026lt;- arima(gnp,order=c(3,0,0)))\r## ## Call:\r## arima(x = gnp, order = c(3, 0, 0))\r## ## Coefficients:\r## ar1 ar2 ar3 intercept\r## 0.3480 0.1793 -0.1423 0.0077\r## s.e. 0.0745 0.0778 0.0745 0.0012\r## ## sigma^2 estimated as 9.427e-05: log likelihood = 565.84, aic = -1121.68\rtsdiag(m2,gof=24) #from Ljung-Box statistics, m2 is better comparing with m3 below\rpacf(gnp)\rm3 \u0026lt;- arima(gnp,order=c(1,0,0))\rtsdiag(m3,gof=24)\r\r2. Create Moving-average process \r\rGenerate 200 data points from standard Normal distribution\r\rx \u0026lt;- rnorm(200) x1 = c(0,x[-200]) # add \u0026quot;0\u0026quot; at the beginning and remove x_{200} from the data\ryt \u0026lt;- (x+x1)/2 # compute the mean of the two series\ryt = yt[-1] # remove the first data point.\racf(yt) # ACF plot shows a significant lag-1 ACF\r\r3. Building an MA model \rda \u0026lt;- read.table(\u0026quot;m-dec125910-5112.txt\u0026quot;,header=T)\rdim(da) \r## [1] 3720 3\rhead(da)\r## caldt prtnam totret\r## 1 19510131 1 0.051262\r## 2 19510228 1 0.016479\r## 3 19510331 1 -0.015760\r## 4 19510430 1 0.053317\r## 5 19510531 1 -0.023707\r## 6 19510629 1 -0.017999\rtail(da)\r## caldt prtnam totret\r## 3715 20120731 9 -0.023162\r## 3716 20120831 9 0.030083\r## 3717 20120928 9 0.043477\r## 3718 20121031 9 -0.035877\r## 3719 20121130 9 0.006842\r## 3720 20121231 9 0.041697\r\rLocate the returns of Decile 5 portfolio\r\ridx = c(1:3720)[da[,2]==5] rt5 = da[idx,3]\rhead(rt5)\r## [1] 0.086797 0.005635 -0.041380 0.037564 -0.018345 -0.048787\racf(rt5)\r\rFit a MA(1) and do prediction\r\rm1 \u0026lt;- arima(rt5,order=c(0,0,1)) tsdiag(m1) #check the fitted model\rda \u0026lt;- read.table(\u0026quot;d-ibmvwew6202.txt\u0026quot;,header=T)\rdim(da)\r## [1] 10194 4\rvw=log(1+da[,3])*100 # Compute percentage log returns of the vw index.\racf(vw,lag.max=10) \rm1 \u0026lt;- arima(vw,order=c(0,0,1)) # fits an MA(1) model\rtsdiag(m1)\rpredict(m1,5)\r## $pred\r## Time Series:\r## Start = 10195 ## End = 10199 ## Frequency = 1 ## [1] 0.05036298 0.03960887 0.03960887 0.03960887 0.03960887\r## ## $se\r## Time Series:\r## Start = 10195 ## End = 10199 ## Frequency = 1 ## [1] 0.8823290 0.8917523 0.8917523 0.8917523 0.8917523\r\r4. Forecast with fitted model \r\rFit an AR(3) model for time series “gnp”\r\rrequire(ggplot2)\r## Loading required package: ggplot2\rrequire(ggfortify)\r## Loading required package: ggfortify\rrequire(forecast)\r## Loading required package: forecast\rgnp=scan(file = \u0026quot;dgnp82.txt\u0026quot;)\rm1 \u0026lt;- arima(gnp,order=c(3,0,0)) pre \u0026lt;- forecast(m1,level = c(95), h = 9) # Prediction\rdev.off() # make sure no graphics error \r## null device ## 1\rautoplot(pre)\r\r5. Consider the drift \r\rCompute log returns of Decile 5 portfolio in (2)\r\rxt \u0026lt;- log(rt5+1) Pt \u0026lt;- cumsum(xt) # accumulate the log returns\rmm \u0026lt;- mean(xt)\r\rRemove mean from the log returns and compute cumulative partial sum\r\rxt1 \u0026lt;- xt-mm Xt \u0026lt;- cumsum(xt1)\ryu \u0026lt;- max(Pt,Xt)\r\rPlot\r\rylow \u0026lt;- min(Pt,Xt)\rplot(ts(Pt),type='l',ylim=c(ylow,yu), ylab = \u0026quot;Pt\u0026quot;)\rlines(Xt,lty=2)\rabline(0,mm) # add the drift on the plot.\r\r6. Handling unit root: Differencing \rda = read.table(\u0026quot;q-earn-jnj.txt\u0026quot;)\rhead(da)\r## V1\r## 1 0.71\r## 2 0.63\r## 3 0.85\r## 4 0.44\r## 5 0.61\r## 6 0.69\rjnj=log(da[,1])\rdx=diff(jnj) # Regular difference\rdx=diff(jnj,4) # Seasonal difference, i.e. dx=x(t)-x(t-4).\r\r7. Unitroot Test \rrequire(fUnitRoots) # Load library\r## Loading required package: fUnitRoots\r## Loading required package: timeDate\r## Loading required package: timeSeries\r## Loading required package: fBasics\rda = read.table(\u0026quot;q-gdpc96.txt\u0026quot;,header=T) # Load data U.S. quaterly real GDP series from 1947.I to 2009.IV.\rgdp=log(da[,4]) # Take log transformation\radfTest(gdp,lags=3,type=c(\u0026quot;c\u0026quot;)) # unit-root test with a constant.\r## ## Title:\r## Augmented Dickey-Fuller Test\r## ## Test Results:\r## PARAMETER:\r## Lag Order: 3\r## STATISTIC:\r## Dickey-Fuller: -1.798\r## P VALUE:\r## 0.3873 ## ## Description:\r## Sun Apr 14 00:17:32 2019 by user: Sirius\r\r8. Handling outliers \r(m1=arima(rt5,order=c(0,0,1)))\r## ## Call:\r## arima(x = rt5, order = c(0, 0, 1))\r## ## Coefficients:\r## ma1 intercept\r## 0.1564 0.0110\r## s.e. 0.0385 0.0022\r## ## sigma^2 estimated as 0.002629: log likelihood = 1154.42, aic = -2302.83\rtsdiag(m1)\rwhich.max(abs(m1$residuals)) # identifies the location of outlier at t=442\r## [1] 442\rI442=rep(0,744) # create a vector with 744 '0's\rI442[442] = 1 #set the 442th element as \u0026quot;1\u0026quot;\rplot(I442) # dummy variable for data point t=442\rm2=arima(rt5,order=c(0,0,1),xreg=I442)\rtsdiag(m2)\rwhich.max(m2$residuals) # shows t=289\r## [1] 289\rI289=rep(0,744)\rI289[289] = 1\rX = cbind(I442,I289)\rdim(X)\r## [1] 744 2\r(m3=arima(rt5,order=c(0,0,1),xreg=X)) # handle two outliers.\r## ## Call:\r## arima(x = rt5, order = c(0, 0, 1), xreg = X)\r## ## Coefficients:\r## ma1 intercept I442 I289\r## 0.1539 0.0110 -0.2657 0.2452\r## s.e. 0.0381 0.0021 0.0491 0.0489\r## ## sigma^2 estimated as 0.002449: log likelihood = 1180.78, aic = -2351.57\r\r9. Build seasonal time series model \rda = read.table(\u0026quot;m-hstarts-5912.txt\u0026quot;,header=T)\rdim(da)\r## [1] 638 4\rhead(da)\r## year mon day hstarts\r## 1 1959 1 1 96.2\r## 2 1959 2 1 99.0\r## 3 1959 3 1 127.7\r## 4 1959 4 1 150.8\r## 5 1959 5 1 152.5\r## 6 1959 6 1 147.8\rlh = log(da$hstarts)\rx1 = ts(lh,frequency=12,start=c(1959,1)) ## create a time series object in R\rautoplot(x1) ## Obtain time plot of the data\racf(lh)\rdlh=diff(lh) # regular difference\racf(dlh,lag=48)\rddlh=diff(dlh,12) # seasonal difference\racf(ddlh)\r(m1 = arima(lh,order=c(0,1,1),seasonal=list(order=c(0,1,1),period=12))) ## Use log housing series\r## ## Call:\r## arima(x = lh, order = c(0, 1, 1), seasonal = list(order = c(0, 1, 1), period = 12))\r## ## Coefficients:\r## ma1 sma1\r## -0.318 -0.8819\r## s.e. 0.035 0.0227\r## ## sigma^2 estimated as 0.008141: log likelihood = 607.48, aic = -1208.97\rtsdiag(m1,gof=24)\r(m1a = arima(lh,order=c(0,1,3),seasonal=list(order=c(0,1,1),period=12))) ## Take care of lag-3 ACF in residuals\r## ## Call:\r## arima(x = lh, order = c(0, 1, 3), seasonal = list(order = c(0, 1, 1), period = 12))\r## ## Coefficients:\r## ma1 ma2 ma3 sma1\r## -0.3482 0.0239 0.1034 -0.8700\r## s.e. 0.0401 0.0410 0.0395 0.0236\r## ## sigma^2 estimated as 0.008042: log likelihood = 611.83, aic = -1213.65\rtsdiag(m1a,gof=24)\rf1=c(NA,0,NA,NA)\r(m1b = arima(lh,order=c(0,1,3),seasonal=list(order=c(0,1,1),period=12),fixed=f1)) ## lag-2 coef is insignificant. Fix lag-2 coef = 0.\r## ## Call:\r## arima(x = lh, order = c(0, 1, 3), seasonal = list(order = c(0, 1, 1), period = 12), ## fixed = f1)\r## ## Coefficients:\r## ma1 ma2 ma3 sma1\r## -0.3409 0 0.1108 -0.8715\r## s.e. 0.0374 0 0.0376 0.0234\r## ## sigma^2 estimated as 0.008044: log likelihood = 611.66, aic = -1215.31\rtsdiag(m1b,gof=24) #Other seasonal ARMA models may fit the data better.\r\r10. Regression model with time series errors \rda = read.table(\u0026quot;w-gs1n36299.txt\u0026quot;,header=T)\rhead(da)\r## y1 y3 date\r## 1 3.24 3.70 19620104\r## 2 3.32 3.75 19620112\r## 3 3.29 3.80 19620120\r## 4 3.26 3.77 19620126\r## 5 3.29 3.80 19620202\r## 6 3.29 3.76 19620208\ry3 = da$y3\ry1 = da$y1\rqplot(y1, y3, geom = \u0026quot;point\u0026quot;, colour = \u0026quot;red\u0026quot;, xlab = \u0026quot;one-year\u0026quot;, ylab = \u0026quot;three-year\u0026quot;)\rm1=lm(y3~y1) ## linear model (linear regression analysis)\rsummary(m1)\r## ## Call:\r## lm(formula = y3 ~ y1)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -1.8121 -0.4023 0.0031 0.4026 1.3388 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.910687 0.032250 28.24 \u0026lt;2e-16 ***\r## y1 0.923854 0.004389 210.51 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.538 on 1965 degrees of freedom\r## Multiple R-squared: 0.9575, Adjusted R-squared: 0.9575 ## F-statistic: 4.431e+04 on 1 and 1965 DF, p-value: \u0026lt; 2.2e-16\rautoplot(ts(m1$residuals), main = \u0026quot;residual\u0026quot;, ylab = \u0026quot;residual\u0026quot;)\racf(m1$residuals)\rr3 = diff(y3)\rr1 = diff(y1)\rqplot(r1, r3, colour = \u0026quot;red\u0026quot;)\rm2 = lm(r3~r1)\rsummary(m2)\r## ## Call:\r## lm(formula = r3 ~ r1)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.38060 -0.03338 -0.00054 0.03437 0.47418 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## (Intercept) 0.0002475 0.0015380 0.161 0.872 ## r1 0.7810590 0.0074651 104.628 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.06819 on 1964 degrees of freedom\r## Multiple R-squared: 0.8479, Adjusted R-squared: 0.8478 ## F-statistic: 1.095e+04 on 1 and 1964 DF, p-value: \u0026lt; 2.2e-16\rm2 = lm(r3 ~ -1+r1) # remove the insignificant constant term\rsummary(m2)\r## ## Call:\r## lm(formula = r3 ~ -1 + r1)\r## ## Residuals:\r## Min 1Q Median 3Q Max ## -0.38036 -0.03314 -0.00030 0.03462 0.47444 ## ## Coefficients:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## r1 0.781065 0.007463 104.7 \u0026lt;2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Residual standard error: 0.06818 on 1965 degrees of freedom\r## Multiple R-squared: 0.8479, Adjusted R-squared: 0.8478 ## F-statistic: 1.095e+04 on 1 and 1965 DF, p-value: \u0026lt; 2.2e-16\racf(m2$residuals)\r(m3 = arima(r3,order=c(0,0,1),xreg=r1,include.mean=F))\r## ## Call:\r## arima(x = r3, order = c(0, 0, 1), xreg = r1, include.mean = F)\r## ## Coefficients:\r## ma1 r1\r## 0.2115 0.7824\r## s.e. 0.0224 0.0077\r## ## sigma^2 estimated as 0.004456: log likelihood = 2531.84, aic = -5057.67\racf(m3$residuals) #A regression model with other ARMA errors may fit the data better.\r\r\r\r\r// add bootstrap table styles to pandoc tables\rfunction bootstrapStylePandocTables() {\r$('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r}\r$(document).ready(function () {\rbootstrapStylePandocTables();\r});\r\r\r(function () {\rvar script = document.createElement(\"script\");\rscript.type = \"text/javascript\";\rscript.src = \"https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\rdocument.getElementsByTagName(\"head\")[0].appendChild(script);\r})();\r\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"940d4ca9764706d04b9875fb547683dc","permalink":"https://GangSirius.github.io/teaching/tmseries/lecture6/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/tmseries/lecture6/","section":"teaching","summary":"Lecture6: ARMA Model\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.","tags":null,"title":"","type":"teaching"},{"authors":null,"categories":null,"content":"\rLecture8: ARCH Model\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.table th:not([align]) {\rtext-align: left;\r}\r\r\r\r.main-container {\rmax-width: 940px;\rmargin-left: auto;\rmargin-right: auto;\r}\rcode {\rcolor: inherit;\rbackground-color: rgba(0, 0, 0, 0.04);\r}\rimg {\rmax-width:100%;\rheight: auto;\r}\r.tabbed-pane {\rpadding-top: 12px;\r}\r.html-widget {\rmargin-bottom: 20px;\r}\rbutton.code-folding-btn:focus {\routline: none;\r}\rsummary {\rdisplay: list-item;\r}\r\r.tabset-dropdown  .nav-tabs {\rdisplay: inline-table;\rmax-height: 500px;\rmin-height: 44px;\roverflow-y: auto;\rbackground: white;\rborder: 1px solid #ddd;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs  li.active:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li.active:before {\rcontent: \"\";\rborder: none;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs  li.active {\rdisplay: block;\r}\r.tabset-dropdown  .nav-tabs  li  a,\r.tabset-dropdown  .nav-tabs  li  a:focus,\r.tabset-dropdown  .nav-tabs  li  a:hover {\rborder: none;\rdisplay: inline-block;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li {\rdisplay: block;\rfloat: none;\r}\r.tabset-dropdown  .nav-tabs  li {\rdisplay: none;\r}\r\r\r$(document).ready(function () {\rwindow.buildTabsets(\"TOC\");\r});\r$(document).ready(function () {\r$('.tabset-dropdown  .nav-tabs  li').click(function () {\r$(this).parent().toggleClass('nav-tabs-open')\r});\r});\r\rLecture8: ARCH Model\rZhou Chao\r\rImportant: You only need to type the quoted commands in R console\nContent\rStudent-t and skew Student-t \rARCH effect test\n\rARCH(1) model with normal innovations\n\rARCH(1) model with Student-t innovations\n\rARCH(1) model with skewed Student-t innovations\n\rUse ARMA(p,q)+ARCH(1) model with normal innovations\n\r\r1. Student-t and skew Student-t \r\rCompare skew-Student-t and Student-t distributions in fGarch package, the commands are sstd and std, respectively.\r\rrequire(fGarch)\r## Loading required package: fGarch\r## Loading required package: timeDate\r## Loading required package: timeSeries\r## Loading required package: fBasics\rx1 = rstd(5000,0,1,5) #(nobs, mean, sd, nu), where nu is the degrees of freedom\rx2 = rsstd(5000,0,1,5,0.8) # skew to the left (nobs, mean,sd,nu,xi) where xi is the skew parameter.\rx3 = rsstd(5000,0,1,5,1.5) # skew to the right\rpar(mfcol=c(1,2))\rhist(x1,nclass=50)\rhist(x2,nclass=50)\rhist(x1,nclass=50)\rhist(x3,nclass=50)\rdev.off()\r## null device ## 1\r\r2. ARCH effect test \r\rGet INTC data\r\rrequire(quantmod)\r## Loading required package: quantmod\r## Loading required package: xts\r## Loading required package: zoo\r## ## Attaching package: 'zoo'\r## The following object is masked from 'package:timeSeries':\r## ## time\u0026lt;-\r## The following objects are masked from 'package:base':\r## ## as.Date, as.Date.numeric\r## Loading required package: TTR\r## ## Attaching package: 'TTR'\r## The following object is masked from 'package:fBasics':\r## ## volatility\r## Version 0.4-0 included new data defaults. See ?getSymbols.\rrequire(aTSA)\r## Loading required package: aTSA\r## ## Attaching package: 'aTSA'\r## The following object is masked from 'package:graphics':\r## ## identify\rgetSymbols(\u0026quot;INTC\u0026quot;)\r## 'getSymbols' currently uses auto.assign=TRUE by default, but will\r## use auto.assign=FALSE in 0.5-0. You will still be able to use\r## 'loadSymbols' to automatically load data. getOption(\u0026quot;getSymbols.env\u0026quot;)\r## and getOption(\u0026quot;getSymbols.auto.assign\u0026quot;) will still be checked for\r## alternate defaults.\r## ## This message is shown once per session and may be disabled by setting ## options(\u0026quot;getSymbols.warning4.0\u0026quot;=FALSE). See ?getSymbols for details.\r## [1] \u0026quot;INTC\u0026quot;\rret = diff(log(INTC$INTC.Adjusted))[-1]\r\rConduct test\r\racf(ret) # No strong serial correlations\rBox.test(ret,lag=12,type='Ljung') ## confirm no serrial correlations\r## ## Box-Ljung test\r## ## data: ret\r## X-squared = 71.907, df = 12, p-value = 1.406e-10\rt.test(ret$INTC.Adjusted) ## Confirm mean is not zero\r## ## One Sample t-test\r## ## data: ret$INTC.Adjusted\r## t = 1.3677, df = 3089, p-value = 0.1715\r## alternative hypothesis: true mean is not equal to 0\r## 95 percent confidence interval:\r## -0.000195095 0.001094933\r## sample estimates:\r## mean of x ## 0.0004499191\rat=ret-mean(ret)\rBox.test(at^2,lag=12,type=\u0026quot;Ljung\u0026quot;) # Confirm the existence of ARCH effect\r## ## Box-Ljung test\r## ## data: at^2\r## X-squared = 1224.3, df = 12, p-value \u0026lt; 2.2e-16\rarch.test(arima(at,order = c(1,0,0)), output = T)\r## ARCH heteroscedasticity test for residuals ## alternative: heteroscedastic ## ## Portmanteau-Q test: ## order PQ p.value\r## [1,] 4 279 0\r## [2,] 8 628 0\r## [3,] 12 1086 0\r## [4,] 16 1326 0\r## [5,] 20 1555 0\r## [6,] 24 1824 0\r## Lagrange-Multiplier test: ## order LM p.value\r## [1,] 4 3125 0\r## [2,] 8 1249 0\r## [3,] 12 658 0\r## [4,] 16 475 0\r## [5,] 20 375 0\r## [6,] 24 304 0\r\r3. ARCH(1) model with normal innovations \rm2=garchFit(~garch(1,0),data=ret) #lots of output\r## ## Series Initialization:\r## ARMA Model: arma\r## Formula Mean: ~ arma(0, 0)\r## GARCH Model: garch\r## Formula Variance: ~ garch(1, 0)\r## ARMA Order: 0 0\r## Max ARMA Order: 0\r## GARCH Order: 1 0\r## Max GARCH Order: 1\r## Maximum Order: 1\r## Conditional Dist: norm\r## h.start: 2\r## llh.start: 1\r## Length of Series: 3090\r## Recursion Init: mci\r## Series Scale: 0.01828648\r## ## Parameter Initialization:\r## Initial Parameters: $params\r## Limits of Transformations: $U, $V\r## Which Parameters are Fixed? $includes\r## Parameter Matrix:\r## U V params includes\r## mu -0.24603918 0.2460392 0.02460392 TRUE\r## omega 0.00000100 100.0000000 0.10000000 TRUE\r## alpha1 0.00000001 1.0000000 0.10000000 TRUE\r## gamma1 -0.99999999 1.0000000 0.10000000 FALSE\r## delta 0.00000000 2.0000000 2.00000000 FALSE\r## skew 0.10000000 10.0000000 1.00000000 FALSE\r## shape 1.00000000 10.0000000 4.00000000 FALSE\r## Index List of Parameters to be Optimized:\r## mu omega alpha1 ## 1 2 3 ## Persistence: 0.1 ## ## ## --- START OF TRACE ---\r## Selected Algorithm: nlminb ## ## R coded nlminb Solver: ## ## 0: 9445.8928: 0.0246039 0.100000 0.100000\r## 1: 4367.1446: 0.0246075 1.05789 0.387131\r## 2: 4358.1482: 0.0246428 1.08236 0.283933\r## 3: 4322.4163: 0.0246482 0.985590 0.240506\r## 4: 4292.3436: 0.0246611 0.807974 0.179104\r## 5: 4290.5874: 0.0246980 0.771357 0.363427\r## 6: 4288.3954: 0.0286613 0.687104 0.315759\r## 7: 4285.8916: 0.0331251 0.736061 0.313325\r## 8: 4285.6799: 0.0377293 0.739665 0.296437\r## 9: 4285.6748: 0.0375816 0.741976 0.291580\r## 10: 4285.6741: 0.0385805 0.741679 0.292657\r## 11: 4285.6737: 0.0381538 0.741650 0.292724\r## 12: 4285.6737: 0.0381647 0.741677 0.292657\r## 13: 4285.6737: 0.0381651 0.741675 0.292664\r## ## Final Estimate of the Negative LLH:\r## LLH: -8079.249 norm LLH: -2.614644 ## mu omega alpha1 ## 0.0006979046 0.0002480127 0.2926641420 ## ## R-optimhess Difference Approximated Hessian Matrix:\r## mu omega alpha1\r## mu -11420017.966 -4744845 3767.851\r## omega -4744845.114 -18055327011 -2361027.444\r## alpha1 3767.851 -2361027 -1070.351\r## attr(,\u0026quot;time\u0026quot;)\r## Time difference of 0.02696395 secs\r## ## --- END OF TRACE ---\r## ## ## Time to Estimate Parameters:\r## Time difference of 0.136991 secs\rm2=garchFit(~garch(1,0),data=ret,trace=F) # no output printed.\rsummary(m2) # Obtain results and model checking statististics\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~garch(1, 0), data = ret, trace = F) ## ## Mean and Variance Equation:\r## data ~ garch(1, 0)\r## \u0026lt;environment: 0x000000001de7fba0\u0026gt;\r## [data = ret]\r## ## Conditional Distribution:\r## norm ## ## Coefficient(s):\r## mu omega alpha1 ## 0.00069790 0.00024801 0.29266414 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu 6.979e-04 2.963e-04 2.356 0.0185 * ## omega 2.480e-04 8.828e-06 28.095 \u0026lt; 2e-16 ***\r## alpha1 2.927e-01 3.628e-02 8.068 6.66e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 8079.249 normalized: 2.614644 ## ## Description:\r## Mon Apr 15 14:15:16 2019 by user: Sirius ## ## ## Standardised Residuals Tests:\r## Statistic p-Value ## Jarque-Bera Test R Chi^2 3106.155 0 ## Shapiro-Wilk Test R W 0.9493431 0 ## Ljung-Box Test R Q(10) 37.41036 4.804912e-05\r## Ljung-Box Test R Q(15) 52.01586 5.614487e-06\r## Ljung-Box Test R Q(20) 56.76874 2.225106e-05\r## Ljung-Box Test R^2 Q(10) 202.3313 0 ## Ljung-Box Test R^2 Q(15) 336.1846 0 ## Ljung-Box Test R^2 Q(20) 416.3516 0 ## LM Arch Test R TR^2 207.4148 0 ## ## Information Criterion Statistics:\r## AIC BIC SIC HQIC ## -5.227346 -5.221486 -5.227348 -5.225241\rsresi=residuals(m2,standardize=T) # Obtain standardized residuals\r#plot(m2) # Many choices are available, choice 3 or 13 is useful.\rpredict(m2,6) # prediction\r## meanForecast meanError standardDeviation\r## 1 0.0006979046 0.01671452 0.01671452\r## 2 0.0006979046 0.01815973 0.01815973\r## 3 0.0006979046 0.01856142 0.01856142\r## 4 0.0006979046 0.01867734 0.01867734\r## 5 0.0006979046 0.01871114 0.01871114\r## 6 0.0006979046 0.01872101 0.01872101\r\r4. ARCH(1) model with Student-t innovations \rm2=garchFit(~garch(1,0),data=ret,trace=F,cond.dist=c(\u0026quot;std\u0026quot;))\rsummary(m2)\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~garch(1, 0), data = ret, cond.dist = c(\u0026quot;std\u0026quot;), ## trace = F) ## ## Mean and Variance Equation:\r## data ~ garch(1, 0)\r## \u0026lt;environment: 0x00000000232de990\u0026gt;\r## [data = ret]\r## ## Conditional Distribution:\r## std ## ## Coefficient(s):\r## mu omega alpha1 shape ## 0.00081160 0.00026082 0.33068733 3.65062066 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu 8.116e-04 2.527e-04 3.211 0.00132 ** ## omega 2.608e-04 1.886e-05 13.828 \u0026lt; 2e-16 ***\r## alpha1 3.307e-01 5.364e-02 6.166 7.03e-10 ***\r## shape 3.651e+00 2.609e-01 13.993 \u0026lt; 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 8315.439 normalized: 2.691081 ## ## Description:\r## Mon Apr 15 14:15:16 2019 by user: Sirius ## ## ## Standardised Residuals Tests:\r## Statistic p-Value ## Jarque-Bera Test R Chi^2 3111.296 0 ## Shapiro-Wilk Test R W 0.9493066 0 ## Ljung-Box Test R Q(10) 36.65451 6.4933e-05 ## Ljung-Box Test R Q(15) 51.12629 7.870861e-06\r## Ljung-Box Test R Q(20) 55.80878 3.105982e-05\r## Ljung-Box Test R^2 Q(10) 193.7548 0 ## Ljung-Box Test R^2 Q(15) 322.9409 0 ## Ljung-Box Test R^2 Q(20) 400.6217 0 ## LM Arch Test R TR^2 202.3887 0 ## ## Information Criterion Statistics:\r## AIC BIC SIC HQIC ## -5.379572 -5.371759 -5.379576 -5.376766\r\r5. ARCH(1) model with skewed Student-t innovations \rm3=garchFit(~garch(1,0),data=ret,trace=F,cond.dist=c(\u0026quot;sstd\u0026quot;))\rsummary(m3)\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~garch(1, 0), data = ret, cond.dist = c(\u0026quot;sstd\u0026quot;), ## trace = F) ## ## Mean and Variance Equation:\r## data ~ garch(1, 0)\r## \u0026lt;environment: 0x0000000023136370\u0026gt;\r## [data = ret]\r## ## Conditional Distribution:\r## sstd ## ## Coefficient(s):\r## mu omega alpha1 skew shape ## 0.00057427 0.00026062 0.32897650 0.96403891 3.65860874 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu 0.0005743 0.0002950 1.947 0.0516 . ## omega 0.0002606 0.0000188 13.861 \u0026lt; 2e-16 ***\r## alpha1 0.3289765 0.0532744 6.175 6.61e-10 ***\r## skew 0.9640389 0.0226336 42.593 \u0026lt; 2e-16 ***\r## shape 3.6586087 0.2614363 13.994 \u0026lt; 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 8316.656 normalized: 2.691475 ## ## Description:\r## Mon Apr 15 14:15:17 2019 by user: Sirius ## ## ## Standardised Residuals Tests:\r## Statistic p-Value ## Jarque-Bera Test R Chi^2 3127.257 0 ## Shapiro-Wilk Test R W 0.9492523 0 ## Ljung-Box Test R Q(10) 36.75206 6.246293e-05\r## Ljung-Box Test R Q(15) 51.25141 7.506414e-06\r## Ljung-Box Test R Q(20) 55.95154 2.95613e-05 ## Ljung-Box Test R^2 Q(10) 192.9461 0 ## Ljung-Box Test R^2 Q(15) 322.4933 0 ## Ljung-Box Test R^2 Q(20) 400.5649 0 ## LM Arch Test R TR^2 202.4937 0 ## ## Information Criterion Statistics:\r## AIC BIC SIC HQIC ## -5.379713 -5.369946 -5.379718 -5.376205\r\r6. Use ARMA(p,q)+ARCH(1) model with normal innovations \r\rIn case needs an ARMA model for mean equation\r\rm4=garchFit(~arma(1,1)+garch(1,0),data=ret,trace=F) #change p,q to two positive numbers, or use auto.arima to determine p, q\rsummary(m4)\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~arma(1, 1) + garch(1, 0), data = ret, trace = F) ## ## Mean and Variance Equation:\r## data ~ arma(1, 1) + garch(1, 0)\r## \u0026lt;environment: 0x00000000230ee6b0\u0026gt;\r## [data = ret]\r## ## Conditional Distribution:\r## norm ## ## Coefficient(s):\r## mu ar1 ma1 omega alpha1 ## 0.00068036 -0.00189955 -0.01083340 0.00024887 0.28553827 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu 6.804e-04 3.753e-04 1.813 0.0698 . ## ar1 -1.900e-03 3.255e-01 -0.006 0.9953 ## ma1 -1.083e-02 3.386e-01 -0.032 0.9745 ## omega 2.489e-04 9.216e-06 27.003 \u0026lt; 2e-16 ***\r## alpha1 2.855e-01 3.874e-02 7.371 1.69e-13 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 8082.052 normalized: 2.615551 ## ## Description:\r## Mon Apr 15 14:15:18 2019 by user: Sirius ## ## ## Standardised Residuals Tests:\r## Statistic p-Value ## Jarque-Bera Test R Chi^2 3166.402 0 ## Shapiro-Wilk Test R W 0.9490046 0 ## Ljung-Box Test R Q(10) 34.85376 0.0001322463\r## Ljung-Box Test R Q(15) 49.62068 1.388575e-05\r## Ljung-Box Test R Q(20) 54.41973 5.011316e-05\r## Ljung-Box Test R^2 Q(10) 202.323 0 ## Ljung-Box Test R^2 Q(15) 337.7983 0 ## Ljung-Box Test R^2 Q(20) 418.2603 0 ## LM Arch Test R TR^2 207.2196 0 ## ## Information Criterion Statistics:\r## AIC BIC SIC HQIC ## -5.227865 -5.218098 -5.227870 -5.224357\r\r\r\r\r// add bootstrap table styles to pandoc tables\rfunction bootstrapStylePandocTables() {\r$('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r}\r$(document).ready(function () {\rbootstrapStylePandocTables();\r});\r\r\r(function () {\rvar script = document.createElement(\"script\");\rscript.type = \"text/javascript\";\rscript.src = \"https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\rdocument.getElementsByTagName(\"head\")[0].appendChild(script);\r})();\r\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"a0c16edccd62a3ac52cecaa18a92e6f4","permalink":"https://GangSirius.github.io/teaching/tmseries/lecture8/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/tmseries/lecture8/","section":"teaching","summary":"Lecture8: ARCH Model\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.","tags":null,"title":"","type":"teaching"},{"authors":null,"categories":null,"content":"\rLecture9: GARCH Family\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.table th:not([align]) {\rtext-align: left;\r}\r\r\r\r.main-container {\rmax-width: 940px;\rmargin-left: auto;\rmargin-right: auto;\r}\rcode {\rcolor: inherit;\rbackground-color: rgba(0, 0, 0, 0.04);\r}\rimg {\rmax-width:100%;\rheight: auto;\r}\r.tabbed-pane {\rpadding-top: 12px;\r}\r.html-widget {\rmargin-bottom: 20px;\r}\rbutton.code-folding-btn:focus {\routline: none;\r}\rsummary {\rdisplay: list-item;\r}\r\r.tabset-dropdown  .nav-tabs {\rdisplay: inline-table;\rmax-height: 500px;\rmin-height: 44px;\roverflow-y: auto;\rbackground: white;\rborder: 1px solid #ddd;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs  li.active:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li.active:before {\rcontent: \"\";\rborder: none;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open:before {\rcontent: \"\";\rfont-family: 'Glyphicons Halflings';\rdisplay: inline-block;\rpadding: 10px;\rborder-right: 1px solid #ddd;\r}\r.tabset-dropdown  .nav-tabs  li.active {\rdisplay: block;\r}\r.tabset-dropdown  .nav-tabs  li  a,\r.tabset-dropdown  .nav-tabs  li  a:focus,\r.tabset-dropdown  .nav-tabs  li  a:hover {\rborder: none;\rdisplay: inline-block;\rborder-radius: 4px;\r}\r.tabset-dropdown  .nav-tabs.nav-tabs-open  li {\rdisplay: block;\rfloat: none;\r}\r.tabset-dropdown  .nav-tabs  li {\rdisplay: none;\r}\r\r\r$(document).ready(function () {\rwindow.buildTabsets(\"TOC\");\r});\r$(document).ready(function () {\r$('.tabset-dropdown  .nav-tabs  li').click(function () {\r$(this).parent().toggleClass('nav-tabs-open')\r});\r});\r\rLecture9: GARCH Family\rZhou Chao\r\rImportant: You only need to type the quoted commands in R console\nContent\rGARCH Simulation \rFit GARCH Model\n\rIGARCH\n\rGARCH-M\n\rTGARCH\n\r\r1. GARCH Simulation \r\rSimulation\r\rrequire(fGarch)\r## Loading required package: fGarch\r## Loading required package: timeDate\r## Loading required package: timeSeries\r## Loading required package: fBasics\rN = 200\rx.vec = as.vector(garchSim(garchSpec(rseed = 1985), n = N)[,1])\rgarchFit(~ garch(1,1), data = x.vec, trace = FALSE)\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~garch(1, 1), data = x.vec, trace = FALSE) ## ## Mean and Variance Equation:\r## data ~ garch(1, 1)\r## \u0026lt;environment: 0x000000001d336340\u0026gt;\r## [data = x.vec]\r## ## Conditional Distribution:\r## norm ## ## Coefficient(s):\r## mu omega alpha1 beta1 ## 3.5418e-05 1.0819e-06 8.8855e-02 8.1200e-01 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu 3.542e-05 2.183e-04 0.162 0.871 ## omega 1.082e-06 1.051e-06 1.030 0.303 ## alpha1 8.885e-02 5.450e-02 1.630 0.103 ## beta1 8.120e-01 1.242e-01 6.538 6.25e-11 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 861.9494 normalized: 4.309747 ## ## Description:\r## Mon Apr 15 15:20:21 2019 by user: Sirius\r\r2. Fit GARCH Model \r\rGet data\r\rrequire(quantmod)\r## Loading required package: quantmod\r## Loading required package: xts\r## Loading required package: zoo\r## ## Attaching package: 'zoo'\r## The following object is masked from 'package:timeSeries':\r## ## time\u0026lt;-\r## The following objects are masked from 'package:base':\r## ## as.Date, as.Date.numeric\r## Loading required package: TTR\r## ## Attaching package: 'TTR'\r## The following object is masked from 'package:fBasics':\r## ## volatility\r## Version 0.4-0 included new data defaults. See ?getSymbols.\rgetSymbols(\u0026quot;SP\u0026quot;)\r## 'getSymbols' currently uses auto.assign=TRUE by default, but will\r## use auto.assign=FALSE in 0.5-0. You will still be able to use\r## 'loadSymbols' to automatically load data. getOption(\u0026quot;getSymbols.env\u0026quot;)\r## and getOption(\u0026quot;getSymbols.auto.assign\u0026quot;) will still be checked for\r## alternate defaults.\r## ## This message is shown once per session and may be disabled by setting ## options(\u0026quot;getSymbols.warning4.0\u0026quot;=FALSE). See ?getSymbols for details.\r## [1] \u0026quot;SP\u0026quot;\rsp5 = diff(log(SP$SP.Adjusted))[-1]\r\rConduct test\r\racf(sp5)\rBox.test(sp5,lag=12,type='Ljung') # Some serial correlations\r## ## Box-Ljung test\r## ## data: sp5\r## X-squared = 54.049, df = 12, p-value = 2.678e-07\rpacf(sp5)\r(n1 = arima(sp5,order=c(1,0,0)))\r## ## Call:\r## arima(x = sp5, order = c(1, 0, 0))\r## ## Coefficients:\r## ar1 intercept\r## -0.1045 2e-04\r## s.e. 0.0179 3e-04\r## ## sigma^2 estimated as 0.0004523: log likelihood = 7513.9, aic = -15021.81\rtsdiag(n1)\rBox.test(n1$residuals^2,lag=12,type='Ljung') # confirm the existence of ARCH effect\r## ## Box-Ljung test\r## ## data: n1$residuals^2\r## X-squared = 930.82, df = 12, p-value \u0026lt; 2.2e-16\r\rModel fitting\r\rn2 = garchFit(~arma(1,0)+garch(1,1),data=sp5,trace=F) #AR(1) for the mean equation and GARCH(1,1) for the volatility equation\rsummary(n2)\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~arma(1, 0) + garch(1, 1), data = sp5, trace = F) ## ## Mean and Variance Equation:\r## data ~ arma(1, 0) + garch(1, 1)\r## \u0026lt;environment: 0x000000001c7adbc0\u0026gt;\r## [data = sp5]\r## ## Conditional Distribution:\r## norm ## ## Coefficient(s):\r## mu ar1 omega alpha1 beta1 ## 3.2979e-04 -6.3167e-02 5.2009e-06 4.1160e-02 9.4593e-01 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu 3.298e-04 3.252e-04 1.014 0.310448 ## ar1 -6.317e-02 1.880e-02 -3.360 0.000780 ***\r## omega 5.201e-06 1.440e-06 3.612 0.000304 ***\r## alpha1 4.116e-02 6.569e-03 6.265 3.72e-10 ***\r## beta1 9.459e-01 9.069e-03 104.308 \u0026lt; 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 7801.012 normalized: 2.524599 ## ## Description:\r## Mon Apr 15 15:20:27 2019 by user: Sirius ## ## ## Standardised Residuals Tests:\r## Statistic p-Value ## Jarque-Bera Test R Chi^2 706.7697 0 ## Shapiro-Wilk Test R W 0.9776186 0 ## Ljung-Box Test R Q(10) 13.14701 0.2155682 ## Ljung-Box Test R Q(15) 27.39143 0.02570426\r## Ljung-Box Test R Q(20) 35.19048 0.01911293\r## Ljung-Box Test R^2 Q(10) 16.89577 0.07670239\r## Ljung-Box Test R^2 Q(15) 18.53039 0.2358083 ## Ljung-Box Test R^2 Q(20) 24.97751 0.202293 ## LM Arch Test R TR^2 17.11173 0.1454427 ## ## Information Criterion Statistics:\r## AIC BIC SIC HQIC ## -5.045963 -5.036196 -5.045968 -5.042455\rpredict(n2,2)\r## meanForecast meanError standardDeviation\r## 1 -0.0004381447 0.01566221 0.01566221\r## 2 0.0003574698 0.01575810 0.01572701\rn3 = garchFit(~garch(1,1),data=sp5,trace=F)\rsummary(n3)\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~garch(1, 1), data = sp5, trace = F) ## ## Mean and Variance Equation:\r## data ~ garch(1, 1)\r## \u0026lt;environment: 0x000000001d061c18\u0026gt;\r## [data = sp5]\r## ## Conditional Distribution:\r## norm ## ## Coefficient(s):\r## mu omega alpha1 beta1 ## 3.0493e-04 5.4448e-06 4.3042e-02 9.4352e-01 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu 3.049e-04 3.244e-04 0.940 0.347253 ## omega 5.445e-06 1.500e-06 3.630 0.000284 ***\r## alpha1 4.304e-02 6.902e-03 6.236 4.5e-10 ***\r## beta1 9.435e-01 9.503e-03 99.285 \u0026lt; 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 7792.69 normalized: 2.521906 ## ## Description:\r## Mon Apr 15 15:20:27 2019 by user: Sirius ## ## ## Standardised Residuals Tests:\r## Statistic p-Value ## Jarque-Bera Test R Chi^2 704.8031 0 ## Shapiro-Wilk Test R W 0.9775696 0 ## Ljung-Box Test R Q(10) 24.19706 0.00709417 ## Ljung-Box Test R Q(15) 36.63479 0.001430508\r## Ljung-Box Test R Q(20) 44.59722 0.001250952\r## Ljung-Box Test R^2 Q(10) 17.1896 0.07027239 ## Ljung-Box Test R^2 Q(15) 18.62921 0.2310304 ## Ljung-Box Test R^2 Q(20) 25.1777 0.1947172 ## LM Arch Test R TR^2 17.47188 0.1326921 ## ## Information Criterion Statistics:\r## AIC BIC SIC HQIC ## -5.041224 -5.033410 -5.041227 -5.038417\r\r3. IGARCH \rrequire(rugarch)\r## Loading required package: rugarch\r## Loading required package: parallel\r## ## Attaching package: 'rugarch'\r## The following object is masked from 'package:stats':\r## ## sigma\rspec3 = ugarchspec(variance.model=list(model=\u0026quot;iGARCH\u0026quot;, garchOrder=c(1,1)),\rmean.model=list(armaOrder=c(0,0), include.mean=FALSE),\rdistribution.model=\u0026quot;norm\u0026quot;, fixed.pars=list(omega=0))\rfit = ugarchfit(spec3, data = sp5)\rsummary(fit) # note: for S4 Mode, use \u0026quot;@\u0026quot; to find inherited class rather than \u0026quot;$\u0026quot;\r## Length Class Mode ## 1 uGARCHfit S4\rfit\r## ## *---------------------------------*\r## * GARCH Model Fit *\r## *---------------------------------*\r## ## Conditional Variance Dynamics ## -----------------------------------\r## GARCH Model : iGARCH(1,1)\r## Mean Model : ARFIMA(0,0,0)\r## Distribution : norm ## ## Optimal Parameters\r## ------------------------------------\r## Estimate Std. Error t value Pr(\u0026gt;|t|)\r## omega 0.000000 NA NA NA\r## alpha1 0.030173 0.003339 9.0361 0\r## beta1 0.969827 NA NA NA\r## ## Robust Standard Errors:\r## Estimate Std. Error t value Pr(\u0026gt;|t|)\r## omega 0.000000 NA NA NA\r## alpha1 0.030173 0.006676 4.5194 6e-06\r## beta1 0.969827 NA NA NA\r## ## LogLikelihood : 7769.698 ## ## Information Criteria\r## ------------------------------------\r## ## Akaike -5.0283\r## Bayes -5.0263\r## Shibata -5.0283\r## Hannan-Quinn -5.0276\r## ## Weighted Ljung-Box Test on Standardized Residuals\r## ------------------------------------\r## statistic p-value\r## Lag[1] 7.277 0.006984\r## Lag[2*(p+q)+(p+q)-1][2] 7.965 0.006608\r## Lag[4*(p+q)+(p+q)-1][5] 9.387 0.013205\r## d.o.f=0\r## H0 : No serial correlation\r## ## Weighted Ljung-Box Test on Standardized Squared Residuals\r## ------------------------------------\r## statistic p-value\r## Lag[1] 18.94 1.349e-05\r## Lag[2*(p+q)+(p+q)-1][5] 19.78 2.228e-05\r## Lag[4*(p+q)+(p+q)-1][9] 21.32 9.162e-05\r## d.o.f=2\r## ## Weighted ARCH LM Tests\r## ------------------------------------\r## Statistic Shape Scale P-Value\r## ARCH Lag[3] 0.03497 0.500 2.000 0.8517\r## ARCH Lag[5] 1.94723 1.440 1.667 0.4830\r## ARCH Lag[7] 2.94724 2.315 1.543 0.5236\r## ## Nyblom stability test\r## ------------------------------------\r## Joint Statistic: 0.5388\r## Individual Statistics: ## alpha1 0.5388\r## ## Asymptotic Critical Values (10% 5% 1%)\r## Joint Statistic: 0.353 0.47 0.748\r## Individual Statistic: 0.35 0.47 0.75\r## ## Sign Bias Test\r## ------------------------------------\r## t-value prob sig\r## Sign Bias 0.6553 0.5123 ## Negative Sign Bias 1.6307 0.1031 ## Positive Sign Bias 1.0564 0.2909 ## Joint Effect 5.6994 0.1272 ## ## ## Adjusted Pearson Goodness-of-Fit Test:\r## ------------------------------------\r## group statistic p-value(g-1)\r## 1 20 120.4 9.463e-17\r## 2 30 128.4 1.801e-14\r## 3 40 160.0 1.375e-16\r## 4 50 160.6 8.744e-14\r## ## ## Elapsed time : 0.8769951\r\r4. GARCH-M \rspec3 = ugarchspec(variance.model=list(model=\u0026quot;sGARCH\u0026quot;, garchOrder=c(1,1)),\rmean.model=list(armaOrder=c(0,0),include.mean=TRUE,archm=TRUE,archpow=2),\rdistribution.model=\u0026quot;norm\u0026quot;)\rfit = ugarchfit(spec3, data = sp5*100)\rfit\r## ## *---------------------------------*\r## * GARCH Model Fit *\r## *---------------------------------*\r## ## Conditional Variance Dynamics ## -----------------------------------\r## GARCH Model : sGARCH(1,1)\r## Mean Model : ARFIMA(0,0,0)\r## Distribution : norm ## ## Optimal Parameters\r## ------------------------------------\r## Estimate Std. Error t value Pr(\u0026gt;|t|)\r## mu -0.004653 0.067842 -0.068584 0.945321\r## archm 0.010490 0.017807 0.589097 0.555796\r## omega 0.054695 0.014558 3.756910 0.000172\r## alpha1 0.043122 0.006563 6.570270 0.000000\r## beta1 0.943370 0.008992 104.907046 0.000000\r## ## Robust Standard Errors:\r## Estimate Std. Error t value Pr(\u0026gt;|t|)\r## mu -0.004653 0.065530 -0.071003 0.943395\r## archm 0.010490 0.015570 0.673755 0.500467\r## omega 0.054695 0.025015 2.186462 0.028782\r## alpha1 0.043122 0.011688 3.689482 0.000225\r## beta1 0.943370 0.015903 59.319254 0.000000\r## ## LogLikelihood : -6437.104 ## ## Information Criteria\r## ------------------------------------\r## ## Akaike 4.1696\r## Bayes 4.1794\r## Shibata 4.1696\r## Hannan-Quinn 4.1732\r## ## Weighted Ljung-Box Test on Standardized Residuals\r## ------------------------------------\r## statistic p-value\r## Lag[1] 10.19 0.001412\r## Lag[2*(p+q)+(p+q)-1][2] 10.96 0.001067\r## Lag[4*(p+q)+(p+q)-1][5] 12.33 0.002281\r## d.o.f=0\r## H0 : No serial correlation\r## ## Weighted Ljung-Box Test on Standardized Squared Residuals\r## ------------------------------------\r## statistic p-value\r## Lag[1] 9.956 0.001603\r## Lag[2*(p+q)+(p+q)-1][5] 10.623 0.006365\r## Lag[4*(p+q)+(p+q)-1][9] 12.288 0.015592\r## d.o.f=2\r## ## Weighted ARCH LM Tests\r## ------------------------------------\r## Statistic Shape Scale P-Value\r## ARCH Lag[3] 0.06805 0.500 2.000 0.7942\r## ARCH Lag[5] 1.46771 1.440 1.667 0.6008\r## ARCH Lag[7] 2.73781 2.315 1.543 0.5644\r## ## Nyblom stability test\r## ------------------------------------\r## Joint Statistic: 1.5089\r## Individual Statistics: ## mu 0.07563\r## archm 0.07407\r## omega 0.18380\r## alpha1 0.86425\r## beta1 0.47027\r## ## Asymptotic Critical Values (10% 5% 1%)\r## Joint Statistic: 1.28 1.47 1.88\r## Individual Statistic: 0.35 0.47 0.75\r## ## Sign Bias Test\r## ------------------------------------\r## t-value prob sig\r## Sign Bias 0.4368 0.66230 ## Negative Sign Bias 1.8213 0.06866 *\r## Positive Sign Bias 1.4248 0.15430 ## Joint Effect 6.1187 0.10598 ## ## ## Adjusted Pearson Goodness-of-Fit Test:\r## ------------------------------------\r## group statistic p-value(g-1)\r## 1 20 124.0 1.979e-17\r## 2 30 148.4 5.536e-18\r## 3 40 166.0 1.336e-17\r## 4 50 180.9 5.322e-17\r## ## ## Elapsed time : 1.937701\r\r5. TGARCH \rm7 = garchFit(~aparch(1,1),data=sp5,trace=F,delta=2,include.delta=F)\rsummary(m7)\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~aparch(1, 1), data = sp5, delta = 2, include.delta = F, ## trace = F) ## ## Mean and Variance Equation:\r## data ~ aparch(1, 1)\r## \u0026lt;environment: 0x000000002c7646a8\u0026gt;\r## [data = sp5]\r## ## Conditional Distribution:\r## norm ## ## Coefficient(s):\r## mu omega alpha1 gamma1 beta1 ## 1.1827e-04 5.2253e-06 4.0730e-02 2.2567e-01 9.4438e-01 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu 1.183e-04 3.279e-04 0.361 0.71831 ## omega 5.225e-06 1.328e-06 3.936 8.28e-05 ***\r## alpha1 4.073e-02 6.295e-03 6.470 9.77e-11 ***\r## gamma1 2.257e-01 7.566e-02 2.983 0.00286 ** ## beta1 9.444e-01 8.352e-03 113.073 \u0026lt; 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 7798.068 normalized: 2.523647 ## ## Description:\r## Mon Apr 15 15:20:33 2019 by user: Sirius ## ## ## Standardised Residuals Tests:\r## Statistic p-Value ## Jarque-Bera Test R Chi^2 652.4988 0 ## Shapiro-Wilk Test R W 0.9784191 0 ## Ljung-Box Test R Q(10) 24.4355 0.00652466 ## Ljung-Box Test R Q(15) 36.3757 0.00155993 ## Ljung-Box Test R Q(20) 44.53136 0.001276801\r## Ljung-Box Test R^2 Q(10) 15.2933 0.121729 ## Ljung-Box Test R^2 Q(15) 17.67024 0.2803989 ## Ljung-Box Test R^2 Q(20) 24.18837 0.2342605 ## LM Arch Test R TR^2 16.04755 0.1890679 ## ## Information Criterion Statistics:\r## AIC BIC SIC HQIC ## -5.044057 -5.034290 -5.044062 -5.040549\r#plot(m7)\rm8 = garchFit(~aparch(1,1),data=sp5,trace=F,delta=2,include.delta=F,cond.dist=\u0026quot;sstd\u0026quot;)\rsummary(m8)\r## ## Title:\r## GARCH Modelling ## ## Call:\r## garchFit(formula = ~aparch(1, 1), data = sp5, delta = 2, cond.dist = \u0026quot;sstd\u0026quot;, ## include.delta = F, trace = F) ## ## Mean and Variance Equation:\r## data ~ aparch(1, 1)\r## \u0026lt;environment: 0x000000002b0f1fc0\u0026gt;\r## [data = sp5]\r## ## Conditional Distribution:\r## sstd ## ## Coefficient(s):\r## mu omega alpha1 gamma1 beta1 skew ## 1.8035e-04 3.7584e-06 5.1556e-02 1.3490e-01 9.4129e-01 9.8794e-01 ## shape ## 4.9499e+00 ## ## Std. Errors:\r## based on Hessian ## ## Error Analysis:\r## Estimate Std. Error t value Pr(\u0026gt;|t|) ## mu 1.804e-04 3.204e-04 0.563 0.5734 ## omega 3.758e-06 1.585e-06 2.372 0.0177 * ## alpha1 5.156e-02 9.748e-03 5.289 1.23e-07 ***\r## gamma1 1.349e-01 7.803e-02 1.729 0.0839 . ## beta1 9.413e-01 1.106e-02 85.142 \u0026lt; 2e-16 ***\r## skew 9.879e-01 2.390e-02 41.344 \u0026lt; 2e-16 ***\r## shape 4.950e+00 4.570e-01 10.832 \u0026lt; 2e-16 ***\r## ---\r## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\r## ## Log Likelihood:\r## 7907.606 normalized: 2.559096 ## ## Description:\r## Mon Apr 15 15:20:34 2019 by user: Sirius ## ## ## Standardised Residuals Tests:\r## Statistic p-Value ## Jarque-Bera Test R Chi^2 815.5246 0 ## Shapiro-Wilk Test R W 0.9765433 0 ## Ljung-Box Test R Q(10) 22.70288 0.01189805 ## Ljung-Box Test R Q(15) 34.187 0.003205329\r## Ljung-Box Test R Q(20) 41.51742 0.003194883\r## Ljung-Box Test R^2 Q(10) 13.55453 0.1942974 ## Ljung-Box Test R^2 Q(15) 15.91041 0.3880305 ## Ljung-Box Test R^2 Q(20) 24.02615 0.2412519 ## LM Arch Test R TR^2 14.36733 0.2778687 ## ## Information Criterion Statistics:\r## AIC BIC SIC HQIC ## -5.113661 -5.099987 -5.113671 -5.108750\r#plot(m8)\rpredict(m8,6)\r## meanForecast meanError standardDeviation\r## 1 0.0001803532 0.01561807 0.01561807\r## 2 0.0001803532 0.01569080 0.01569080\r## 3 0.0001803532 0.01576276 0.01576276\r## 4 0.0001803532 0.01583395 0.01583395\r## 5 0.0001803532 0.01590440 0.01590440\r## 6 0.0001803532 0.01597412 0.01597412\r\r\r\r\r// add bootstrap table styles to pandoc tables\rfunction bootstrapStylePandocTables() {\r$('tr.header').parent('thead').parent('table').addClass('table table-condensed');\r}\r$(document).ready(function () {\rbootstrapStylePandocTables();\r});\r\r\r(function () {\rvar script = document.createElement(\"script\");\rscript.type = \"text/javascript\";\rscript.src = \"https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML\";\rdocument.getElementsByTagName(\"head\")[0].appendChild(script);\r})();\r\r\r\r","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"bdb34c2d3ba4ac53f167194ddc88ede5","permalink":"https://GangSirius.github.io/teaching/tmseries/lecture9/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/teaching/tmseries/lecture9/","section":"teaching","summary":"Lecture9: GARCH Family\r\r\r\r\r\r\rcode{white-space: pre;}\rpre:not([class]) {\rbackground-color: white;\r}\r\rif (window.hljs) {\rhljs.configure({languages: []});\rhljs.initHighlightingOnLoad();\rif (document.readyState \u0026\u0026 document.readyState === \"complete\") {\rwindow.setTimeout(function() { hljs.initHighlighting(); }, 0);\r}\r}\r\rh1 {\rfont-size: 34px;\r}\rh1.title {\rfont-size: 38px;\r}\rh2 {\rfont-size: 30px;\r}\rh3 {\rfont-size: 24px;\r}\rh4 {\rfont-size: 18px;\r}\rh5 {\rfont-size: 16px;\r}\rh6 {\rfont-size: 12px;\r}\r.","tags":null,"title":"","type":"teaching"},{"authors":null,"categories":null,"content":" Welcome to Slides Academic\nFeatures  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides  Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E  Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)  Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = \\;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\nFragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \nA fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears  Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view \r Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links   night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links  Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/img/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}  Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }  Questions? Ask\nDocumentation\n","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"https://GangSirius.github.io/slides/example/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"Welcome to Slides Academic\nFeatures  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides  Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E  Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)  Math In-line math: $x + y = z$","tags":null,"title":"Slides","type":"slides"}]